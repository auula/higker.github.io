<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>windows terminalç¾åŒ–</title>
    <link href="/2020/09/06/windows-terminal%E7%BE%8E%E5%8C%96/"/>
    <url>/2020/09/06/windows-terminal%E7%BE%8E%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h2 id="æ•ˆæœå›¾ğŸ˜€"><a href="#æ•ˆæœå›¾ğŸ˜€" class="headerlink" title="æ•ˆæœå›¾ğŸ˜€"></a>æ•ˆæœå›¾ğŸ˜€</h2><p><img src="https://i.loli.net/2020/09/06/m6ziQTjIlx5q8gC.png" srcset="/img/loading.gif" alt="windows terminal"></p><h2 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h2><ul><li>ç¬¬ä¸€æ­¥ä½ éœ€è¦åœ¨ä½ çš„Microsoft Storeå•†åº—é‡Œé¢Download <code>Windows Terminal</code></li></ul><ul><li><p>åœ¨ä½ çš„terminalé‡Œé¢æ‰§è¡Œä¸‹é¢å‘½ä»¤</p><pre><code class="shell">Set-ExecutionPolicy Bypass -Scope Process -Force; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;)); choco feature enable -n allowGlobalConfirmation</code></pre></li><li><p>å®‰è£…å®Œæˆåï¼Œä½¿ç”¨ <code>choco -v</code> å‘½ä»¤éªŒè¯ <code>Chocolatey</code> æ˜¯å¦å·²æ­£ç¡®å®‰è£….</p></li></ul><h2 id="å®‰è£…-oh-my-posh"><a href="#å®‰è£…-oh-my-posh" class="headerlink" title="å®‰è£… oh-my-posh"></a>å®‰è£… oh-my-posh</h2><p><code>oh-my-posh</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ <code>powerline</code> ä¸»é¢˜ï¼Œç±»ä¼¼äº <code>Linux</code>ä¸‹çš„ <code>oh-my-zsh</code>.</p><p>ç›¸åº”çš„ <code>Github</code> å®˜æ–¹é¡¹ç›® <code>oh-my-posh</code> ä¸­å…¶å®æœ‰å…·ä½“çš„æ“ä½œæ­¥éª¤</p><pre><code class="shell">Install-Module posh-git -Scope CurrentUserInstall-Module oh-my-posh -Scope CurrentUser</code></pre><p>æƒ³è¦é…ç½®ç”Ÿæ•ˆï¼Œéœ€è¦åˆ›å»º <code>PowerShell</code> çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡è®°äº‹æœ¬æ‰“å¼€æ‰§è¡Œ <code>notepad $PROFILE</code>å½“ç„¶å¦‚æœä½ å®‰è£…äº† <code>vscode</code> ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>code $PROFILE</code> æ‰“å¼€ã€‚ä¸ªäººæ¨èä½¿ç”¨åè€…<code>vscode</code>ï¼Œè®°å¾—å®‰è£…<code>vscode</code>æ—¶å‹¾é€‰ä¸Š <code>Add to PATH (available after restart)</code></p><pre><code class="shell">if (!(Test-Path -Path $PROFILE)) {New-Item -Type File -Path $PROFILE -Force}notepad $PROFILE</code></pre><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ–°å¢å¦‚ä¸‹å‡ è¡Œï¼š</p><pre><code class="shell">Import-Module posh-gitImport-Module oh-my-poshSet-Theme Sorin #æˆ‘ä½¿ç”¨çš„ä¸»é¢˜Sorinï¼ŒæŒ‰ç…§ä½ é€‰æ‹©çš„ä¸»é¢˜è®¾ç½®å³å¯$DefaultUser = &#39; ä½ çš„ç”¨æˆ·å &#39; #æƒ³è¦éšè—æœ¬æœºç”¨æˆ·åè¿˜å¯ä»¥æ·»åŠ è¿™è¡Œï¼Œè®¾ç½®ä¸ªäººç”¨æˆ·å</code></pre><h2 id="å…¶ä»–é…ç½®é¡¹"><a href="#å…¶ä»–é…ç½®é¡¹" class="headerlink" title="å…¶ä»–é…ç½®é¡¹"></a>å…¶ä»–é…ç½®é¡¹</h2><ul><li>ä¸‹é¢æ˜¯æˆ‘çš„ä¸ªäºº<code>$Profile</code>è‡ªå®šä¹‰é…ç½®</li></ul><pre><code class="shell">echo &quot;.____           __             ________        |    |    _____/  |_  ______  /  _____/  ____  |    |  _/ __ \   __\/  ___/ /   \  ___ /  _ \ |    |__\  ___/|  |  \___ \  \    \_\  (  &lt;_&gt; )|_______ \___  &gt;__| /____  &gt;  \______  /\____/         \/   \/          \/          \/            https://github.com/higker&quot;if (!(Test-Path -Path $PROFILE)) {New-Item -Type File -Path $PROFILE -Force}Import-Module posh-gitImport-Module oh-my-poshSet-Theme Sorin$DefaultUser = &#39;SDing&#39;# Chocolatey profile$ChocolateyProfile = &quot;$env:ChocolateyInstall\helpers\chocolateyProfile.psm1&quot;if (Test-Path($ChocolateyProfile)) {  Import-Module &quot;$ChocolateyProfile&quot;}</code></pre><ul><li>ä¸»é¢˜è‡ªå®šä¹‰</li></ul><pre><code class="json">// This file was initially generated by Windows Terminal 1.2.2381.0// It should still be usable in newer versions, but newer versions might have additional// settings, help text, or changes that you will not see unless you clear this file// and let us generate a new one for you.// To view the default settings, hold &quot;alt&quot; while clicking on the &quot;Settings&quot; button.// For documentation on these settings, see: https://aka.ms/terminal-documentation{    &quot;$schema&quot;: &quot;https://aka.ms/terminal-profiles-schema&quot;,    &quot;defaultProfile&quot;: &quot;{61c54bbd-c2c6-5271-96e7-009a87ff44bf}&quot;,    // You can add more global application settings here.    // To learn more about global settings, visit https://aka.ms/terminal-global-settings    // If enabled, selections are automatically copied to your clipboard.    &quot;copyOnSelect&quot;: false,    // If enabled, formatted data is also copied to your clipboard    &quot;copyFormatting&quot;: false,    // A profile specifies a command to execute paired with information about how it should look and feel.    // Each one of them will appear in the &#39;New Tab&#39; dropdown,    //   and can be invoked from the commandline with `wt.exe -p xxx`    // To learn more about profiles, visit https://aka.ms/terminal-profile-settings    &quot;profiles&quot;:    {        &quot;defaults&quot;:        {            // Put settings here that you want to apply to all profiles.            &quot;background&quot;: &quot;#013456&quot;,            &quot;acrylicOpacity&quot;: 0.3,            &quot;useAcrylic&quot;: true,            &quot;fontFace&quot;: &quot;Fira Code Retina&quot;        },        &quot;list&quot;:        [            {                // Make changes here to the powershell.exe profile.                &quot;guid&quot;: &quot;{61c54bbd-c2c6-5271-96e7-009a87ff44bf}&quot;,                &quot;name&quot;: &quot;Windows PowerShell&quot;,                &quot;commandline&quot;: &quot;powershell.exe&quot;,                &quot;hidden&quot;: false            },            {                // Make changes here to the cmd.exe profile.                &quot;guid&quot;: &quot;{0caa0dad-35be-5f56-a8ff-afceeeaa6101}&quot;,                &quot;name&quot;: &quot;å‘½ä»¤æç¤ºç¬¦&quot;,                &quot;commandline&quot;: &quot;cmd.exe&quot;,                &quot;hidden&quot;: false            },            {                &quot;guid&quot;: &quot;{b453ae62-4e3d-5e58-b989-0a998ec441b8}&quot;,                &quot;hidden&quot;: false,                &quot;name&quot;: &quot;Azure Cloud Shell&quot;,                &quot;source&quot;: &quot;Windows.Terminal.Azure&quot;            },            {                &quot;guid&quot;: &quot;{2c4de342-38b7-51cf-b940-2309a097f518}&quot;,                &quot;hidden&quot;: false,                &quot;name&quot;: &quot;Ubuntu WSL&quot;,                &quot;source&quot;: &quot;Windows.Terminal.Wsl&quot;            }        ]    },    // Add custom color schemes to this array.    // To learn more about color schemes, visit https://aka.ms/terminal-color-schemes    &quot;schemes&quot;: [    ],    // Add custom keybindings to this array.    // To unbind a key combination from your defaults.json, set the command to &quot;unbound&quot;.    // To learn more about keybindings, visit https://aka.ms/terminal-keybindings    &quot;keybindings&quot;:    [        // Copy and paste are bound to Ctrl+Shift+C and Ctrl+Shift+V in your defaults.json.        // These two lines additionally bind them to Ctrl+C and Ctrl+V.        // To learn more about selection, visit https://aka.ms/terminal-selection        { &quot;command&quot;: {&quot;action&quot;: &quot;copy&quot;, &quot;singleLine&quot;: false }, &quot;keys&quot;: &quot;ctrl+c&quot; },        { &quot;command&quot;: &quot;paste&quot;, &quot;keys&quot;: &quot;ctrl+v&quot; },        // Press Ctrl+Shift+F to open the search box        { &quot;command&quot;: &quot;find&quot;, &quot;keys&quot;: &quot;ctrl+shift+f&quot; },        // Press Alt+Shift+D to open a new pane.        // - &quot;split&quot;: &quot;auto&quot; makes this pane open in the direction that provides the most surface area.        // - &quot;splitMode&quot;: &quot;duplicate&quot; makes the new pane use the focused pane&#39;s profile.        // To learn more about panes, visit https://aka.ms/terminal-panes        { &quot;command&quot;: { &quot;action&quot;: &quot;splitPane&quot;, &quot;split&quot;: &quot;auto&quot;, &quot;splitMode&quot;: &quot;duplicate&quot; }, &quot;keys&quot;: &quot;alt+shift+d&quot; }    ]}</code></pre><ul><li>å…¶ä»–é…ç½®é¡¹å¯ä»¥å»å¾®è½¯å®˜ç½‘æŸ¥çœ‹æ–‡æ¡£</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisé‚£äº›äº‹éšç¬”</title>
    <link href="/2020/08/04/Redis%E9%82%A3%E4%BA%9B%E4%BA%8B%E9%9A%8F%E7%AC%94/"/>
    <url>/2020/08/04/Redis%E9%82%A3%E4%BA%9B%E4%BA%8B%E9%9A%8F%E7%AC%94/</url>
    
    <content type="html"><![CDATA[<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghew9a67sqj30jg07bt8y.jpg" srcset="/img/loading.gif" alt=""></p><p><strong><code>Redis</code>ï¼ˆ<code>Remote Dictionary Server</code>)ï¼Œå³<code>è¿œç¨‹å­—å…¸æœåŠ¡</code>ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€<code>Key-Valueæ•°æ®åº“</code>ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±PivotalèµåŠ©ã€‚å®ƒé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œ æœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹ã€‚</strong></p><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><ul><li>String: å­—ç¬¦ä¸²</li><li>Hash: æ•£åˆ—</li><li>List: åˆ—è¡¨</li><li>Set: é›†åˆ</li><li>Sorted Set: æœ‰åºé›†åˆ</li><li>è¿˜æœ‰æ–°åŠ çš„é‡Œåœ°ç†ä½ç½®ç­‰ç±»å‹</li></ul><h3 id="ç‰¹ç‚¹å’Œç¼ºç‚¹"><a href="#ç‰¹ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="ç‰¹ç‚¹å’Œç¼ºç‚¹"></a>ç‰¹ç‚¹å’Œç¼ºç‚¹</h3><ul><li>å†…å­˜å­˜å‚¨ï¼Œè¯»å†™æ“ä½œå¿«</li><li>æ•ˆç‡é«˜ï¼Œå¯ç”¨äºé«˜é€Ÿç¼“å­˜</li><li>å‘å¸ƒè®¢é˜…ç³»ç»Ÿ</li><li>åœ°å›¾ä¿¡æ¯åˆ†æ</li><li>è®¡æ—¶å™¨ï¼Œè®¡æ•°å™¨ï¼ˆæµè§ˆé‡!ï¼‰</li><li>æµé‡é™æµï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ¶ˆå³°</li><li><code>æ–­ç”µå†…å­˜æ•°æ®ä¸¢å¤±ï¼ˆæ‰€æœ‰æŒä¹…åŒ–å¾ˆé‡è¦ï¼‰</code></li><li><code>RDBï¼ŒAOF æŒä¹…åŒ–ç­–ç•¥</code></li></ul><h3 id="å®‰è£…Redis"><a href="#å®‰è£…Redis" class="headerlink" title="å®‰è£…Redis"></a>å®‰è£…Redis</h3><p><strong>1. Linuxè§£å†³å®‰è£…ä¸€äº›ä¾èµ–é—®é¢˜</strong></p><pre><code class="bash">yum groups install Development Tools</code></pre><p><strong>2. ä¸‹è½½è§£å‹ç¼–è¯‘å®‰è£…</strong></p><pre><code class="bash">$ wget http://download.redis.io/releases/redis-5.0.5.tar.gz$ tar xzf redis-5.0.5.tar.gz$ cd redis-5.0.5$ make</code></pre><p>è¿›å…¥åˆ°è§£å‹åçš„ src ç›®å½•ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤å¯åŠ¨Redis:</p><p><code>$ src/redis-server</code></p><p>æ‚¨å¯ä»¥ä½¿ç”¨å†…ç½®çš„å®¢æˆ·ç«¯ä¸Redisè¿›è¡Œäº¤äº’:</p><pre><code class="bash">$ src/redis-cliredis&gt; set foo barOKredis&gt; get foo&quot;bar&quot;</code></pre><p>okå¤§åŠŸå‘Šæˆã€‚</p><h3 id="é…ç½®Redis-confæ–‡ä»¶"><a href="#é…ç½®Redis-confæ–‡ä»¶" class="headerlink" title="é…ç½®Redis.confæ–‡ä»¶"></a>é…ç½®<code>Redis.conf</code>æ–‡ä»¶</h3><pre><code class="json"># Redis configuration file example.requirepass passwordmaxclients 10000## Note that in order to read the configuration file, Redis must be# started with the file path as first argument:## ./redis-server /path/to/redis.conf# Note on units: when memory size is needed, it is possible to specify# it in the usual form of 1k 5GB 4M and so forth:## 1k =&gt; 1000 bytes# 1kb =&gt; 1024 bytes# 1m =&gt; 1000000 bytes# 1mb =&gt; 1024*1024 bytes# 1g =&gt; 1000000000 bytes# 1gb =&gt; 1024*1024*1024 bytes## units are case insensitive so 1GB 1Gb 1gB are all the same.################################## INCLUDES #################################### Include one or more other config files here.  This is useful if you# have a standard template that goes to all Redis servers but also need# to customize a few per-server settings.  Include files can include# other files, so use this wisely.## Notice option &quot;include&quot; won&#39;t be rewritten by command &quot;CONFIG REWRITE&quot;# from admin or Redis Sentinel. Since Redis always uses the last processed# line as value of a configuration directive, you&#39;d better put includes# at the beginning of this file to avoid overwriting config change at runtime.## If instead you are interested in using includes to override configuration# options, it is better to use include as the last line.## include /path/to/local.conf# include /path/to/other.conf################################## MODULES ###################################### Load modules at startup. If the server is not able to load modules# it will abort. It is possible to use multiple loadmodule directives.## loadmodule /path/to/my_module.so# loadmodule /path/to/other_module.so################################## NETWORK ###################################### By default, if no &quot;bind&quot; configuration directive is specified, Redis listens# for connections from all the network interfaces available on the server.# It is possible to listen to just one or multiple selected interfaces using# the &quot;bind&quot; configuration directive, followed by one or more IP addresses.## Examples:## bind 192.168.1.100 10.0.0.1# bind 127.0.0.1 ::1## ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the# internet, binding to all the interfaces is dangerous and will expose the# instance to everybody on the internet. So by default we uncomment the# following bind directive, that will force Redis to listen only into# the IPv4 loopback interface address (this means Redis will be able to# accept connections only from clients running into the same computer it# is running).## IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES# JUST COMMENT THE FOLLOWING LINE.# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~# bind 128.199.155.162# Protected mode is a layer of security protection, in order to avoid that# Redis instances left open on the internet are accessed and exploited.## When protected mode is on and if:## 1) The server is not binding explicitly to a set of addresses using the#    &quot;bind&quot; directive.# 2) No password is configured.## The server only accepts connections from clients connecting from the# IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain# sockets.## By default protected mode is enabled. You should disable it only if# you are sure you want clients from other hosts to connect to Redis# even if no authentication is configured, nor a specific set of interfaces# are explicitly listed using the &quot;bind&quot; directive.protected-mode no# Accept connections on the specified port, default is 6379 (IANA #815344).# If port 0 is specified Redis will not listen on a TCP socket.port 6379# TCP listen() backlog.## In high requests-per-second environments you need an high backlog in order# to avoid slow clients connections issues. Note that the Linux kernel# will silently truncate it to the value of /proc/sys/net/core/somaxconn so# make sure to raise both the value of somaxconn and tcp_max_syn_backlog# in order to get the desired effect.tcp-backlog 511# Unix socket.## Specify the path for the Unix socket that will be used to listen for# incoming connections. There is no default, so Redis will not listen# on a unix socket when not specified.## unixsocket /tmp/redis.sock# unixsocketperm 700# Close the connection after a client is idle for N seconds (0 to disable)timeout 0# TCP keepalive.## If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence# of communication. This is useful for two reasons:## 1) Detect dead peers.# 2) Take the connection alive from the point of view of network#    equipment in the middle.## On Linux, the specified value (in seconds) is the period used to send ACKs.# Note that to close the connection the double of the time is needed.# On other kernels the period depends on the kernel configuration.## A reasonable value for this option is 300 seconds, which is the new# Redis default starting with Redis 3.2.1.tcp-keepalive 300################################# GENERAL ###################################### By default Redis does not run as a daemon. Use &#39;yes&#39; if you need it.# Note that Redis will write a pid file in /var/run/redis.pid when daemonized.daemonize yes # If you run Redis from upstart or systemd, Redis can interact with your# supervision tree. Options:#   supervised no      - no supervision interaction#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET#   supervised auto    - detect upstart or systemd method based on#                        UPSTART_JOB or NOTIFY_SOCKET environment variables# Note: these supervision methods only signal &quot;process is ready.&quot;#       They do not enable continuous liveness pings back to your supervisor.supervised no# If a pid file is specified, Redis writes it where specified at startup# and removes it at exit.## When the server runs non daemonized, no pid file is created if none is# specified in the configuration. When the server is daemonized, the pid file# is used even if not specified, defaulting to &quot;/var/run/redis.pid&quot;.## Creating a pid file is best effort: if Redis is not able to create it# nothing bad happens, the server will start and run normally.pidfile /www/server/redis/redis.pid # Specify the server verbosity level.# This can be one of:# debug (a lot of information, useful for development/testing)# verbose (many rarely useful info, but not a mess like the debug level)# notice (moderately verbose, what you want in production probably)# warning (only very important / critical messages are logged)loglevel notice# Specify the log file name. Also the empty string can be used to force# Redis to log on the standard output. Note that if you use standard# output for logging but daemonize, logs will be sent to /dev/nulllogfile &quot;/www/server/redis/redis.log&quot;# To enable logging to the system logger, just set &#39;syslog-enabled&#39; to yes,# and optionally update the other syslog parameters to suit your needs.# syslog-enabled no# Specify the syslog identity.# syslog-ident redis# Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7.# syslog-facility local0# Set the number of databases. The default database is DB 0, you can select# a different one on a per-connection basis using SELECT &lt;dbid&gt; where# dbid is a number between 0 and &#39;databases&#39;-1databases 16# By default Redis shows an ASCII art logo only when started to log to the# standard output and if the standard output is a TTY. Basically this means# that normally a logo is displayed only in interactive sessions.## However it is possible to force the pre-4.0 behavior and always show a# ASCII art logo in startup logs by setting the following option to yes.always-show-logo yes################################ SNAPSHOTTING  ################################## Save the DB on disk:##   save &lt;seconds&gt; &lt;changes&gt;##   Will save the DB if both the given number of seconds and the given#   number of write operations against the DB occurred.##   In the example below the behaviour will be to save:#   after 900 sec (15 min) if at least 1 key changed#   after 300 sec (5 min) if at least 10 keys changed#   after 60 sec if at least 10000 keys changed##   Note: you can disable saving completely by commenting out all &quot;save&quot; lines.##   It is also possible to remove all the previously configured save#   points by adding a save directive with a single empty string argument#   like in the following example:##   save &quot;&quot;save 900 1save 300 10save 60 10000# By default Redis will stop accepting writes if RDB snapshots are enabled# (at least one save point) and the latest background save failed.# This will make the user aware (in a hard way) that data is not persisting# on disk properly, otherwise chances are that no one will notice and some# disaster will happen.## If the background saving process will start working again Redis will# automatically allow writes again.## However if you have setup your proper monitoring of the Redis server# and persistence, you may want to disable this feature so that Redis will# continue to work as usual even if there are problems with disk,# permissions, and so forth.stop-writes-on-bgsave-error yes# Compress string objects using LZF when dump .rdb databases?# For default that&#39;s set to &#39;yes&#39; as it&#39;s almost always a win.# If you want to save some CPU in the saving child set it to &#39;no&#39; but# the dataset will likely be bigger if you have compressible values or keys.rdbcompression yes# Since version 5 of RDB a CRC64 checksum is placed at the end of the file.# This makes the format more resistant to corruption but there is a performance# hit to pay (around 10%) when saving and loading RDB files, so you can disable it# for maximum performances.## RDB files created with checksum disabled have a checksum of zero that will# tell the loading code to skip the check.rdbchecksum yes# The filename where to dump the DBdbfilename dump.rdb# The working directory.## The DB will be written inside this directory, with the filename specified# above using the &#39;dbfilename&#39; configuration directive.## The Append Only File will also be created inside this directory.## Note that you must specify a directory here, not a file name.dir /www/server/redis/################################# REPLICATION ################################## Master-Replica replication. Use replicaof to make a Redis instance a copy of# another Redis server. A few things to understand ASAP about Redis replication.##   +------------------+      +---------------+#   |      Master      | ---&gt; |    Replica    |#   | (receive writes) |      |  (exact copy) |#   +------------------+      +---------------+## 1) Redis replication is asynchronous, but you can configure a master to#    stop accepting writes if it appears to be not connected with at least#    a given number of replicas.# 2) Redis replicas are able to perform a partial resynchronization with the#    master if the replication link is lost for a relatively small amount of#    time. You may want to configure the replication backlog size (see the next#    sections of this file) with a sensible value depending on your needs.# 3) Replication is automatic and does not need user intervention. After a#    network partition replicas automatically try to reconnect to masters#    and resynchronize with them.## replicaof &lt;masterip&gt; &lt;masterport&gt;# If the master is password protected (using the &quot;requirepass&quot; configuration# directive below) it is possible to tell the replica to authenticate before# starting the replication synchronization process, otherwise the master will# refuse the replica request.## masterauth &lt;master-password&gt;# When a replica loses its connection with the master, or when the replication# is still in progress, the replica can act in two different ways:## 1) if replica-serve-stale-data is set to &#39;yes&#39; (the default) the replica will#    still reply to client requests, possibly with out of date data, or the#    data set may just be empty if this is the first synchronization.## 2) if replica-serve-stale-data is set to &#39;no&#39; the replica will reply with#    an error &quot;SYNC with master in progress&quot; to all the kind of commands#    but to INFO, replicaOF, AUTH, PING, SHUTDOWN, REPLCONF, ROLE, CONFIG,#    SUBSCRIBE, UNSUBSCRIBE, PSUBSCRIBE, PUNSUBSCRIBE, PUBLISH, PUBSUB,#    COMMAND, POST, HOST: and LATENCY.#replica-serve-stale-data yes# You can configure a replica instance to accept writes or not. Writing against# a replica instance may be useful to store some ephemeral data (because data# written on a replica will be easily deleted after resync with the master) but# may also cause problems if clients are writing to it because of a# misconfiguration.## Since Redis 2.6 by default replicas are read-only.## Note: read only replicas are not designed to be exposed to untrusted clients# on the internet. It&#39;s just a protection layer against misuse of the instance.# Still a read only replica exports by default all the administrative commands# such as CONFIG, DEBUG, and so forth. To a limited extent you can improve# security of read only replicas using &#39;rename-command&#39; to shadow all the# administrative / dangerous commands.replica-read-only yes# Replication SYNC strategy: disk or socket.## -------------------------------------------------------# WARNING: DISKLESS REPLICATION IS EXPERIMENTAL CURRENTLY# -------------------------------------------------------## New replicas and reconnecting replicas that are not able to continue the replication# process just receiving differences, need to do what is called a &quot;full# synchronization&quot;. An RDB file is transmitted from the master to the replicas.# The transmission can happen in two different ways:## 1) Disk-backed: The Redis master creates a new process that writes the RDB#                 file on disk. Later the file is transferred by the parent#                 process to the replicas incrementally.# 2) Diskless: The Redis master creates a new process that directly writes the#              RDB file to replica sockets, without touching the disk at all.## With disk-backed replication, while the RDB file is generated, more replicas# can be queued and served with the RDB file as soon as the current child producing# the RDB file finishes its work. With diskless replication instead once# the transfer starts, new replicas arriving will be queued and a new transfer# will start when the current one terminates.## When diskless replication is used, the master waits a configurable amount of# time (in seconds) before starting the transfer in the hope that multiple replicas# will arrive and the transfer can be parallelized.## With slow disks and fast (large bandwidth) networks, diskless replication# works better.repl-diskless-sync no# When diskless replication is enabled, it is possible to configure the delay# the server waits in order to spawn the child that transfers the RDB via socket# to the replicas.## This is important since once the transfer starts, it is not possible to serve# new replicas arriving, that will be queued for the next RDB transfer, so the server# waits a delay in order to let more replicas arrive.## The delay is specified in seconds, and by default is 5 seconds. To disable# it entirely just set it to 0 seconds and the transfer will start ASAP.repl-diskless-sync-delay 5# Replicas send PINGs to server in a predefined interval. It&#39;s possible to change# this interval with the repl_ping_replica_period option. The default value is 10# seconds.## repl-ping-replica-period 10# The following option sets the replication timeout for:## 1) Bulk transfer I/O during SYNC, from the point of view of replica.# 2) Master timeout from the point of view of replicas (data, pings).# 3) Replica timeout from the point of view of masters (REPLCONF ACK pings).## It is important to make sure that this value is greater than the value# specified for repl-ping-replica-period otherwise a timeout will be detected# every time there is low traffic between the master and the replica.## repl-timeout 60# Disable TCP_NODELAY on the replica socket after SYNC?## If you select &quot;yes&quot; Redis will use a smaller number of TCP packets and# less bandwidth to send data to replicas. But this can add a delay for# the data to appear on the replica side, up to 40 milliseconds with# Linux kernels using a default configuration.## If you select &quot;no&quot; the delay for data to appear on the replica side will# be reduced but more bandwidth will be used for replication.## By default we optimize for low latency, but in very high traffic conditions# or when the master and replicas are many hops away, turning this to &quot;yes&quot; may# be a good idea.repl-disable-tcp-nodelay no# Set the replication backlog size. The backlog is a buffer that accumulates# replica data when replicas are disconnected for some time, so that when a replica# wants to reconnect again, often a full resync is not needed, but a partial# resync is enough, just passing the portion of data the replica missed while# disconnected.## The bigger the replication backlog, the longer the time the replica can be# disconnected and later be able to perform a partial resynchronization.## The backlog is only allocated once there is at least a replica connected.## repl-backlog-size 1mb# After a master has no longer connected replicas for some time, the backlog# will be freed. The following option configures the amount of seconds that# need to elapse, starting from the time the last replica disconnected, for# the backlog buffer to be freed.## Note that replicas never free the backlog for timeout, since they may be# promoted to masters later, and should be able to correctly &quot;partially# resynchronize&quot; with the replicas: hence they should always accumulate backlog.## A value of 0 means to never release the backlog.## repl-backlog-ttl 3600# The replica priority is an integer number published by Redis in the INFO output.# It is used by Redis Sentinel in order to select a replica to promote into a# master if the master is no longer working correctly.## A replica with a low priority number is considered better for promotion, so# for instance if there are three replicas with priority 10, 100, 25 Sentinel will# pick the one with priority 10, that is the lowest.## However a special priority of 0 marks the replica as not able to perform the# role of master, so a replica with priority of 0 will never be selected by# Redis Sentinel for promotion.## By default the priority is 100.replica-priority 100# It is possible for a master to stop accepting writes if there are less than# N replicas connected, having a lag less or equal than M seconds.## The N replicas need to be in &quot;online&quot; state.## The lag in seconds, that must be &lt;= the specified value, is calculated from# the last ping received from the replica, that is usually sent every second.## This option does not GUARANTEE that N replicas will accept the write, but# will limit the window of exposure for lost writes in case not enough replicas# are available, to the specified number of seconds.## For example to require at least 3 replicas with a lag &lt;= 10 seconds use:## min-replicas-to-write 3# min-replicas-max-lag 10## Setting one or the other to 0 disables the feature.## By default min-replicas-to-write is set to 0 (feature disabled) and# min-replicas-max-lag is set to 10.# A Redis master is able to list the address and port of the attached# replicas in different ways. For example the &quot;INFO replication&quot; section# offers this information, which is used, among other tools, by# Redis Sentinel in order to discover replica instances.# Another place where this info is available is in the output of the# &quot;ROLE&quot; command of a master.## The listed IP and address normally reported by a replica is obtained# in the following way:##   IP: The address is auto detected by checking the peer address#   of the socket used by the replica to connect with the master.##   Port: The port is communicated by the replica during the replication#   handshake, and is normally the port that the replica is using to#   listen for connections.## However when port forwarding or Network Address Translation (NAT) is# used, the replica may be actually reachable via different IP and port# pairs. The following two options can be used by a replica in order to# report to its master a specific set of IP and port, so that both INFO# and ROLE will report those values.## There is no need to use both the options if you need to override just# the port or the IP address.## replica-announce-ip 5.5.5.5# replica-announce-port 1234################################## SECURITY #################################### Require clients to issue AUTH &lt;PASSWORD&gt; before processing any other# commands.  This might be useful in environments in which you do not trust# others with access to the host running redis-server.## This should stay commented out for backward compatibility and because most# people do not need auth (e.g. they run their own servers).## Warning: since Redis is pretty fast an outside user can try up to# 150k passwords per second against a good box. This means that you should# use a very strong password otherwise it will be very easy to break.## requirepass foobared# Command renaming.## It is possible to change the name of dangerous commands in a shared# environment. For instance the CONFIG command may be renamed into something# hard to guess so that it will still be available for internal-use tools# but not available for general clients.## Example:## rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52## It is also possible to completely kill a command by renaming it into# an empty string:## rename-command CONFIG &quot;&quot;## Please note that changing the name of commands that are logged into the# AOF file or transmitted to replicas may cause problems.################################### CLIENTS ##################################### Set the max number of connected clients at the same time. By default# this limit is set to 10000 clients, however if the Redis server is not# able to configure the process file limit to allow for the specified limit# the max number of allowed clients is set to the current file limit# minus 32 (as Redis reserves a few file descriptors for internal uses).## Once the limit is reached Redis will close all the new connections sending# an error &#39;max number of clients reached&#39;.## maxclients 10000############################## MEMORY MANAGEMENT ################################# Set a memory usage limit to the specified amount of bytes.# When the memory limit is reached Redis will try to remove keys# according to the eviction policy selected (see maxmemory-policy).## If Redis can&#39;t remove keys according to the policy, or if the policy is# set to &#39;noeviction&#39;, Redis will start to reply with errors to commands# that would use more memory, like SET, LPUSH, and so on, and will continue# to reply to read-only commands like GET.## This option is usually useful when using Redis as an LRU or LFU cache, or to# set a hard memory limit for an instance (using the &#39;noeviction&#39; policy).## WARNING: If you have replicas attached to an instance with maxmemory on,# the size of the output buffers needed to feed the replicas are subtracted# from the used memory count, so that network problems / resyncs will# not trigger a loop where keys are evicted, and in turn the output# buffer of replicas is full with DELs of keys evicted triggering the deletion# of more keys, and so forth until the database is completely emptied.## In short... if you have replicas attached it is suggested that you set a lower# limit for maxmemory so that there is some free RAM on the system for replica# output buffers (but this is not needed if the policy is &#39;noeviction&#39;).## maxmemory &lt;bytes&gt;# MAXMEMORY POLICY: how Redis will select what to remove when maxmemory# is reached. You can select among five behaviors:## volatile-lru -&gt; Evict using approximated LRU among the keys with an expire set.# allkeys-lru -&gt; Evict any key using approximated LRU.# volatile-lfu -&gt; Evict using approximated LFU among the keys with an expire set.# allkeys-lfu -&gt; Evict any key using approximated LFU.# volatile-random -&gt; Remove a random key among the ones with an expire set.# allkeys-random -&gt; Remove a random key, any key.# volatile-ttl -&gt; Remove the key with the nearest expire time (minor TTL)# noeviction -&gt; Don&#39;t evict anything, just return an error on write operations.## LRU means Least Recently Used# LFU means Least Frequently Used## Both LRU, LFU and volatile-ttl are implemented using approximated# randomized algorithms.## Note: with any of the above policies, Redis will return an error on write#       operations, when there are no suitable keys for eviction.##       At the date of writing these commands are: set setnx setex append#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby#       getset mset msetnx exec sort## The default is:## maxmemory-policy noeviction# LRU, LFU and minimal TTL algorithms are not precise algorithms but approximated# algorithms (in order to save memory), so you can tune it for speed or# accuracy. For default Redis will check five keys and pick the one that was# used less recently, you can change the sample size using the following# configuration directive.## The default of 5 produces good enough results. 10 Approximates very closely# true LRU but costs more CPU. 3 is faster but not very accurate.## maxmemory-samples 5# Starting from Redis 5, by default a replica will ignore its maxmemory setting# (unless it is promoted to master after a failover or manually). It means# that the eviction of keys will be just handled by the master, sending the# DEL commands to the replica as keys evict in the master side.## This behavior ensures that masters and replicas stay consistent, and is usually# what you want, however if your replica is writable, or you want the replica to have# a different memory setting, and you are sure all the writes performed to the# replica are idempotent, then you may change this default (but be sure to understand# what you are doing).## Note that since the replica by default does not evict, it may end using more# memory than the one set via maxmemory (there are certain buffers that may# be larger on the replica, or data structures may sometimes take more memory and so# forth). So make sure you monitor your replicas and make sure they have enough# memory to never hit a real out-of-memory condition before the master hits# the configured maxmemory setting.## replica-ignore-maxmemory yes############################# LAZY FREEING ##################################### Redis has two primitives to delete keys. One is called DEL and is a blocking# deletion of the object. It means that the server stops processing new commands# in order to reclaim all the memory associated with an object in a synchronous# way. If the key deleted is associated with a small object, the time needed# in order to execute the DEL command is very small and comparable to most other# O(1) or O(log_N) commands in Redis. However if the key is associated with an# aggregated value containing millions of elements, the server can block for# a long time (even seconds) in order to complete the operation.## For the above reasons Redis also offers non blocking deletion primitives# such as UNLINK (non blocking DEL) and the ASYNC option of FLUSHALL and# FLUSHDB commands, in order to reclaim memory in background. Those commands# are executed in constant time. Another thread will incrementally free the# object in the background as fast as possible.## DEL, UNLINK and ASYNC option of FLUSHALL and FLUSHDB are user-controlled.# It&#39;s up to the design of the application to understand when it is a good# idea to use one or the other. However the Redis server sometimes has to# delete keys or flush the whole database as a side effect of other operations.# Specifically Redis deletes objects independently of a user call in the# following scenarios:## 1) On eviction, because of the maxmemory and maxmemory policy configurations,#    in order to make room for new data, without going over the specified#    memory limit.# 2) Because of expire: when a key with an associated time to live (see the#    EXPIRE command) must be deleted from memory.# 3) Because of a side effect of a command that stores data on a key that may#    already exist. For example the RENAME command may delete the old key#    content when it is replaced with another one. Similarly SUNIONSTORE#    or SORT with STORE option may delete existing keys. The SET command#    itself removes any old content of the specified key in order to replace#    it with the specified string.# 4) During replication, when a replica performs a full resynchronization with#    its master, the content of the whole database is removed in order to#    load the RDB file just transferred.## In all the above cases the default is to delete objects in a blocking way,# like if DEL was called. However you can configure each case specifically# in order to instead release memory in a non-blocking way like if UNLINK# was called, using the following configuration directives:lazyfree-lazy-eviction nolazyfree-lazy-expire nolazyfree-lazy-server-del noreplica-lazy-flush no############################## APPEND ONLY MODE ################################ By default Redis asynchronously dumps the dataset on disk. This mode is# good enough in many applications, but an issue with the Redis process or# a power outage may result into a few minutes of writes lost (depending on# the configured save points).## The Append Only File is an alternative persistence mode that provides# much better durability. For instance using the default data fsync policy# (see later in the config file) Redis can lose just one second of writes in a# dramatic event like a server power outage, or a single write if something# wrong with the Redis process itself happens, but the operating system is# still running correctly.## AOF and RDB persistence can be enabled at the same time without problems.# If the AOF is enabled on startup Redis will load the AOF, that is the file# with the better durability guarantees.## Please check http://redis.io/topics/persistence for more information.appendonly no# The name of the append only file (default: &quot;appendonly.aof&quot;)appendfilename &quot;appendonly.aof&quot;# The fsync() call tells the Operating System to actually write data on disk# instead of waiting for more data in the output buffer. Some OS will really flush# data on disk, some other OS will just try to do it ASAP.## Redis supports three different modes:## no: don&#39;t fsync, just let the OS flush the data when it wants. Faster.# always: fsync after every write to the append only log. Slow, Safest.# everysec: fsync only one time every second. Compromise.## The default is &quot;everysec&quot;, as that&#39;s usually the right compromise between# speed and data safety. It&#39;s up to you to understand if you can relax this to# &quot;no&quot; that will let the operating system flush the output buffer when# it wants, for better performances (but if you can live with the idea of# some data loss consider the default persistence mode that&#39;s snapshotting),# or on the contrary, use &quot;always&quot; that&#39;s very slow but a bit safer than# everysec.## More details please check the following article:# http://antirez.com/post/redis-persistence-demystified.html## If unsure, use &quot;everysec&quot;.# appendfsync alwaysappendfsync everysec# appendfsync no# When the AOF fsync policy is set to always or everysec, and a background# saving process (a background save or AOF log background rewriting) is# performing a lot of I/O against the disk, in some Linux configurations# Redis may block too long on the fsync() call. Note that there is no fix for# this currently, as even performing fsync in a different thread will block# our synchronous write(2) call.## In order to mitigate this problem it&#39;s possible to use the following option# that will prevent fsync() from being called in the main process while a# BGSAVE or BGREWRITEAOF is in progress.## This means that while another child is saving, the durability of Redis is# the same as &quot;appendfsync none&quot;. In practical terms, this means that it is# possible to lose up to 30 seconds of log in the worst scenario (with the# default Linux settings).## If you have latency problems turn this to &quot;yes&quot;. Otherwise leave it as# &quot;no&quot; that is the safest pick from the point of view of durability.no-appendfsync-on-rewrite no# Automatic rewrite of the append only file.# Redis is able to automatically rewrite the log file implicitly calling# BGREWRITEAOF when the AOF log size grows by the specified percentage.## This is how it works: Redis remembers the size of the AOF file after the# latest rewrite (if no rewrite has happened since the restart, the size of# the AOF at startup is used).## This base size is compared to the current size. If the current size is# bigger than the specified percentage, the rewrite is triggered. Also# you need to specify a minimal size for the AOF file to be rewritten, this# is useful to avoid rewriting the AOF file even if the percentage increase# is reached but it is still pretty small.## Specify a percentage of zero in order to disable the automatic AOF# rewrite feature.auto-aof-rewrite-percentage 100auto-aof-rewrite-min-size 64mb# An AOF file may be found to be truncated at the end during the Redis# startup process, when the AOF data gets loaded back into memory.# This may happen when the system where Redis is running# crashes, especially when an ext4 filesystem is mounted without the# data=ordered option (however this can&#39;t happen when Redis itself# crashes or aborts but the operating system still works correctly).## Redis can either exit with an error when this happens, or load as much# data as possible (the default now) and start if the AOF file is found# to be truncated at the end. The following option controls this behavior.## If aof-load-truncated is set to yes, a truncated AOF file is loaded and# the Redis server starts emitting a log to inform the user of the event.# Otherwise if the option is set to no, the server aborts with an error# and refuses to start. When the option is set to no, the user requires# to fix the AOF file using the &quot;redis-check-aof&quot; utility before to restart# the server.## Note that if the AOF file will be found to be corrupted in the middle# the server will still exit with an error. This option only applies when# Redis will try to read more data from the AOF file but not enough bytes# will be found.aof-load-truncated yes# When rewriting the AOF file, Redis is able to use an RDB preamble in the# AOF file for faster rewrites and recoveries. When this option is turned# on the rewritten AOF file is composed of two different stanzas:##   [RDB file][AOF tail]## When loading Redis recognizes that the AOF file starts with the &quot;REDIS&quot;# string and loads the prefixed RDB file, and continues loading the AOF# tail.aof-use-rdb-preamble yes################################ LUA SCRIPTING  ################################ Max execution time of a Lua script in milliseconds.## If the maximum execution time is reached Redis will log that a script is# still in execution after the maximum allowed time and will start to# reply to queries with an error.## When a long running script exceeds the maximum execution time only the# SCRIPT KILL and SHUTDOWN NOSAVE commands are available. The first can be# used to stop a script that did not yet called write commands. The second# is the only way to shut down the server in the case a write command was# already issued by the script but the user doesn&#39;t want to wait for the natural# termination of the script.## Set it to 0 or a negative value for unlimited execution without warnings.lua-time-limit 5000################################ REDIS CLUSTER  ################################ Normal Redis instances can&#39;t be part of a Redis Cluster; only nodes that are# started as cluster nodes can. In order to start a Redis instance as a# cluster node enable the cluster support uncommenting the following:## cluster-enabled yes# Every cluster node has a cluster configuration file. This file is not# intended to be edited by hand. It is created and updated by Redis nodes.# Every Redis Cluster node requires a different cluster configuration file.# Make sure that instances running in the same system do not have# overlapping cluster configuration file names.## cluster-config-file nodes-6379.conf# Cluster node timeout is the amount of milliseconds a node must be unreachable# for it to be considered in failure state.# Most other internal time limits are multiple of the node timeout.## cluster-node-timeout 15000# A replica of a failing master will avoid to start a failover if its data# looks too old.## There is no simple way for a replica to actually have an exact measure of# its &quot;data age&quot;, so the following two checks are performed:## 1) If there are multiple replicas able to failover, they exchange messages#    in order to try to give an advantage to the replica with the best#    replication offset (more data from the master processed).#    Replicas will try to get their rank by offset, and apply to the start#    of the failover a delay proportional to their rank.## 2) Every single replica computes the time of the last interaction with#    its master. This can be the last ping or command received (if the master#    is still in the &quot;connected&quot; state), or the time that elapsed since the#    disconnection with the master (if the replication link is currently down).#    If the last interaction is too old, the replica will not try to failover#    at all.## The point &quot;2&quot; can be tuned by user. Specifically a replica will not perform# the failover if, since the last interaction with the master, the time# elapsed is greater than:##   (node-timeout * replica-validity-factor) + repl-ping-replica-period## So for example if node-timeout is 30 seconds, and the replica-validity-factor# is 10, and assuming a default repl-ping-replica-period of 10 seconds, the# replica will not try to failover if it was not able to talk with the master# for longer than 310 seconds.## A large replica-validity-factor may allow replicas with too old data to failover# a master, while a too small value may prevent the cluster from being able to# elect a replica at all.## For maximum availability, it is possible to set the replica-validity-factor# to a value of 0, which means, that replicas will always try to failover the# master regardless of the last time they interacted with the master.# (However they&#39;ll always try to apply a delay proportional to their# offset rank).## Zero is the only value able to guarantee that when all the partitions heal# the cluster will always be able to continue.## cluster-replica-validity-factor 10# Cluster replicas are able to migrate to orphaned masters, that are masters# that are left without working replicas. This improves the cluster ability# to resist to failures as otherwise an orphaned master can&#39;t be failed over# in case of failure if it has no working replicas.## Replicas migrate to orphaned masters only if there are still at least a# given number of other working replicas for their old master. This number# is the &quot;migration barrier&quot;. A migration barrier of 1 means that a replica# will migrate only if there is at least 1 other working replica for its master# and so forth. It usually reflects the number of replicas you want for every# master in your cluster.## Default is 1 (replicas migrate only if their masters remain with at least# one replica). To disable migration just set it to a very large value.# A value of 0 can be set but is useful only for debugging and dangerous# in production.## cluster-migration-barrier 1# By default Redis Cluster nodes stop accepting queries if they detect there# is at least an hash slot uncovered (no available node is serving it).# This way if the cluster is partially down (for example a range of hash slots# are no longer covered) all the cluster becomes, eventually, unavailable.# It automatically returns available as soon as all the slots are covered again.## However sometimes you want the subset of the cluster which is working,# to continue to accept queries for the part of the key space that is still# covered. In order to do so, just set the cluster-require-full-coverage# option to no.## cluster-require-full-coverage yes# This option, when set to yes, prevents replicas from trying to failover its# master during master failures. However the master can still perform a# manual failover, if forced to do so.## This is useful in different scenarios, especially in the case of multiple# data center operations, where we want one side to never be promoted if not# in the case of a total DC failure.## cluster-replica-no-failover no# In order to setup your cluster make sure to read the documentation# available at http://redis.io web site.########################## CLUSTER DOCKER/NAT support  ######################### In certain deployments, Redis Cluster nodes address discovery fails, because# addresses are NAT-ted or because ports are forwarded (the typical case is# Docker and other containers).## In order to make Redis Cluster working in such environments, a static# configuration where each node knows its public address is needed. The# following two options are used for this scope, and are:## * cluster-announce-ip# * cluster-announce-port# * cluster-announce-bus-port## Each instruct the node about its address, client port, and cluster message# bus port. The information is then published in the header of the bus packets# so that other nodes will be able to correctly map the address of the node# publishing the information.## If the above options are not used, the normal Redis Cluster auto-detection# will be used instead.## Note that when remapped, the bus port may not be at the fixed offset of# clients port + 10000, so you can specify any port and bus-port depending# on how they get remapped. If the bus-port is not set, a fixed offset of# 10000 will be used as usually.## Example:## cluster-announce-ip 10.1.1.5# cluster-announce-port 6379# cluster-announce-bus-port 6380################################## SLOW LOG #################################### The Redis Slow Log is a system to log queries that exceeded a specified# execution time. The execution time does not include the I/O operations# like talking with the client, sending the reply and so forth,# but just the time needed to actually execute the command (this is the only# stage of command execution where the thread is blocked and can not serve# other requests in the meantime).## You can configure the slow log with two parameters: one tells Redis# what is the execution time, in microseconds, to exceed in order for the# command to get logged, and the other parameter is the length of the# slow log. When a new command is logged the oldest one is removed from the# queue of logged commands.# The following time is expressed in microseconds, so 1000000 is equivalent# to one second. Note that a negative number disables the slow log, while# a value of zero forces the logging of every command.slowlog-log-slower-than 10000# There is no limit to this length. Just be aware that it will consume memory.# You can reclaim memory used by the slow log with SLOWLOG RESET.slowlog-max-len 128################################ LATENCY MONITOR ############################### The Redis latency monitoring subsystem samples different operations# at runtime in order to collect data related to possible sources of# latency of a Redis instance.## Via the LATENCY command this information is available to the user that can# print graphs and obtain reports.## The system only logs operations that were performed in a time equal or# greater than the amount of milliseconds specified via the# latency-monitor-threshold configuration directive. When its value is set# to zero, the latency monitor is turned off.## By default latency monitoring is disabled since it is mostly not needed# if you don&#39;t have latency issues, and collecting data has a performance# impact, that while very small, can be measured under big load. Latency# monitoring can easily be enabled at runtime using the command# &quot;CONFIG SET latency-monitor-threshold &lt;milliseconds&gt;&quot; if needed.latency-monitor-threshold 0############################# EVENT NOTIFICATION ############################### Redis can notify Pub/Sub clients about events happening in the key space.# This feature is documented at http://redis.io/topics/notifications## For instance if keyspace events notification is enabled, and a client# performs a DEL operation on key &quot;foo&quot; stored in the Database 0, two# messages will be published via Pub/Sub:## PUBLISH __keyspace@0__:foo del# PUBLISH __keyevent@0__:del foo## It is possible to select the events that Redis will notify among a set# of classes. Every class is identified by a single character:##  K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.#  E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.#  g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...#  $     String commands#  l     List commands#  s     Set commands#  h     Hash commands#  z     Sorted set commands#  x     Expired events (events generated every time a key expires)#  e     Evicted events (events generated when a key is evicted for maxmemory)#  A     Alias for g$lshzxe, so that the &quot;AKE&quot; string means all the events.##  The &quot;notify-keyspace-events&quot; takes as argument a string that is composed#  of zero or multiple characters. The empty string means that notifications#  are disabled.##  Example: to enable list and generic events, from the point of view of the#           event name, use:##  notify-keyspace-events Elg##  Example 2: to get the stream of the expired keys subscribing to channel#             name __keyevent@0__:expired use:##  notify-keyspace-events Ex##  By default all notifications are disabled because most users don&#39;t need#  this feature and the feature has some overhead. Note that if you don&#39;t#  specify at least one of K or E, no events will be delivered.notify-keyspace-events &quot;&quot;############################### ADVANCED CONFIG ################################ Hashes are encoded using a memory efficient data structure when they have a# small number of entries, and the biggest entry does not exceed a given# threshold. These thresholds can be configured using the following directives.hash-max-ziplist-entries 512hash-max-ziplist-value 64# Lists are also encoded in a special way to save a lot of space.# The number of entries allowed per internal list node can be specified# as a fixed maximum size or a maximum number of elements.# For a fixed maximum size, use -5 through -1, meaning:# -5: max size: 64 Kb  &lt;-- not recommended for normal workloads# -4: max size: 32 Kb  &lt;-- not recommended# -3: max size: 16 Kb  &lt;-- probably not recommended# -2: max size: 8 Kb   &lt;-- good# -1: max size: 4 Kb   &lt;-- good# Positive numbers mean store up to _exactly_ that number of elements# per list node.# The highest performing option is usually -2 (8 Kb size) or -1 (4 Kb size),# but if your use case is unique, adjust the settings as necessary.list-max-ziplist-size -2# Lists may also be compressed.# Compress depth is the number of quicklist ziplist nodes from *each* side of# the list to *exclude* from compression.  The head and tail of the list# are always uncompressed for fast push/pop operations.  Settings are:# 0: disable all list compression# 1: depth 1 means &quot;don&#39;t start compressing until after 1 node into the list,#    going from either the head or tail&quot;#    So: [head]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[tail]#    [head], [tail] will always be uncompressed; inner nodes will compress.# 2: [head]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[tail]#    2 here means: don&#39;t compress head or head-&gt;next or tail-&gt;prev or tail,#    but compress all nodes between them.# 3: [head]-&gt;[next]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[prev]-&gt;[tail]# etc.list-compress-depth 0# Sets have a special encoding in just one case: when a set is composed# of just strings that happen to be integers in radix 10 in the range# of 64 bit signed integers.# The following configuration setting sets the limit in the size of the# set in order to use this special memory saving encoding.set-max-intset-entries 512# Similarly to hashes and lists, sorted sets are also specially encoded in# order to save a lot of space. This encoding is only used when the length and# elements of a sorted set are below the following limits:zset-max-ziplist-entries 128zset-max-ziplist-value 64# HyperLogLog sparse representation bytes limit. The limit includes the# 16 bytes header. When an HyperLogLog using the sparse representation crosses# this limit, it is converted into the dense representation.## A value greater than 16000 is totally useless, since at that point the# dense representation is more memory efficient.## The suggested value is ~ 3000 in order to have the benefits of# the space efficient encoding without slowing down too much PFADD,# which is O(N) with the sparse encoding. The value can be raised to# ~ 10000 when CPU is not a concern, but space is, and the data set is# composed of many HyperLogLogs with cardinality in the 0 - 15000 range.hll-sparse-max-bytes 3000# Streams macro node max size / items. The stream data structure is a radix# tree of big nodes that encode multiple items inside. Using this configuration# it is possible to configure how big a single node can be in bytes, and the# maximum number of items it may contain before switching to a new node when# appending new stream entries. If any of the following settings are set to# zero, the limit is ignored, so for instance it is possible to set just a# max entires limit by setting max-bytes to 0 and max-entries to the desired# value.stream-node-max-bytes 4096stream-node-max-entries 100# Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in# order to help rehashing the main Redis hash table (the one mapping top-level# keys to values). The hash table implementation Redis uses (see dict.c)# performs a lazy rehashing: the more operation you run into a hash table# that is rehashing, the more rehashing &quot;steps&quot; are performed, so if the# server is idle the rehashing is never complete and some more memory is used# by the hash table.## The default is to use this millisecond 10 times every second in order to# actively rehash the main dictionaries, freeing memory when possible.## If unsure:# use &quot;activerehashing no&quot; if you have hard latency requirements and it is# not a good thing in your environment that Redis can reply from time to time# to queries with 2 milliseconds delay.## use &quot;activerehashing yes&quot; if you don&#39;t have such hard requirements but# want to free memory asap when possible.activerehashing yes# The client output buffer limits can be used to force disconnection of clients# that are not reading data from the server fast enough for some reason (a# common reason is that a Pub/Sub client can&#39;t consume messages as fast as the# publisher can produce them).## The limit can be set differently for the three different classes of clients:## normal -&gt; normal clients including MONITOR clients# replica  -&gt; replica clients# pubsub -&gt; clients subscribed to at least one pubsub channel or pattern## The syntax of every client-output-buffer-limit directive is the following:## client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;## A client is immediately disconnected once the hard limit is reached, or if# the soft limit is reached and remains reached for the specified number of# seconds (continuously).# So for instance if the hard limit is 32 megabytes and the soft limit is# 16 megabytes / 10 seconds, the client will get disconnected immediately# if the size of the output buffers reach 32 megabytes, but will also get# disconnected if the client reaches 16 megabytes and continuously overcomes# the limit for 10 seconds.## By default normal clients are not limited because they don&#39;t receive data# without asking (in a push way), but just after a request, so only# asynchronous clients may create a scenario where data is requested faster# than it can read.## Instead there is a default limit for pubsub and replica clients, since# subscribers and replicas receive data in a push fashion.## Both the hard or the soft limit can be disabled by setting them to zero.client-output-buffer-limit normal 0 0 0client-output-buffer-limit replica 256mb 64mb 60client-output-buffer-limit pubsub 32mb 8mb 60# Client query buffers accumulate new commands. They are limited to a fixed# amount by default in order to avoid that a protocol desynchronization (for# instance due to a bug in the client) will lead to unbound memory usage in# the query buffer. However you can configure it here if you have very special# needs, such us huge multi/exec requests or alike.## client-query-buffer-limit 1gb# In the Redis protocol, bulk requests, that are, elements representing single# strings, are normally limited ot 512 mb. However you can change this limit# here.## proto-max-bulk-len 512mb# Redis calls an internal function to perform many background tasks, like# closing connections of clients in timeout, purging expired keys that are# never requested, and so forth.## Not all tasks are performed with the same frequency, but Redis checks for# tasks to perform according to the specified &quot;hz&quot; value.## By default &quot;hz&quot; is set to 10. Raising the value will use more CPU when# Redis is idle, but at the same time will make Redis more responsive when# there are many keys expiring at the same time, and timeouts may be# handled with more precision.## The range is between 1 and 500, however a value over 100 is usually not# a good idea. Most users should use the default of 10 and raise this up to# 100 only in environments where very low latency is required.hz 10# Normally it is useful to have an HZ value which is proportional to the# number of clients connected. This is useful in order, for instance, to# avoid too many clients are processed for each background task invocation# in order to avoid latency spikes.## Since the default HZ value by default is conservatively set to 10, Redis# offers, and enables by default, the ability to use an adaptive HZ value# which will temporary raise when there are many connected clients.## When dynamic HZ is enabled, the actual configured HZ will be used as# as a baseline, but multiples of the configured HZ value will be actually# used as needed once more clients are connected. In this way an idle# instance will use very little CPU time while a busy instance will be# more responsive.dynamic-hz yes# When a child rewrites the AOF file, if the following option is enabled# the file will be fsync-ed every 32 MB of data generated. This is useful# in order to commit the file to the disk more incrementally and avoid# big latency spikes.aof-rewrite-incremental-fsync yes# When redis saves RDB file, if the following option is enabled# the file will be fsync-ed every 32 MB of data generated. This is useful# in order to commit the file to the disk more incrementally and avoid# big latency spikes.rdb-save-incremental-fsync yes# Redis LFU eviction (see maxmemory setting) can be tuned. However it is a good# idea to start with the default settings and only change them after investigating# how to improve the performances and how the keys LFU change over time, which# is possible to inspect via the OBJECT FREQ command.## There are two tunable parameters in the Redis LFU implementation: the# counter logarithm factor and the counter decay time. It is important to# understand what the two parameters mean before changing them.## The LFU counter is just 8 bits per key, it&#39;s maximum value is 255, so Redis# uses a probabilistic increment with logarithmic behavior. Given the value# of the old counter, when a key is accessed, the counter is incremented in# this way:## 1. A random number R between 0 and 1 is extracted.# 2. A probability P is calculated as 1/(old_value*lfu_log_factor+1).# 3. The counter is incremented only if R &lt; P.## The default lfu-log-factor is 10. This is a table of how the frequency# counter changes with a different number of accesses with different# logarithmic factors:## +--------+------------+------------+------------+------------+------------+# | factor | 100 hits   | 1000 hits  | 100K hits  | 1M hits    | 10M hits   |# +--------+------------+------------+------------+------------+------------+# | 0      | 104        | 255        | 255        | 255        | 255        |# +--------+------------+------------+------------+------------+------------+# | 1      | 18         | 49         | 255        | 255        | 255        |# +--------+------------+------------+------------+------------+------------+# | 10     | 10         | 18         | 142        | 255        | 255        |# +--------+------------+------------+------------+------------+------------+# | 100    | 8          | 11         | 49         | 143        | 255        |# +--------+------------+------------+------------+------------+------------+## NOTE: The above table was obtained by running the following commands:##   redis-benchmark -n 1000000 incr foo#   redis-cli object freq foo## NOTE 2: The counter initial value is 5 in order to give new objects a chance# to accumulate hits.## The counter decay time is the time, in minutes, that must elapse in order# for the key counter to be divided by two (or decremented if it has a value# less &lt;= 10).## The default value for the lfu-decay-time is 1. A Special value of 0 means to# decay the counter every time it happens to be scanned.## lfu-log-factor 10# lfu-decay-time 1########################### ACTIVE DEFRAGMENTATION ######################### WARNING THIS FEATURE IS EXPERIMENTAL. However it was stress tested# even in production and manually tested by multiple engineers for some# time.## What is active defragmentation?# -------------------------------## Active (online) defragmentation allows a Redis server to compact the# spaces left between small allocations and deallocations of data in memory,# thus allowing to reclaim back memory.## Fragmentation is a natural process that happens with every allocator (but# less so with Jemalloc, fortunately) and certain workloads. Normally a server# restart is needed in order to lower the fragmentation, or at least to flush# away all the data and create it again. However thanks to this feature# implemented by Oran Agra for Redis 4.0 this process can happen at runtime# in an &quot;hot&quot; way, while the server is running.## Basically when the fragmentation is over a certain level (see the# configuration options below) Redis will start to create new copies of the# values in contiguous memory regions by exploiting certain specific Jemalloc# features (in order to understand if an allocation is causing fragmentation# and to allocate it in a better place), and at the same time, will release the# old copies of the data. This process, repeated incrementally for all the keys# will cause the fragmentation to drop back to normal values.## Important things to understand:## 1. This feature is disabled by default, and only works if you compiled Redis#    to use the copy of Jemalloc we ship with the source code of Redis.#    This is the default with Linux builds.## 2. You never need to enable this feature if you don&#39;t have fragmentation#    issues.## 3. Once you experience fragmentation, you can enable this feature when#    needed with the command &quot;CONFIG SET activedefrag yes&quot;.## The configuration parameters are able to fine tune the behavior of the# defragmentation process. If you are not sure about what they mean it is# a good idea to leave the defaults untouched.# Enabled active defragmentation# activedefrag yes# Minimum amount of fragmentation waste to start active defrag# active-defrag-ignore-bytes 100mb# Minimum percentage of fragmentation to start active defrag# active-defrag-threshold-lower 10# Maximum percentage of fragmentation at which we use maximum effort# active-defrag-threshold-upper 100# Minimal effort for defrag in CPU percentage# active-defrag-cycle-min 5# Maximal effort for defrag in CPU percentage# active-defrag-cycle-max 75# Maximum number of set/hash/zset/list fields that will be processed from# the main dictionary scan# active-defrag-max-scan-fields 1000</code></pre><p><strong>å¸¸ç”¨çš„å‚æ•°</strong><br><a href="https://www.runoob.com/redis/redis-conf.html" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹å¸¸ç”¨çš„é…ç½®å‚æ•°èµ„æ–™</a></p><h3 id="RedisåŸºæœ¬æµ‹è¯•redis-benchmark"><a href="#RedisåŸºæœ¬æµ‹è¯•redis-benchmark" class="headerlink" title="RedisåŸºæœ¬æµ‹è¯•redis-benchmark"></a><code>Redis</code>åŸºæœ¬æµ‹è¯•<code>redis-benchmark</code></h3><pre><code class="bash">1    -h    æŒ‡å®šæœåŠ¡å™¨ä¸»æœºå    127.0.0.12    -p    æŒ‡å®šæœåŠ¡å™¨ç«¯å£    63793    -s    æŒ‡å®šæœåŠ¡å™¨ socket    4    -c    æŒ‡å®šå¹¶å‘è¿æ¥æ•°    505    -n    æŒ‡å®šè¯·æ±‚æ•°    100006    -d    ä»¥å­—èŠ‚çš„å½¢å¼æŒ‡å®š SET/GET å€¼çš„æ•°æ®å¤§å°    27    -k    1=keep alive 0=reconnect    18    -r    SET/GET/INCR ä½¿ç”¨éšæœº key, SADD ä½¿ç”¨éšæœºå€¼    9    -P    é€šè¿‡ç®¡é“ä¼ è¾“ &lt;numreq&gt; è¯·æ±‚    110    -q    å¼ºåˆ¶é€€å‡º redisã€‚ä»…æ˜¾ç¤º query/sec å€¼    11    --csv    ä»¥ CSV æ ¼å¼è¾“å‡º    12    -l    ç”Ÿæˆå¾ªç¯ï¼Œæ°¸ä¹…æ‰§è¡Œæµ‹è¯•    13    -t    ä»…è¿è¡Œä»¥é€—å·åˆ†éš”çš„æµ‹è¯•å‘½ä»¤åˆ—è¡¨ã€‚    14    -I    Idle æ¨¡å¼ã€‚ä»…æ‰“å¼€ N ä¸ª idle è¿æ¥å¹¶ç­‰å¾…ã€‚    </code></pre><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p><strong>ä»¥ä¸‹å®ä¾‹æˆ‘ä»¬ä½¿ç”¨äº†å¤šä¸ªå‚æ•°æ¥æµ‹è¯• redis æ€§èƒ½ï¼š</strong></p><pre><code class="bash">$ redis-benchmark -h 127.0.0.1 -p 6379 -t set,lpush -n 10000 -qSET: 146198.83 requests per secondLPUSH: 145560.41 requests per second</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ…è°ˆåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—</title>
    <link href="/2020/05/27/%E6%B5%85%E8%B0%88%E5%88%86%E5%B8%83%E5%BC%8F%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    <url>/2020/05/27/%E6%B5%85%E8%B0%88%E5%88%86%E5%B8%83%E5%BC%8F%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—"><a href="#ä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="ä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—?"></a>ä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—?</h2><p><code>æ¶ˆæ¯é˜Ÿåˆ—</code>è¿™ä¸ªè¯é™Œç”Ÿäººä¸€å¬æŒ–æ§½å¥½ç‰›é€¼å•Šå¥½é«˜å¤§ä¸Šå•Šï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šç®€ç§°å®ƒä¸º<code>MQ(Message Queue)</code>ï¼Œå—¯ï¼Œå°±æ˜¯å¾ˆç›´ç™½çš„ç®€å†™ã€‚</p><ul><li>é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„</li><li>æ¶ˆæ¯é˜Ÿåˆ—<code>ï¼ˆMessageQueueï¼‰</code>æ˜¯ä¸€ç§åº”ç”¨é—´çš„é€šä¿¡æ–¹å¼</li><li>æ¶ˆæ¯å¯ä»¥éå¸¸ç®€å•ï¼Œæ¯”å¦‚åªåŒ…å«æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ›´å¤æ‚ï¼Œå¯èƒ½åŒ…å«åµŒå…¥å¯¹è±¡</li><li>æ¶ˆæ¯å‘é€è€… å¯ä»¥å‘é€ä¸€ä¸ªæ¶ˆæ¯è€Œæ— é¡»ç­‰å¾…å“åº”ã€‚æ¶ˆæ¯å‘é€è€… å°†æ¶ˆæ¯å‘é€åˆ°ä¸€æ¡ è™šæ‹Ÿçš„é€šé“ï¼ˆä¸»é¢˜ æˆ– é˜Ÿåˆ—ï¼‰ä¸Šï¼Œæ¶ˆæ¯æ¥æ”¶è€… åˆ™ è®¢é˜… æˆ–æ˜¯ ç›‘å¬ è¯¥é€šé“ã€‚ä¸€æ¡ä¿¡æ¯å¯èƒ½æœ€ç»ˆè½¬å‘ç»™ ä¸€ä¸ªæˆ–å¤šä¸ª æ¶ˆæ¯æ¥æ”¶è€…ï¼Œè¿™äº›æ¥æ”¶è€…éƒ½æ— éœ€å¯¹ æ¶ˆæ¯å‘é€è€… åšå‡º åŒæ­¥å›åº”ã€‚æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯ å¼‚æ­¥çš„ã€‚</li></ul><blockquote><p>ç»´åŸºç™¾ç§‘ä¸Šæ˜¯è¿™ä¹ˆæè¿°çš„: åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æˆ–åŒä¸€è¿›ç¨‹çš„ä¸åŒçº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼Œè½¯ä»¶çš„è´®åˆ—ç”¨æ¥å¤„ç†ä¸€ç³»åˆ—çš„è¾“å…¥ï¼Œé€šå¸¸æ˜¯æ¥è‡ªç”¨æˆ·ã€‚æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å¼‚æ­¥çš„é€šä¿¡åè®®ï¼Œæ¯ä¸€ä¸ªè´®åˆ—ä¸­çš„çºªå½•åŒ…å«è¯¦ç»†è¯´æ˜çš„æ•°æ®ï¼ŒåŒ…å«å‘ç”Ÿçš„æ—¶é—´ï¼Œè¾“å…¥è®¾å¤‡çš„ç§ç±»ï¼Œä»¥åŠç‰¹å®šçš„è¾“å…¥å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šæ¶ˆæ¯çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¸éœ€è¦åŒæ—¶ä¸æ¶ˆæ¯é˜Ÿåˆ—äº¤äº’ã€‚</p></blockquote><p><strong>æˆ‘<code>SDing</code>ä¸ªäººæ€»ç»“å°±æ˜¯: æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„æ•°æ®å­˜å‚¨å®¹å™¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä¸åŒçš„ç¨‹åºä¹‹é—´è¿›è¡Œæ•°æ®çš„é€šè®¯ã€‚</strong></p><h2 id="å‘å¸ƒ-è®¢é˜…"><a href="#å‘å¸ƒ-è®¢é˜…" class="headerlink" title="å‘å¸ƒ/è®¢é˜…"></a>å‘å¸ƒ/è®¢é˜…</h2><p>è¯´åˆ°æ¶ˆæ¯é˜Ÿåˆ—å°±è¦è¯´åˆ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢æœ€å¸¸ç”¨çš„æ–¹å¼å°±æ˜¯å‘å¸ƒå’Œè®¢é˜…äº†ã€‚</p><blockquote><p>ç»´åŸºç™¾ç§‘ä¸Šæ˜¯è¿™ä¹ˆæè¿°çš„: åœ¨è½¯ä»¶æ¶æ„ä¸­ï¼Œå‘å¸ƒ-è®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯èŒƒå¼ï¼Œæ¶ˆæ¯çš„å‘é€è€…ä¸ä¼šå°†æ¶ˆæ¯ç›´æ¥å‘é€ç»™ç‰¹å®šçš„æ¥æ”¶è€…ã€‚è€Œæ˜¯å°†å‘å¸ƒçš„æ¶ˆæ¯åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œæ— éœ€äº†è§£å“ªäº›è®¢é˜…è€…å¯èƒ½å­˜åœ¨ã€‚åŒæ ·çš„ï¼Œè®¢é˜…è€…å¯ä»¥è¡¨è¾¾å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç±»åˆ«çš„å…´è¶£ï¼Œåªæ¥æ”¶æ„Ÿå…´è¶£çš„æ¶ˆæ¯ï¼Œæ— éœ€äº†è§£å“ªäº›å‘å¸ƒè€…å­˜åœ¨ã€‚ å‘å¸ƒ/è®¢é˜…æ˜¯æ¶ˆæ¯é˜Ÿåˆ—èŒƒå¼çš„å…„å¼Ÿï¼Œé€šå¸¸æ˜¯æ›´å¤§çš„é¢å‘æ¶ˆæ¯ä¸­é—´ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚ </p></blockquote><ul><li>æ¶ˆæ¯ç”Ÿäº§è€… ï¼ˆç”Ÿäº§æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼‰</li><li>æ¶ˆæ¯ä¸­é—´ä»¶ <code>(Kafka,Nsq,RabbitMQ)</code></li><li>æ¶ˆæ¯æ¶ˆè´¹è€…  (ä»æ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢æ‹¿å–è®¢é˜…çš„æ¶ˆæ¯)</li></ul><p><strong>æˆ‘çš„ä¸€å¥è¯æ€»ç»“å°±æ˜¯: æ¶ˆæ¯å‘å¸ƒå’Œè®¢é˜…å°±æ˜¯ä¸€ä¸ªæ¶æ„æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸åŒçš„ç¨‹åºä¹‹é—´è·å–è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œè§£è€¦æ¨¡å¼ã€‚</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf7dwe18p4j30hj07vaaq.jpg" srcset="/img/loading.gif" alt="æ¶ˆæ¯é˜Ÿåˆ—"></p><p>å¯ä»¥çœ‹çœ‹è¿™ä¸ªå€”é‡‘çš„æ–‡ç« :<a href="https://juejin.im/post/5cb025fb5188251b0351ef48" target="_blank" rel="noopener">æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦</a> or <a href="https://juejin.im/post/5b41fe36e51d45191252e79e" target="_blank" rel="noopener">æ¶ˆæ¯é˜Ÿåˆ—è¯¦è§£</a></p><h2 id="å¸¸è§ä¸­é—´ä»¶"><a href="#å¸¸è§ä¸­é—´ä»¶" class="headerlink" title="å¸¸è§ä¸­é—´ä»¶"></a>å¸¸è§ä¸­é—´ä»¶</h2><ol><li>NSQ</li><li>Kafka</li><li>ZeroMQ</li><li>MetaMQ</li><li>RabbitMQ</li><li>RocketMQ</li><li>ActiveMQ</li><li>Redis (ä¸»è¦æ˜¯ç¼“å­˜ä½†æ˜¯ä¹Ÿå¯ä»¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—)</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Code-Serveræ­å»º</title>
    <link href="/2020/05/26/Code-Server%E6%90%AD%E5%BB%BA/"/>
    <url>/2020/05/26/Code-Server%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5z665ly1j30dc06o74k.jpg" srcset="/img/loading.gif" alt=""></p><blockquote><p>åœ¨æˆ‘ä»¬å¼€å‘è°ƒè¯•ç¨‹åºçš„æ—¶å€™æˆ‘ä»¬çš„ä¸€äº›ç¨‹åºéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä½†æ˜¯å¾ˆå¤šé…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬ä¿®æ”¹èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä½¿ç”¨æˆ‘ä»¬å¯ä»¥é€šè¿‡vscodeæœåŠ¡å™¨ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚</p></blockquote><h2 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h2><p>å®‰è£…å¯ä»¥é€šè¿‡è¿™ä¸ª<code>https://github.com/cdr/code-server</code>ä»“åº“ä¸Šé¢çš„æ–‡ä»¶æ¥ã€‚</p><p><strong>æ ¹æ®è‡ªå·±å¯¹åº”çš„ç³»ç»Ÿç‰ˆæœ¬å®‰è£…</strong></p><h3 id="Debian-Ubuntu"><a href="#Debian-Ubuntu" class="headerlink" title="Debian, Ubuntu"></a>Debian, Ubuntu</h3><pre><code class="shell">curl -sSOL https://github.com/cdr/code-server/releases/download/v3.3.1/code-server_3.3.1_amd64.debsudo dpkg -i code-server_3.3.1_amd64.debsystemctl --user enable --now code-server# Now visit http://127.0.0.1:8080. Your password is in ~/.config/code-server/config.yaml</code></pre><h3 id="Fedora-Red-Hat-SUSE"><a href="#Fedora-Red-Hat-SUSE" class="headerlink" title="Fedora, Red Hat, SUSE"></a>Fedora, Red Hat, SUSE</h3><pre><code class="shell">curl -sSOL https://github.com/cdr/code-server/releases/download/v3.3.1/code-server-3.3.1-amd64.rpmsudo yum install -y code-server-3.3.1-amd64.rpmsystemctl --user enable --now code-server# Now visit http://127.0.0.1:8080. Your password is in ~/.config/code-server/config.yaml</code></pre><h3 id="Arch-Linux"><a href="#Arch-Linux" class="headerlink" title="Arch Linux"></a>Arch Linux</h3><pre><code class="shell"># Installs code-server from the AUR using yay.yay -S code-serversystemctl --user enable --now code-server# Now visit http://127.0.0.1:8080. Your password is in ~/.config/code-server/config.yaml# Installs code-server from the AUR with plain makepkg.git clone https://aur.archlinux.org/code-server.gitcd code-servermakepkg -sisystemctl --user enable --now code-server</code></pre><p>é»˜è®¤è®¿é—®åœ°å€: <code>http://127.0.0.1:8080</code>. é»˜è®¤å¯†ç é…ç½®:<code>~/.config/code-server/config.yaml</code></p><h3 id="Firewall-wall-setting-port"><a href="#Firewall-wall-setting-port" class="headerlink" title="Firewall wall setting port"></a>Firewall wall setting port</h3><p>  <code>â€“permanent</code> æ·»åŠ è¿™ä¸ªå‚æ•°é˜²ç«å¢™æ°¸ä¹…ç”Ÿæ•ˆ. </p><p>  é»˜è®¤ç«¯å£æ˜¯ 8080.</p><pre><code>$: firewall-cmd --zone=public --add-port=8080/tcp --permanent# åˆ·æ–°é…ç½®$: firewall-cmd --reload</code></pre><h3 id="Edit-config-file"><a href="#Edit-config-file" class="headerlink" title="Edit config file"></a>Edit config file</h3><p>  ä½¿ç”¨ <code>vi</code> æ‰“å¼€é…ç½®æ–‡ä»¶<code>~/.config/code-server/config.yaml</code></p><pre><code>$: vi  ~/.config/code-server/config.yaml</code></pre><p>  ä½¿ç”¨é”®ç›˜<code>i</code> é”®è¿›å…¥insertæ¨¡å¼</p><pre><code> bind-addr: 127.0.0.1:8080        auth: password password: 706039b9fa******b847cec0c cert: false ~ ~ -- INSERT --</code></pre><p>   <code>bind-addr</code> ä¿®æ”¹ä¸º <code>0.0.0.0:8080</code> (è¿™æ ·å°±å¯ä»¥è¿œç¨‹è®¿é—®)<br>   <code>password</code> ä¿®æ”¹ä¸ºä½ è‡ªå®šä¹‰å¯†ç </p><p>  æŒ‰é”®ç›˜ä¸Šçš„<code>esc</code> é”®è¾“å…¥<code>: wq</code> ä¿å­˜é€€å‡ºæ–‡ä»¶</p><h3 id="å¯åŠ¨æœåŠ¡å™¨"><a href="#å¯åŠ¨æœåŠ¡å™¨" class="headerlink" title="å¯åŠ¨æœåŠ¡å™¨"></a>å¯åŠ¨æœåŠ¡å™¨</h3><pre><code>$: /usr/bin/code-server</code></pre><p>output:</p><pre><code>[root@vultr ~]# /usr/bin/code-serverinfo  Wrote default config file to ~/.config/code-server/config.yamlinfo  Using config file ~/.config/code-server/config.yamlinfo  Using user-data-dir ~/.local/share/code-serverinfo  code-server 3.3.1 6f1309795e1cb930edba68cdc7c3dcaa01da0ab3info  HTTP server listening on http://127.0.0.1:8080info      - Using password from ~/.config/code-server/config.yamlinfo      - To disable use `--auth none`info    - Not serving HTTPS</code></pre><p><strong>ä¸éœ€è¦å¯†ç å¯ä»¥æ·»åŠ  <code>-auth none</code> å‚æ•°</strong></p><p> <strong>or  start by designated user</strong></p><pre><code>$:  systemctl --user enable --now code-server</code></pre><p> <strong>now visit <a href="http://your.server.address:8080" target="_blank" rel="noopener">http://your.server.address:8080</a>. Good luck~</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>vscode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Azureä¸Šå®‰è£…Kafka</title>
    <link href="/2020/05/25/Azure%E4%B8%8A%E5%AE%89%E8%A3%85Kafka/"/>
    <url>/2020/05/25/Azure%E4%B8%8A%E5%AE%89%E8%A3%85Kafka/</url>
    
    <content type="html"><![CDATA[<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf4liai3d3j30k008jt9d.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="ä»€ä¹ˆæ˜¯Kafka"><a href="#ä»€ä¹ˆæ˜¯Kafka" class="headerlink" title="ä»€ä¹ˆæ˜¯Kafka?"></a>ä»€ä¹ˆæ˜¯Kafka?</h2><p>Kafka æ˜¯ä¸€ç§é«˜ååé‡çš„åˆ†å¸ƒå¼å‘å¸ƒè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿï¼Œå®ƒå¯ä»¥å¤„ç†æ¶ˆè´¹è€…åœ¨ç½‘ç«™ä¸­çš„æ‰€æœ‰åŠ¨ä½œæµæ•°æ®ã€‚ è¿™ç§åŠ¨ä½œï¼ˆç½‘é¡µæµè§ˆï¼Œæœç´¢å’Œå…¶ä»–ç”¨æˆ·çš„è¡ŒåŠ¨ï¼‰æ˜¯åœ¨ç°ä»£ç½‘ç»œä¸Šçš„è®¸å¤šç¤¾ä¼šåŠŸèƒ½çš„ä¸€ä¸ªå…³é”®å› ç´ ã€‚ è¿™äº›æ•°æ®é€šå¸¸æ˜¯ç”±äºååé‡çš„è¦æ±‚è€Œé€šè¿‡å¤„ç†æ—¥å¿—å’Œæ—¥å¿—èšåˆæ¥è§£å†³ã€‚<br>å¯¹äºåƒ Hadoop ä¸€æ ·çš„æ—¥å¿—æ•°æ®å’Œç¦»çº¿åˆ†æç³»ç»Ÿï¼Œä½†åˆè¦æ±‚å®æ—¶å¤„ç†çš„é™åˆ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚Kafka çš„ç›®çš„æ˜¯é€šè¿‡ Hadoop çš„å¹¶è¡ŒåŠ è½½æœºåˆ¶æ¥ç»Ÿä¸€çº¿ä¸Šå’Œç¦»çº¿çš„æ¶ˆæ¯å¤„ç†ï¼Œä¹Ÿæ˜¯ä¸ºäº†é€šè¿‡é›†ç¾¤æ¥æä¾›å®æ—¶çš„æ¶ˆæ¯ã€‚<br>Kafka æ˜¯ç”± Apache è½¯ä»¶åŸºé‡‘ä¼šå¼€å‘çš„ä¸€ä¸ªå¼€æºæµå¤„ç†å¹³å°ï¼Œç”± Scala å’Œ Java ç¼–å†™ã€‚<br>Kafka æœ€åˆæ˜¯ç”±é¢†è‹±å¼€å‘ï¼Œå¹¶éšåäº 2011 å¹´åˆå¼€æºï¼Œå¹¶äº 2012 å¹´ 10 æœˆ 23 æ—¥ç”± Apache Incubator å­µåŒ–å‡ºç«™ã€‚2014 å¹´ 11 æœˆï¼Œå‡ ä¸ªæ›¾åœ¨é¢†è‹±ä¸º Kafka å·¥ä½œçš„å·¥ç¨‹å¸ˆï¼Œåˆ›å»ºäº†åä¸º Confluent çš„æ–°å…¬å¸ï¼Œå¹¶ç€çœ¼äº Kafkaã€‚æ ¹æ® 2014 å¹´ Quora çš„å¸–å­ï¼ŒJay Kreps ä¼¼ä¹å·²ç»å°†å®ƒä»¥ä½œå®¶å¼—æœ—èŒ¨Â·å¡å¤«å¡å‘½åã€‚Kreps é€‰æ‹©å°†è¯¥ç³»ç»Ÿä»¥ä¸€ä¸ªä½œå®¶å‘½åæ˜¯å› ä¸ºï¼Œå®ƒæ˜¯â€œä¸€ä¸ªç”¨äºä¼˜åŒ–å†™ä½œçš„ç³»ç»Ÿâ€ï¼Œè€Œä¸”ä»–å¾ˆå–œæ¬¢å¡å¤«å¡çš„ä½œå“ã€‚</p><p><strong>Kafka å­˜å‚¨çš„æ¶ˆæ¯æ¥è‡ªä»»æ„å¤šè¢«ç§°ä¸ºâ€œç”Ÿäº§è€…â€ï¼ˆProducerï¼‰çš„è¿›ç¨‹ã€‚æ•°æ®ä»è€Œå¯ä»¥è¢«åˆ†é…åˆ°ä¸åŒçš„â€œåˆ†åŒºâ€ï¼ˆPartitionï¼‰ã€ä¸åŒçš„â€œTopicâ€ä¸‹ã€‚åœ¨ä¸€ä¸ªåˆ†åŒºå†…ï¼Œè¿™äº›æ¶ˆæ¯è¢«ç´¢å¼•å¹¶è¿åŒæ—¶é—´æˆ³å­˜å‚¨åœ¨ä¸€èµ·ã€‚å…¶å®ƒè¢«ç§°ä¸ºâ€œæ¶ˆè´¹è€…â€ï¼ˆConsumerï¼‰çš„è¿›ç¨‹å¯ä»¥ä»åˆ†åŒºæŸ¥è¯¢æ¶ˆæ¯ã€‚Kafka è¿è¡Œåœ¨ä¸€ä¸ªç”±ä¸€å°æˆ–å¤šå°æœåŠ¡å™¨ç»„æˆçš„é›†ç¾¤ä¸Šï¼Œå¹¶ä¸”åˆ†åŒºå¯ä»¥è·¨é›†ç¾¤ç»“ç‚¹åˆ†å¸ƒã€‚</strong></p><p><strong>Kafka é«˜æ•ˆåœ°å¤„ç†å®æ—¶æµå¼æ•°æ®ï¼Œå¯ä»¥å®ç°ä¸ Stormã€HBase å’Œ Spark çš„é›†æˆã€‚ä½œä¸ºèšç±»éƒ¨ç½²åˆ°å¤šå°æœåŠ¡å™¨ä¸Šï¼ŒKafka å¤„ç†å®ƒæ‰€æœ‰çš„å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿä½¿ç”¨äº†å››ä¸ª APIï¼Œå³ç”Ÿäº§è€… APIã€æ¶ˆè´¹è€… APIã€Stream API å’Œ Connector APIã€‚å®ƒèƒ½å¤Ÿä¼ é€’å¤§è§„æ¨¡æµå¼æ¶ˆæ¯ï¼Œè‡ªå¸¦å®¹é”™åŠŸèƒ½ï¼Œå·²ç»å–ä»£äº†ä¸€äº›ä¼ ç»Ÿæ¶ˆæ¯ç³»ç»Ÿï¼Œå¦‚ JMSã€AMQP ç­‰ã€‚</strong></p><p><strong>Kafka æ¶æ„çš„ä¸»è¦æœ¯è¯­åŒ…æ‹¬ Topicã€Record å’Œ Brokerã€‚Topic ç”± Record ç»„æˆï¼ŒRecord æŒæœ‰ä¸åŒçš„ä¿¡æ¯ï¼Œè€Œ Broker åˆ™è´Ÿè´£å¤åˆ¶æ¶ˆæ¯ã€‚Kafka æœ‰å››ä¸ªä¸»è¦ APIï¼š</strong></p><ul><li>ç”Ÿäº§è€… APIï¼šæ”¯æŒåº”ç”¨ç¨‹åºå‘å¸ƒ Record æµã€‚</li><li>æ¶ˆè´¹è€… APIï¼šæ”¯æŒåº”ç”¨ç¨‹åºè®¢é˜… Topic å’Œå¤„ç† Record æµã€‚</li><li>Stream APIï¼šå°†è¾“å…¥æµè½¬æ¢ä¸ºè¾“å‡ºæµï¼Œå¹¶äº§ç”Ÿç»“æœã€‚</li><li>Connector APIï¼šæ‰§è¡Œå¯é‡ç”¨çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… APIï¼Œå¯å°† Topic é“¾æ¥åˆ°ç°æœ‰åº”ç”¨ç¨‹åºã€‚</li></ul><p><strong>ç›¸å…³æœ¯è¯­</strong></p><ul><li>Topic ç”¨æ¥å¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ï¼Œæ¯ä¸ªè¿›å…¥åˆ° Kafka çš„ä¿¡æ¯éƒ½ä¼šè¢«æ”¾åˆ°ä¸€ä¸ª Topic ä¸‹</li><li>Broker ç”¨æ¥å®ç°æ•°æ®å­˜å‚¨çš„ä¸»æœºæœåŠ¡å™¨</li><li>Partition æ¯ä¸ª Topic ä¸­çš„æ¶ˆæ¯ä¼šè¢«åˆ†ä¸ºè‹¥å¹²ä¸ª Partitionï¼Œä»¥æé«˜æ¶ˆæ¯çš„å¤„ç†æ•ˆç‡</li><li>Producer æ¶ˆæ¯çš„ç”Ÿäº§è€…</li><li>Consumer æ¶ˆæ¯çš„æ¶ˆè´¹è€…</li><li>Consumer Group æ¶ˆæ¯çš„æ¶ˆè´¹ç¾¤ç»„</li></ul><p>ç”±äºå…¶å¹¿æ³›é›†æˆåˆ°ä¼ä¸šçº§åŸºç¡€è®¾æ–½ä¸­ï¼Œç›‘æµ‹ Kafka åœ¨è§„æ¨¡è¿è¡Œä¸­çš„æ€§èƒ½æˆä¸ºä¸€ä¸ªæ—¥ç›Šé‡è¦çš„é—®é¢˜ã€‚ç›‘æµ‹ç«¯åˆ°ç«¯æ€§èƒ½ï¼Œè¦æ±‚è·Ÿè¸ªæ‰€æœ‰æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ Brokerã€æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ã€‚é™¤æ­¤ä¹‹å¤–è¿˜è¦ç›‘æµ‹ ZooKeeperï¼ŒKafka ç”¨å®ƒæ¥åè°ƒå„ä¸ªæ¶ˆè´¹è€…ã€‚å½“å‰æœ‰ä¸€äº›ç›‘æµ‹å¹³å°å¯ä»¥è·Ÿè¸ªå¡å¤«å¡çš„æ€§èƒ½ï¼Œæœ‰å¼€æºçš„ï¼Œå¦‚é¢†è‹±çš„ Burrowï¼›ä¹Ÿæœ‰ä»˜è´¹çš„ï¼Œå¦‚ Datadogã€‚é™¤äº†è¿™äº›å¹³å°ä¹‹å¤–ï¼Œæ”¶é›† Kafka çš„æ•°æ®ä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·æ¥è¿›è¡Œï¼Œè¿™äº›å·¥å…·ä¸€èˆ¬éœ€è¦ Javaï¼ŒåŒ…æ‹¬ JConsoleã€‚</p><h2 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started"></a>Get Started</h2><p>Kafakaæ˜¯åŸºäºæ˜¯JVMè¿è¡Œçš„ç¨‹åºï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆå®‰è£…JDKæˆ–è€…JREã€‚<code>(è¿™é‡Œå°±çœ‹åˆ°äº†æˆ‘ä»¬çš„Golangä¼˜åŠ¿ï¼ï¼ï¼ï¼ç›´æ¥ç¼–è¯‘äºŒè¿›åˆ¶å•Šå“ˆå“ˆå“ˆ~)</code></p><p><strong>éœ€è¦Java 1.7æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å¦‚ä¸‹å®‰è£…OpenJDK 8</strong></p><pre><code class="shell">sudo yum install -y java-1.13.0-openjdk-devel</code></pre><p><strong>å®‰è£…äº†OpenJDK 8åï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯ç»“æœã€‚</strong></p><pre><code class="shell">java -version</code></pre><p><strong>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œè¾“å‡ºåº”ä¸æ­¤ç±»ä¼¼ã€‚</strong></p><pre><code class="shelL">openjdk version &quot;1.8.0_252&quot;OpenJDK Runtime Environment (build 1.8.0_252-b09)OpenJDK 64-Bit Server VM (build 25.252-b09, mixed mode)</code></pre><p><strong>æœ€åï¼Œè®¾ç½®JAVA_HOMEç¯å¢ƒå˜é‡ã€‚</strong></p><pre><code class="shell">echo &quot;JAVA_HOME=$(readlink -f /usr/bin/java | sed &quot;s:bin/java::&quot;)&quot; | sudo tee -a /etc/profilesource /etc/profile</code></pre><p><strong>å®‰è£…Kafka</strong></p><pre><code class="shell">wget https://downloads.apache.org/kafka/2.4.1/kafka_2.12-2.4.1.tgz</code></pre><p><strong>è§£å‹åˆ°optç›®å½•</strong></p><pre><code class="SHELL"> tar -xvf kafka_2.12-2.4.1.tgz -C /opt/</code></pre><p>è¿›å…¥Kafkaç›®å½•</p><p><code>cd /opt/kafka_2.11-0.9.0.1</code><br>å¯åŠ¨ZookeeperæœåŠ¡å™¨</p><p><code>bin/zookeeper-server-start.sh -daemon config/zookeeper.properties</code></p><p>ä¿®æ”¹KafkaæœåŠ¡å™¨çš„é…ç½®</p><p> <code>vi bin/kafka-server-start.sh</code></p><p>æ ¹æ®æ‚¨çš„ç‰¹å®šç³»ç»Ÿå‚æ•°è°ƒæ•´å†…å­˜ä½¿ç”¨é‡ã€‚</p><p><code>export KAFKA_HEAP_OPTS=&quot;-Xmx1G -Xms1G&quot;</code></p><p>æ›¿æ¢ä¸ºï¼š</p><p><code>export KAFKA_HEAP_OPTS=&quot;-Xmx256M -Xms128M&quot;</code></p><p>ä¿å­˜é€€å‡ºï¼š</p><p><code>:wq</code></p><p>å¯åŠ¨KafkaæœåŠ¡å™¨</p><p><code>bin/kafka-server-start.sh config/server.properties</code></p><p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€äº›æœ‰å…³KafkaæœåŠ¡å™¨çŠ¶æ€çš„æ¶ˆæ¯ï¼Œæœ€åä¸€æ¡å°†æ˜¾ç¤ºï¼š</p><p><code>INFO [Kafka Server 0], started (kafka.server.KafkaServer)</code></p><p>è¿™æ„å‘³ç€æ‚¨å·²ç»å¯åŠ¨äº†KafkaæœåŠ¡å™¨ã€‚</p><p>åœ¨æ–°çš„SSHè¿æ¥ä¸­åˆ›å»ºä¸»é¢˜â€œæµ‹è¯•â€</p><p>æ‰“å¼€ä¸€ä¸ªæ–°çš„SSHè¿æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸»é¢˜â€œ testâ€ï¼š</p><pre><code class="shell">cd /opt/kafka_2.11-0.9.0.1bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test</code></pre><p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ä¸»é¢˜ï¼š</p><pre><code class="shell">bin/kafka-topics.sh --list --zookeeper localhost:2181</code></pre><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¾“å‡ºå°†æ˜¾ç¤ºä¸ºï¼š</p><pre><code class="shell">test</code></pre><p>ä½¿ç”¨ä¸»é¢˜â€œæµ‹è¯•â€ç”Ÿæˆæ¶ˆæ¯</p><pre><code class="shell">bin/kafka-console-producer.sh --broker-list localhost:9092 </code></pre><p><code>--topic test</code><br>ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è¾“å…¥ä»»æ„æ•°é‡çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="shell">Welcome aboard!Bonjour!</code></pre><p>å¦‚æœæ‚¨æ”¶åˆ°ä¸â€WARN Error while fetching metadata with correlation idâ€è¾“å…¥æ¶ˆæ¯æ—¶ç±»ä¼¼çš„é”™è¯¯ï¼Œåˆ™éœ€è¦server.propertiesä½¿ç”¨ä»¥ä¸‹ä¿¡æ¯æ›´æ–°æ–‡ä»¶ï¼š</p><pre><code class="shell">port = 9092advertised.host.name = localhost </code></pre><p>æ‰“å¼€ç¬¬ä¸‰ä¸ªSSHè¿æ¥ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code class="shell">cd /opt/kafka_2.11-0.9.0.1bin/kafka-console-consumer.sh --zookeeper localhost:9092 --topic test --from-beginning</code></pre><ul><li>æ‚¨å…ˆå‰ç”Ÿæˆçš„æ¶ˆæ¯å°†æ˜¾ç¤ºåœ¨ç¬¬ä¸‰ä¸ªSSHè¿æ¥ä¸­ã€‚å½“ç„¶ï¼Œå¦‚æœæ‚¨ç°åœ¨ä»ç¬¬äºŒä¸ªSSHè¿æ¥è¾“å…¥æ›´å¤šæ¶ˆæ¯ï¼Œæ‚¨å°†ç«‹å³åœ¨ç¬¬ä¸‰ä¸ªSSHè¿æ¥ä¸Šçœ‹åˆ°å®ƒä»¬ã€‚</li></ul><p>æœ€åï¼Œæ‚¨å¯ä»¥åœ¨æ¯ä¸ªSSHè¿æ¥ä¸ŠæŒ‰Ctrl + Cç»„åˆé”®ä»¥åœæ­¢è¿™äº›è„šæœ¬ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Centos7</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSQä¹‹å¼¹å°„èµ·æ­¥</title>
    <link href="/2020/05/19/NSQ%E4%B9%8B%E5%BC%B9%E5%B0%84%E8%B5%B7%E6%AD%A5/"/>
    <url>/2020/05/19/NSQ%E4%B9%8B%E5%BC%B9%E5%B0%84%E8%B5%B7%E6%AD%A5/</url>
    
    <content type="html"><![CDATA[<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey1a5ssbvj30p00dw77v.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="NSQæ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ"><a href="#NSQæ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="NSQæ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ"></a><code>NSQ</code>æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ</h2><p><strong><code>NSQ</code>æ˜¯<code>Go</code>è¯­è¨€ç¼–å†™çš„ä¸€ä¸ªå¼€æºçš„å®æ—¶åˆ†å¸ƒå¼å†…å­˜æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå…¶æ€§èƒ½ååˆ†ä¼˜å¼‚ã€‚ NSQçš„ä¼˜åŠ¿æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</strong></p><ul><li><code>NSQ</code>æå€¡åˆ†å¸ƒå¼å’Œåˆ†æ•£çš„æ‹“æ‰‘ï¼Œæ²¡æœ‰å•ç‚¹æ•…éšœï¼Œæ”¯æŒå®¹é”™å’Œé«˜å¯ç”¨æ€§ï¼Œå¹¶æä¾›å¯é çš„æ¶ˆæ¯äº¤ä»˜ä¿è¯</li><li><code>NSQ</code>æ”¯æŒæ¨ªå‘æ‰©å±•ï¼Œæ²¡æœ‰ä»»ä½•é›†ä¸­å¼ä»£ç†ã€‚</li><li><code>NSQ</code>æ˜“äºé…ç½®å’Œéƒ¨ç½²ï¼Œå¹¶ä¸”å†…ç½®äº†ç®¡ç†ç•Œé¢ã€‚</li></ul><h2 id="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—"><a href="#ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—?"></a>ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—?</h2><p>é€šä¿—åœ°è§£é‡Šä¸€ä¸‹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½ æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼šä½ åˆ°æŠ¥ç¤¾è®¢é˜…äº†ä¸€ä»½æŠ¥çº¸ï¼ŒæŠ¥ç¤¾æ¯æ—¥ç”Ÿäº§ä¸€ä»½æ–°æŠ¥çº¸ï¼Œä¾¿å°†æ–°æŠ¥çº¸å‘å¾€é‚®å±€å¹¶å‘Šè¯‰é‚®å±€ä½ çš„åœ°å€ï¼Œé‚®é€’å‘˜å°†ä½ çš„æŠ¥çº¸é€å¾€ä½ çš„é‚®ç®±ï¼Œä½ ä¾¿å¯ä»¥æ„‰å¿«åœ°é˜…è¯»ä»Šå¤©çš„æ—¶äº‹æ–°é—»äº†ã€‚å½“ç„¶ï¼Œå¯èƒ½ä¸€ä¸ªäººè®¢é˜…äº†å¥½å‡ å®¶æŠ¥ç¤¾ï¼Œä¸€å®¶æŠ¥ç¤¾ä¹Ÿå¯ä»¥è¢«å¤šä¸ªäººè®¢é˜…ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±æ‹…ä»»äº†ï¼Œé‚®ç®±ã€é‚®å±€ã€é‚®é€’å‘˜çš„è§’è‰²ã€‚</p><h2 id="æ¶ˆæ¯é˜Ÿåˆ—çš„ä½œç”¨ï¼Ÿ"><a href="#æ¶ˆæ¯é˜Ÿåˆ—çš„ä½œç”¨ï¼Ÿ" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—çš„ä½œç”¨ï¼Ÿ"></a>æ¶ˆæ¯é˜Ÿåˆ—çš„ä½œç”¨ï¼Ÿ</h2><ul><li>æ˜¯å‡å°‘ç›¸åº”æ‰€éœ€çš„æ—¶é—´å’Œå‰Šå³°</li><li>é™ä½ç³»ç»Ÿè€¦åˆæ€§è§£è€¦æˆ–æå‡ç³»ç»Ÿçš„å¯æ‹“å±•æ€§ï¼‰</li></ul><p><strong>å¦‚å›¾ä¸‹åœºæ™¯:</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gextpsdc8qj313e0u0wja.jpg" srcset="/img/loading.gif" alt="nsq"><br><strong>é€šè¿‡ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å°†ä¸åŒçš„ä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Œé™ä½ç³»ç»Ÿé—´çš„è€¦åˆï¼Œæé«˜ç³»ç»Ÿçš„å¥å£®æ€§ã€‚åç»­æœ‰å…¶ä»–ä¸šåŠ¡è¦ä½¿ç”¨è®¢å•æ•°æ®å¯ç›´æ¥è®¢é˜…æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæé«˜ç³»ç»Ÿçš„çµæ´»æ€§ã€‚</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gextqm9slzj30wi0jg409.jpg" srcset="/img/loading.gif" alt="nsq"><br><strong>è¿˜å¯ä»¥å¸®å¤§å¹¶å‘åšæµé‡æŠ—å‹å¤„ç†ï¼Œç±»ä¼¼ç§’æ€ï¼ˆå¤§ç§’ï¼‰ç­‰åœºæ™¯ä¸‹ï¼ŒæŸä¸€æ—¶é—´å¯èƒ½ä¼šäº§ç”Ÿå¤§é‡çš„è¯·æ±‚ï¼Œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—èƒ½å¤Ÿä¸ºåç«¯å¤„ç†è¯·æ±‚æä¾›ä¸€å®šçš„ç¼“å†²åŒºï¼Œä¿è¯åç«¯æœåŠ¡çš„ç¨³å®šæ€§ã€‚</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gextrsvl7uj30xc08uwf9.jpg" srcset="/img/loading.gif" alt="nsq"></p><h2 id="å¼€å§‹NSQå¼¹å°„èµ·æ­¥ğŸš€"><a href="#å¼€å§‹NSQå¼¹å°„èµ·æ­¥ğŸš€" class="headerlink" title="å¼€å§‹NSQå¼¹å°„èµ·æ­¥ğŸš€"></a>å¼€å§‹<code>NSQ</code>å¼¹å°„èµ·æ­¥ğŸš€</h2><p><strong>NSQå·¥ä½œæ¨¡å¼ğŸ‘‡</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexu2qzvroj31480u0792.jpg" srcset="/img/loading.gif" alt="nsq"></p><p><code>Topic</code>å’Œ<code>Channel</code><br>æ¯ä¸ª<code>nsqd</code>å®ä¾‹æ—¨åœ¨ä¸€æ¬¡å¤„ç†å¤šä¸ªæ•°æ®æµã€‚è¿™äº›æ•°æ®æµç§°ä¸º<code>â€œtopicsâ€</code>ï¼Œä¸€ä¸ª<code>topic</code>å…·æœ‰1ä¸ªæˆ–å¤šä¸ª<code>â€œchannelsâ€</code>ã€‚æ¯ä¸ª<code>channel</code>éƒ½ä¼šæ”¶åˆ°<code>topic</code>æ‰€æœ‰æ¶ˆæ¯çš„å‰¯æœ¬ï¼Œå®é™…ä¸Šä¸‹æ¸¸çš„æœåŠ¡æ˜¯é€šè¿‡å¯¹åº”çš„<code>channel</code>æ¥æ¶ˆè´¹<code>topic</code>æ¶ˆæ¯ã€‚</p><p><code>topic</code>å’Œ<code>channel</code>ä¸æ˜¯é¢„å…ˆé…ç½®çš„ã€‚<code>topic</code>åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œæ–¹æ³•æ˜¯å°†å…¶å‘å¸ƒåˆ°æŒ‡å®š<code>topic</code>ï¼Œæˆ–è€…è®¢é˜…æŒ‡å®š<code>topic</code>ä¸Šçš„<code>channel</code>ã€‚<code>channel</code>æ˜¯é€šè¿‡è®¢é˜…æŒ‡å®šçš„<code>channel</code>åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºçš„ã€‚</p><p><code>topic</code>å’Œ<code>channel</code>éƒ½ç›¸äº’ç‹¬ç«‹åœ°ç¼“å†²æ•°æ®ï¼Œé˜²æ­¢ç¼“æ…¢çš„æ¶ˆè´¹è€…å¯¼è‡´å…¶ä»–<code>chennel</code>çš„ç§¯å‹ï¼ˆåŒæ ·é€‚ç”¨äº<code>topic</code>çº§åˆ«ï¼‰ã€‚</p><p><code>channel</code>å¯ä»¥å¹¶ä¸”é€šå¸¸ä¼šè¿æ¥å¤šä¸ªå®¢æˆ·ç«¯ã€‚å‡è®¾æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯éƒ½å¤„äºå‡†å¤‡æ¥æ”¶æ¶ˆæ¯çš„çŠ¶æ€ï¼Œåˆ™æ¯æ¡æ¶ˆæ¯å°†è¢«ä¼ é€’åˆ°éšæœºå®¢æˆ·ç«¯ã€‚ä¾‹å¦‚ï¼š<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexw4g26pog30bo07tjry.gif" srcset="/img/loading.gif" alt="nsq"><br>æ€»è€Œè¨€ä¹‹ï¼Œæ¶ˆæ¯æ˜¯ä»<code>topic -&gt; channel</code>ï¼ˆæ¯ä¸ª<code>channel</code>æ¥æ”¶è¯¥<code>topic</code>çš„æ‰€æœ‰æ¶ˆæ¯çš„å‰¯æœ¬ï¼‰å¤šæ’­çš„ï¼Œä½†æ˜¯ä»<code>channel -&gt; consumers</code>å‡åŒ€åˆ†å¸ƒï¼ˆæ¯ä¸ªæ¶ˆè´¹è€…æ¥æ”¶è¯¥<code>channel</code>çš„ä¸€éƒ¨åˆ†æ¶ˆæ¯ï¼‰ã€‚<br><strong>NSQæ¥æ”¶å’Œå‘é€æ¶ˆæ¯æµç¨‹</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexu6v1zghj30fc07paah.jpg" srcset="/img/loading.gif" alt=""><br><strong>NSQç‰¹æ€§</strong><br>æ¶ˆæ¯é»˜è®¤ä¸æŒä¹…åŒ–ï¼Œå¯ä»¥é…ç½®æˆæŒä¹…åŒ–æ¨¡å¼ã€‚nsqé‡‡ç”¨çš„æ–¹å¼æ—¶å†…å­˜+ç¡¬ç›˜çš„æ¨¡å¼ï¼Œå½“å†…å­˜åˆ°è¾¾ä¸€å®šç¨‹åº¦æ—¶å°±ä¼šå°†æ•°æ®æŒä¹…åŒ–åˆ°ç¡¬ç›˜ã€‚</p><ul><li>å¦‚æœå°†<code>--mem-queue-size</code>è®¾ç½®ä¸º0ï¼Œæ‰€æœ‰çš„æ¶ˆæ¯å°†ä¼šå­˜å‚¨åˆ°ç£ç›˜ã€‚</li><li>æœåŠ¡å™¨é‡å¯æ—¶ä¹Ÿä¼šå°†å½“æ—¶åœ¨å†…å­˜ä¸­çš„æ¶ˆæ¯æŒä¹…åŒ–ã€‚</li><li>æ¯æ¡æ¶ˆæ¯è‡³å°‘ä¼ é€’ä¸€æ¬¡ã€‚</li><li>æ¶ˆæ¯ä¸ä¿è¯æœ‰åºã€‚</li></ul><h3 id="å¼€å§‹ä½¿ç”¨NSQ"><a href="#å¼€å§‹ä½¿ç”¨NSQ" class="headerlink" title="å¼€å§‹ä½¿ç”¨NSQ"></a>å¼€å§‹ä½¿ç”¨<code>NSQ</code></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…NSQçš„<code>nsqlookupd</code>ç»„ä»¶ä¹Ÿå°±æ˜¯<code>nsqd</code>ç¨‹åº,æµè§ˆå™¨æ‰“å¼€<a href="https://nsq.io/deployment/installing.html" target="_blank" rel="noopener">å®˜æ–¹ä¸‹è½½é¡µé¢</a>å³å¯å¾—åˆ°ä½ å¯¹åº”æ“ä½œç³»ç»Ÿçš„ç¨‹åºã€‚<br><strong><code>nsqd</code>æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œå®ƒæ¥æ”¶ã€æ’é˜Ÿå¹¶å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ã€‚</strong></p><h3 id="nsqlookupdç»„ä»¶"><a href="#nsqlookupdç»„ä»¶" class="headerlink" title="nsqlookupdç»„ä»¶"></a><code>nsqlookupd</code>ç»„ä»¶</h3><p><code>nsqlookupd</code>ç›¸å½“äºé›†ç¾¤çš„ç®¡ç†å‘˜æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå¯åŠ¨å®ƒ</p><pre><code class="shell">$ nsqlookupd</code></pre><h3 id="nsqdç»„ä»¶"><a href="#nsqdç»„ä»¶" class="headerlink" title="nsqdç»„ä»¶"></a><code>nsqd</code>ç»„ä»¶</h3><p>å¯åŠ¨ <code>nsqd</code>ï¼Œå®ƒç›¸å½“äºé›†ç¾¤ä¸‹çš„èŠ‚ç‚¹ï¼Œæ˜¯ä¸»è¦å¹²æ´»çš„</p><pre><code class="shell">$ nsqd --lookupd-tcp-address=127.0.0.1:4160</code></pre><p><strong><code>nsqlookupd</code>æ˜¯ç»´æŠ¤æ‰€æœ‰<code>nsqd</code>çŠ¶æ€ã€æä¾›æœåŠ¡å‘ç°çš„å®ˆæŠ¤è¿›ç¨‹ã€‚å®ƒèƒ½ä¸ºæ¶ˆè´¹è€…æŸ¥æ‰¾ç‰¹å®š<code>topic</code>ä¸‹çš„<code>nsqd</code>æä¾›äº†è¿è¡Œæ—¶çš„è‡ªåŠ¨å‘ç°æœåŠ¡ã€‚ å®ƒä¸ç»´æŒæŒä¹…çŠ¶æ€ï¼Œä¹Ÿä¸éœ€è¦ä¸ä»»ä½•å…¶ä»–<code>nsqlookupd</code>å®ä¾‹åè°ƒä»¥æ»¡è¶³æŸ¥è¯¢ã€‚å› æ­¤æ ¹æ®ä½ ç³»ç»Ÿçš„å†—ä½™è¦æ±‚å°½å¯èƒ½å¤šåœ°éƒ¨ç½²<code>nsqlookupd</code>èŠ‚ç‚¹ã€‚å®ƒä»¬æ¶ˆè€—çš„èµ„æºå¾ˆå°‘ï¼Œå¯ä»¥ä¸å…¶ä»–æœåŠ¡å…±å­˜ã€‚æˆ‘ä»¬çš„å»ºè®®æ˜¯ä¸ºæ¯ä¸ªæ•°æ®ä¸­å¿ƒè¿è¡Œè‡³å°‘3ä¸ªé›†ç¾¤ã€‚</strong></p><h3 id="nsqadminç»„ä»¶"><a href="#nsqadminç»„ä»¶" class="headerlink" title="nsqadminç»„ä»¶"></a><code>nsqadmin</code>ç»„ä»¶</h3><p>ä¸€ä¸ªå®æ—¶ç›‘æ§é›†ç¾¤çŠ¶æ€ã€æ‰§è¡Œå„ç§ç®¡ç†ä»»åŠ¡çš„Webç®¡ç†å¹³å°ã€‚ å¯åŠ¨<code>nsqadmin</code>ï¼ŒæŒ‡å®š<code>nsqlookupd</code>åœ°å€:</p><pre><code class="shell"> ./nsqadmin -lookupd-http-address=127.0.0.1:4161</code></pre><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€<code>http://127.0.0.1:4171/</code>è®¿é—®å¦‚ä¸‹ç®¡ç†ç•Œé¢ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexvk9mzt7j31c00u0b29.jpg" srcset="/img/loading.gif" alt="nsq"></p><h3 id="æµ‹è¯•æ¶ˆæ¯"><a href="#æµ‹è¯•æ¶ˆæ¯" class="headerlink" title="æµ‹è¯•æ¶ˆæ¯"></a>æµ‹è¯•æ¶ˆæ¯</h3><p>å‘é€ä¸€æ¡æ¶ˆæ¯</p><pre><code class="shell">$ curl -d &#39;hello world 1&#39; &#39;http://127.0.0.1:4151/pub?topic=test&#39;</code></pre><p>å³å¯çœ‹åˆ°æ”¶åˆ°äº†æ¶ˆæ¯<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexvqdbqrrj31740u0k9x.jpg" srcset="/img/loading.gif" alt="nsq"><br>æŠŠæ¶ˆæ¯å†™åˆ°ç¡¬ç›˜çš„æ–‡ä»¶é‡Œ</p><pre><code class="shell">$ nsq_to_file --topic=test --output-dir=/tmp --lookupd-http-address=127.0.0.1:4161</code></pre><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexvtcplxej312i0u07c5.jpg" srcset="/img/loading.gif" alt="nsq"><br>æ–‡ä»¶å†…å®¹<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gexvukbk33j31ja0m614z.jpg" srcset="/img/loading.gif" alt="nsq"></p><p><strong>å¥½äº†å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä½ å¯ä»¥åˆ°æœ¬åšå®¢çš„å…³äºé¡µé¢æ·»åŠ æˆ‘å¾®ä¿¡æˆ–è€…åœ¨Githubè”ç³»æˆ‘ï¼Œä¸€èµ·æ¨åŠ¨Golangåœ¨ä¸­å›½è¿™ç‰‡åœŸåœ°ç”Ÿæ ¹å‘èŠ½é•¿æˆå¤§æ ‘ï¼ï¼ï¼Good luck!</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>NSQ</tag>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gohperæˆé•¿ç§˜ç±</title>
    <link href="/2020/05/17/Gohper%E7%9A%84300%E9%97%AE/"/>
    <url>/2020/05/17/Gohper%E7%9A%84300%E9%97%AE/</url>
    
    <content type="html"><![CDATA[<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gevv4s06cej30dw04zjs2.jpg" srcset="/img/loading.gif" alt=""></p><blockquote><p>è¿™æ˜¯æˆ‘ä¸ªäºº<code>Denn</code>æ•´ç†çš„ä¸€å¥—Golangå­¦ä¹ ç›®å½•<br> âœ… è¡¨ç¤ºæˆ‘å·²ç»å®Œæˆçš„<br> ğŸ¤·â€â™€ï¸ è¡¨ç¤ºæˆ‘äº†è§£è¿‡æ²¡æœ‰æ·±å…¥<br> åŠ æ²¹å„ä½å°‘å¹´ğŸ»</p></blockquote><h1 id="ç›®å½•æ ‘ğŸŒ²"><a href="#ç›®å½•æ ‘ğŸŒ²" class="headerlink" title="ç›®å½•æ ‘ğŸŒ²"></a>ç›®å½•æ ‘ğŸŒ²</h1><ul><li>å¸¸é‡å’Œå˜é‡çš„å…³ç³» âœ…</li><li>åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç±»å‹  âœ…</li><li>ç¨‹åºçš„è¿ç®—ç¬¦  âœ…</li><li>ç¨‹åºæ§åˆ¶æµç¨‹  âœ…</li><li>æ•°ç»„çš„ä½¿ç”¨  âœ…</li><li><code>slice</code>ã€<code>map</code>ã€<code>channel</code>çš„ä½¿ç”¨  âœ…</li><li>å‡½æ•°å¼ç¼–ç¨‹  âœ…</li><li>ç»“æ„ä½“å’ŒæŒ‡é’ˆ  âœ…</li><li>é¢å‘æ¥å£ç¼–ç¨‹  âœ…</li><li>åŒ…å’Œç›®å½•çš„æ¦‚å¿µ  âœ…</li><li>åå°„å’Œä¸å®‰å…¨ç¼–ç¨‹ ğŸ¤·â€â™€ï¸</li><li>æµ‹è¯•åŒ…çš„ä½¿ç”¨  âœ…</li><li>å¸¸ç”¨çš„å†…ç½®çš„ä½¿ç”¨  âœ…</li><li><code>Goroutine</code>å’Œ<code>Comtext</code>  âœ…</li><li>ç½‘ç»œç¼–ç¨‹å’Œæ•°æ®åº“ç¼–ç¨‹  âœ…<ul><li><code>Gin</code></li><li><code>Gorm</code></li><li><code>gRPC</code> </li><li><code>Redis</code></li><li><code>Nsq</code></li><li><code>Kafka</code></li><li><code>MongoDB</code></li><li><code>Etcd</code></li><li><code>ElasticSearch</code></li><li><code>......è¿˜æœ‰è·Ÿå¤šéœ€è¦ä¸æ–­åŠªåŠ›ğŸƒâ€â™€ï¸</code></li></ul></li><li>ç®—æ³•å’Œæ•°æ®ç»“æ„è¡¥ä¸€è¡¥</li><li>æ‰¾ä¸€äº›è®¡ç®—æœºç»„æˆå’Œè®¡ç®—æœºåŸºç¡€è§†é¢‘çœ‹çœ‹~</li><li>Good Luckï¼ï¼ï¼</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Goæ€§èƒ½åˆ†æä¹‹PProf</title>
    <link href="/2020/05/16/Go%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B9%8BPProf/"/>
    <url>/2020/05/16/Go%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B9%8BPProf/</url>
    
    <content type="html"><![CDATA[<h2 id="PProfæ˜¯ä¸ªå•¥ï¼Ÿï¼Ÿï¼Ÿ"><a href="#PProfæ˜¯ä¸ªå•¥ï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="PProfæ˜¯ä¸ªå•¥ï¼Ÿï¼Ÿï¼Ÿ"></a>PProfæ˜¯ä¸ªå•¥ï¼Ÿï¼Ÿï¼Ÿ</h2><p><code>pprof</code>æ˜¯ç”¨äºå¯è§†åŒ–å’Œåˆ†ææ€§èƒ½åˆ†ææ•°æ®çš„å·¥å…·,<code>pprof</code>ä»¥ <code>profile.proto</code> è¯»å–åˆ†ææ ·æœ¬çš„é›†åˆï¼Œå¹¶ç”ŸæˆæŠ¥å‘Šä»¥å¯è§†åŒ–å¹¶å¸®åŠ©åˆ†ææ•°æ®ï¼ˆæ”¯æŒæ–‡æœ¬å’Œå›¾å½¢æŠ¥å‘Šï¼‰<br><code>profile.proto</code> æ˜¯ä¸€ä¸ª<code>Protocol Buffer v3</code>çš„æè¿°æ–‡ä»¶ï¼Œå®ƒæè¿°äº†ä¸€ç»„ <code>callstack</code>å’Œ <code>symbolization</code>ä¿¡æ¯ï¼Œ ä½œç”¨æ˜¯è¡¨ç¤ºç»Ÿè®¡åˆ†æçš„ä¸€ç»„é‡‡æ ·çš„è°ƒç”¨æ ˆï¼Œæ˜¯å¾ˆå¸¸è§çš„ <code>stacktrace</code>é…ç½®æ–‡ä»¶æ ¼å¼ã€‚</p><ol><li>æ”¯æŒä»€ä¹ˆä½¿ç”¨æ¨¡å¼<ul><li><code>Report generation</code>ï¼šæŠ¥å‘Šç”Ÿæˆ</li><li><code>Interactive terminal use</code>ï¼šäº¤äº’å¼ç»ˆç«¯ä½¿ç”¨</li><li><code>Web interface</code>ï¼š<code>Web</code> ç•Œé¢</li></ul></li><li>å¯ä»¥åšä»€ä¹ˆ<ul><li><code>CPU Profiling</code>ï¼š<code>CPU</code> åˆ†æï¼ŒæŒ‰ç…§ä¸€å®šçš„é¢‘ç‡é‡‡é›†æ‰€ç›‘å¬çš„åº”ç”¨ç¨‹åº <code>CPU</code>ï¼ˆå«å¯„å­˜å™¨ï¼‰çš„ä½¿ç”¨æƒ…å†µï¼Œå¯ç¡®å®šåº”ç”¨ç¨‹åºåœ¨ä¸»åŠ¨æ¶ˆè€— <code>CPU</code> å‘¨æœŸæ—¶èŠ±è´¹æ—¶é—´çš„ä½ç½®</li><li><code>Memory Profiling</code>ï¼šå†…å­˜åˆ†æï¼Œåœ¨åº”ç”¨ç¨‹åºè¿›è¡Œå †åˆ†é…æ—¶è®°å½•å †æ ˆè·Ÿè¸ªï¼Œç”¨äºç›‘è§†å½“å‰å’Œå†å²å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä»¥åŠæ£€æŸ¥å†…å­˜æ³„æ¼</li><li><code>Block Profiling</code>ï¼šé˜»å¡åˆ†æï¼Œè®°å½• <code>goroutine</code> é˜»å¡ç­‰å¾…åŒæ­¥ï¼ˆåŒ…æ‹¬å®šæ—¶å™¨é€šé“ï¼‰çš„ä½ç½®</li><li><code>Mutex Profiling</code>ï¼šäº’æ–¥é”åˆ†æï¼ŒæŠ¥å‘Šäº’æ–¥é”çš„ç«äº‰æƒ…å†µ</li></ul></li></ol><h2 id="ä¸€ä¸ªä¾‹å­ğŸŒ°"><a href="#ä¸€ä¸ªä¾‹å­ğŸŒ°" class="headerlink" title="ä¸€ä¸ªä¾‹å­ğŸŒ°"></a>ä¸€ä¸ªä¾‹å­ğŸŒ°</h2><p><strong>æƒ³è¦è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œé¦–å…ˆç©ç›®åœ¨ Go è‡ªèº«æä¾›çš„å·¥å…·é“¾æ¥ä½œä¸ºåˆ†æä¾æ®ï¼Œæœ¬æ–‡å°†å¸¦ä½ å­¦ä¹ ã€ä½¿ç”¨ Go åèŠ±å›­ï¼Œæ¶‰åŠå¦‚ä¸‹ï¼š</strong></p><ul><li><code>runtime/pprof</code>ï¼šé‡‡é›†ç¨‹åºï¼ˆ<code>é Server</code>ï¼‰çš„è¿è¡Œæ•°æ®è¿›è¡Œåˆ†æ</li><li><code>net/http/pprof</code>ï¼šé‡‡é›† <code>HTTP Server</code> çš„è¿è¡Œæ—¶æ•°æ®è¿›è¡Œåˆ†æ</li></ul><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/5/16 - 12:53 ä¸‹åˆpackage mainimport (    &quot;flag&quot;    &quot;fmt&quot;    &quot;os&quot;    &quot;runtime/pprof&quot;    &quot;time&quot;)// ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç func logicCode() {    var c chan int    for {        select {        case v := &lt;-c:            fmt.Printf(&quot;recv from chan, value:%v\n&quot;, v)        default:        }    }}func main() {    var isCPUPprof bool    var isMemPprof bool    flag.BoolVar(&amp;isCPUPprof, &quot;cpu&quot;, false, &quot;turn cpu pprof on&quot;)    flag.BoolVar(&amp;isMemPprof, &quot;mem&quot;, false, &quot;turn mem pprof on&quot;)    flag.Parse()    if isCPUPprof {         file, err := os.Create(&quot;./cpu.pprof&quot;)        if err != nil {            fmt.Printf(&quot;create cpu pprof failed, err:%v\n&quot;, err)            return        }        pprof.StartCPUProfile(file)        defer pprof.StopCPUProfile()    }    for i := 0; i &lt; 8; i++ {        go logicCode()    }    time.Sleep(20 * time.Second)    if isMemPprof {        file, err := os.Create(&quot;./mem.pprof&quot;)        if err != nil {            fmt.Printf(&quot;create mem pprof failed, err:%v\n&quot;, err)            return        }        pprof.WriteHeapProfile(file)        file.Close()    }}</code></pre><p><strong>å¯ä»¥çœ‹åˆ°ğŸ‘†ä¸Šé¢çš„é‚£ä¸ª<code>select</code>ä»£ç å—é‡Œé¢çš„channelæ²¡æœ‰åˆå§‹åŒ–ï¼Œä¼šä¸€ç›´é˜»å¡ç€ã€‚è¿™æ ·ä¸€ä¸ªç®€å•çš„ä»£ç å¯ä»¥é€šè¿‡æˆ‘ä»¬è‚‰çœ¼å‡ºæ¥äº†ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¤æ‚çš„æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨<code>pprof</code>å·¥å…·äº†ã€‚</strong></p><pre><code class="shell">$: go tool pprof cpu.pprof Type: cpuTime: May 16, 2020 at 12:59pm (CST)Duration: 20.14s, Total samples = 56.90s (282.48%)Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)(pprof) top3Showing nodes accounting for 51.91s, 91.23% of 56.90s totalDropped 7 nodes (cum &lt;= 0.28s)Showing top 3 nodes out of 4      flat  flat%   sum%        cum   cum%    23.04s 40.49% 40.49%     45.18s 79.40%  runtime.selectnbrecv    17.26s 30.33% 70.83%     18.93s 33.27%  runtime.chanrecv    11.61s 20.40% 91.23%     56.83s 99.88%  main.logicCode //âè¿™é‡Œå·²ç»é€šè¿‡å·¥å…·åˆ†æå‡ºæ¥äº†ï¼ï¼ï¼</code></pre><p><strong>å·¥å…·å°±å¯ä»¥åˆ†æå‡ºæ¥äº†æˆ‘ä»¬çš„<code>logicCode</code>å‡½æ•°æœ‰é—®é¢˜ï¼</strong></p><pre><code class="shell">$: go tool pprof cpu.pprof Type: cpuTime: May 16, 2020 at 12:59pm (CST)Duration: 20.14s, Total samples = 56.90s (282.48%)Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)(pprof) top3Showing nodes accounting for 51.91s, 91.23% of 56.90s totalDropped 7 nodes (cum &lt;= 0.28s)Showing top 3 nodes out of 4      flat  flat%   sum%        cum   cum%    23.04s 40.49% 40.49%     45.18s 79.40%  runtime.selectnbrecv    17.26s 30.33% 70.83%     18.93s 33.27%  runtime.chanrecv    11.61s 20.40% 91.23%     56.83s 99.88%  main.logicCode(pprof) list logicCodeTotal: 56.90sROUTINE ======================== main.logicCode in /Users/ding/Documents/GO_CODE_DEV/src/Lets_Go/lets_37_pprof/main.go    11.61s     56.83s (flat, cum) 99.88% of Total         .          .     16:// ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç          .          .     17:func logicCode() {         .          .     18:   var c chan int         .          .     19:   for {         .          .     20:           select {    11.61s     56.83s     21:           case v := &lt;-c:         .          .     22:                   fmt.Printf(&quot;recv from chan, value:%v\n&quot;, v)         .          .     23:           default:         .          .     24:         .          .     25:           }         .          .     26:   }(pprof) </code></pre><p><strong>é€šè¿‡<code>list funcName</code>å°±å¯ä»¥å®šä½åˆ°å“ªè¡Œä»£ç çš„é—®é¢˜äº†ï¼å½“ç„¶<code>PProf</code>å·¥å…·çš„ç”¨é€”å¤šçš„æ˜¯è¿™é‡Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘è¿™ç¯‡åšæ–‡å°±å†™åˆ°è¿™é‡Œï¼Œæœ‰å…´è¶£çš„åé¢å†æ›´æ–°ï¼Œæˆ–è€…å…³æ³¨æˆ‘çš„å…¬ä¼—å·:<code>go_code</code>è°¢è°¢é‡Œé¢æœ‰å¹²è´§å“¦<del>~</del>ğŸ¤©</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>PPorf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Testing of Golang</title>
    <link href="/2020/05/15/Testing-of-Golang/"/>
    <url>/2020/05/15/Testing-of-Golang/</url>
    
    <content type="html"><![CDATA[<h2 id="GoLangçš„å•å…ƒæµ‹è¯•"><a href="#GoLangçš„å•å…ƒæµ‹è¯•" class="headerlink" title="GoLangçš„å•å…ƒæµ‹è¯•"></a>GoLangçš„å•å…ƒæµ‹è¯•</h2><p>åœ¨æˆ‘ä»¬å†™ä»£ç çš„è¿‡ç¨‹ä¸­è¦å…»æˆä¸€ä¸ªå†™æ³¨é‡Šå’Œå†™å•å…ƒæµ‹è¯•çš„ä¹ æƒ¯ï¼Œè¿™æ ·å¯ä»¥æé«˜æˆ‘ä»¬çš„ä»£ç å¥å£®æ€§å’Œå¯è¯»æ€§ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹<code>golang</code>çš„<code>test</code>è¿™ä¸ªå·¥å…·ã€‚</p><h2 id="go-testå‘½ä»¤ä»‹ç»"><a href="#go-testå‘½ä»¤ä»‹ç»" class="headerlink" title="go testå‘½ä»¤ä»‹ç»"></a><code>go test</code>å‘½ä»¤ä»‹ç»</h2><p>Goè¯­è¨€ä¸­çš„æµ‹è¯•ä¾èµ–<code>go test</code>å‘½ä»¤ã€‚ç¼–å†™æµ‹è¯•ä»£ç å’Œç¼–å†™æ™®é€šçš„Goä»£ç è¿‡ç¨‹æ˜¯ç±»ä¼¼çš„ï¼Œå¹¶ä¸éœ€è¦å­¦ä¹ æ–°çš„è¯­æ³•ã€è§„åˆ™æˆ–å·¥å…·ã€‚</p><p><code>go test</code>å‘½ä»¤æ˜¯ä¸€ä¸ªæŒ‰ç…§ä¸€å®šçº¦å®šå’Œç»„ç»‡çš„æµ‹è¯•ä»£ç çš„é©±åŠ¨ç¨‹åºã€‚åœ¨åŒ…ç›®å½•å†…ï¼Œæ‰€æœ‰ä»¥<code>_test.go</code>ä¸ºåç¼€åçš„æºä»£ç æ–‡ä»¶éƒ½æ˜¯<code>go test</code>æµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼Œä¸ä¼šè¢«<code>go build</code>ç¼–è¯‘åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚</p><p>åœ¨<code>*_test.go</code>æ–‡ä»¶ä¸­æœ‰ä¸‰ç§ç±»å‹çš„å‡½æ•°ï¼Œå•å…ƒæµ‹è¯•å‡½æ•°ã€åŸºå‡†æµ‹è¯•å‡½æ•°å’Œç¤ºä¾‹å‡½æ•°ã€‚</p><table><thead><tr><th>ç±»å‹</th><th>æ ¼å¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>æµ‹è¯•å‡½æ•°</td><td>å‡½æ•°åå‰ç¼€ä¸º<code>Test</code></td><td>æµ‹è¯•ç¨‹åºçš„ä¸€äº›é€»è¾‘è¡Œä¸ºæ˜¯å¦æ­£ç¡®</td></tr><tr><td>åŸºå‡†å‡½æ•°</td><td>å‡½æ•°åå‰ç¼€ä¸º<code>Benchmark</code></td><td>æµ‹è¯•å‡½æ•°çš„æ€§èƒ½</td></tr><tr><td>ç¤ºä¾‹å‡½æ•°</td><td>å‡½æ•°åå‰ç¼€ä¸º<code>Example</code></td><td>ä¸ºæ–‡æ¡£æä¾›ç¤ºä¾‹æ–‡æ¡£</td></tr></tbody></table><h2 id="æµ‹è¯•å‡½æ•°"><a href="#æµ‹è¯•å‡½æ•°" class="headerlink" title="æµ‹è¯•å‡½æ•°"></a>æµ‹è¯•å‡½æ•°</h2><blockquote><p>åŸºæœ¬æµ‹è¯•çš„ä¸€äº›æ–¹æ³•è¯´æ˜åœ¨æ–‡æ¡£é‡Œ:<a href="https://studygolang.com/static/pkgdoc/pkg/testing.htm" target="_blank" rel="noopener">https://studygolang.com/static/pkgdoc/pkg/testing.htm</a></p></blockquote><p><strong>æœ¬æµ‹è¯•çš„å‡½æ•°<code>math.go</code></strong></p><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/5/15 - 4:16 ä¸‹åˆpackage lets_36_testingfunc init() {    Math := make(map[string]func(n, m int) int, 4)    Math[&quot;add&quot;] = Add    Math[&quot;sub&quot;] = Sub    Math[&quot;multi&quot;] = Multi    Math[&quot;div&quot;] = Div}func Add(n, m int) int {    return n + m}func Sub(n, m int) int {    return n - m}func Multi(n, m int) int {    return n * m}func Div(n, m int) int {    return n / m}</code></pre><p><strong>æµ‹è¯•å‡½æ•°<code>math_test.go</code>éµå¾ªå®˜æ–¹å‘½åè§„èŒƒ</strong></p><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/5/15 - 4:21 ä¸‹åˆpackage lets_36_testingimport &quot;testing&quot;func TestMath(t *testing.T) {    // è‡ªå®šä¹‰æµ‹è¯•ç»“æ„ä½“    type MathCase struct {        n, m, result int    }    // è‡ªå®šä¹‰å­æµ‹è¯•map    testGroup := map[string]MathCase{        &quot;add&quot;:   {1, 2, 3},        &quot;sub&quot;:   {3, 1, 2},        &quot;multi&quot;: {3, 2, 6},        &quot;div&quot;:   {6, 2, 3},    }    // æµ‹è¯•æ‰§è¡Œå‡½æ•°    for name, mathCase := range testGroup {        t.Run(name, func(t *testing.T) {            s := -1            switch name {            case &quot;add&quot;:                s = Add(mathCase.n, mathCase.m)            case &quot;sub&quot;:                s = Sub(mathCase.n, mathCase.m)            case &quot;multi&quot;:                s = Multi(mathCase.n, mathCase.m)            case &quot;div&quot;:                s = Div(mathCase.n, mathCase.m)            default:                t.Fatalf(&quot;No executable testing name :%s&quot;, name)            }            if mathCase.result != s {                t.Fatalf(&quot; add computer result errorï¼Œ want %d , got %d&quot;, mathCase.result, s)            }        })    }}</code></pre><p><strong>åœ¨è‡ªå·±çš„terminalè¾“å…¥<code>go test</code>å³å¯çœ‹åˆ°æµ‹è¯•ç»“æœ</strong></p><pre><code class="go">=== RUN   TestMath=== RUN   TestMath/sub=== RUN   TestMath/multi=== RUN   TestMath/div=== RUN   TestMath/add--- PASS: TestMath (0.00s)    --- PASS: TestMath/sub (0.00s)    --- PASS: TestMath/multi (0.00s)    --- PASS: TestMath/div (0.00s)    --- PASS: TestMath/add (0.00s)PASSok      command-line-arguments  0.004s</code></pre><blockquote><p>å¦‚æœæ˜¯å­æµ‹è¯•å¯ä»¥åŠ  <code>-run=funcName/TestCase</code>æ¥è¿›è¡Œå­æµ‹è¯•</p></blockquote><h2 id="æµ‹è¯•è¦†ç›–ç‡"><a href="#æµ‹è¯•è¦†ç›–ç‡" class="headerlink" title="æµ‹è¯•è¦†ç›–ç‡"></a>æµ‹è¯•è¦†ç›–ç‡</h2><p>æµ‹è¯•è¦†ç›–ç‡æ˜¯ä½ çš„ä»£ç è¢«æµ‹è¯•å¥—ä»¶è¦†ç›–çš„ç™¾åˆ†æ¯”ã€‚é€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„éƒ½æ˜¯è¯­å¥çš„è¦†ç›–ç‡ï¼Œä¹Ÿå°±æ˜¯åœ¨æµ‹è¯•ä¸­è‡³å°‘è¢«è¿è¡Œä¸€æ¬¡çš„ä»£ç å æ€»ä»£ç çš„æ¯”ä¾‹ã€‚Goæä¾›å†…ç½®åŠŸèƒ½æ¥æ£€æŸ¥ä½ çš„ä»£ç è¦†ç›–ç‡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>go test -cover</code>æ¥æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="go">$: go test -coverPASScoverage: 100.0% of statementsok      Lets_Go/lets_36_testing 0.004s</code></pre><p><strong>å¯ä»¥çœ‹åˆ°æˆ‘çš„ä»£ç æµ‹è¯•è¦†ç›–ç‡æ˜¯ç™¾åˆ†ä¹‹ç™¾çš„~</strong></p><p>Goè¿˜æä¾›äº†ä¸€ä¸ªé¢å¤–çš„<code>go test -cover -coverprofile</code>å‚æ•°ï¼Œç”¨æ¥å°†è¦†ç›–ç‡ç›¸å…³çš„è®°å½•ä¿¡æ¯è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œ:</p><pre><code class="go">$: go test -cover -coverprofile=testInfo.out[50 50 50 50 50 50]PASScoverage: 100.0% of statementsok      Lets_Go/lets_36_testing 0.005s</code></pre><p><strong>è¿™æ ·æˆ‘ä»¬å°±æŠŠæµ‹è¯•çš„ä¿¡æ¯è¾“å‡ºåˆ°ä¸€ä¸ªæŒ‡å®šçš„<code>testInfo.out</code>æ–‡ä»¶é‡Œé¢äº†,ç„¶åæˆ‘ä»¬é€šè¿‡goè¯­è¨€å†…ç½®<code>tool</code>å·¥å…·å°±å¯ä»¥ç”Ÿäº§å¯è§†åŒ–çš„ä»£ç è¦†ç›–ç‡æ£€æŸ¥è§†å›¾äº†ï¼Œä½¿ç”¨å‘½ä»¤<code>go tool cover -html=testInfo.out</code>ä¾‹å¦‚:</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1getd9mki8bj313u0u0dve.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="åŸºå‡†æµ‹è¯•"><a href="#åŸºå‡†æµ‹è¯•" class="headerlink" title="åŸºå‡†æµ‹è¯•"></a>åŸºå‡†æµ‹è¯•</h2><p>åŸºå‡†æµ‹è¯•æ˜¯ç»™ä½ çš„ç¨‹åºåšè¿è¡Œæ€§èƒ½çš„æµ‹è¯•,ä»¥Benchmarkä¸ºå‰ç¼€ï¼Œéœ€è¦ä¸€ä¸ª*testing.Bç±»å‹çš„å‚æ•°bï¼ŒåŸºå‡†æµ‹è¯•å¿…é¡»è¦æ‰§è¡Œb.Næ¬¡ï¼Œè¿™æ ·çš„æµ‹è¯•æ‰æœ‰å¯¹ç…§æ€§ï¼Œb.Nçš„å€¼æ˜¯ç³»ç»Ÿæ ¹æ®å®é™…æƒ…å†µå»è°ƒæ•´çš„ï¼Œä»è€Œä¿è¯æµ‹è¯•çš„ç¨³å®šæ€§ã€‚</p><pre><code class="go">func BenchmarkAdd(b *testing.B) {    for i:=0;i&lt;b.N;i++ {        Add(i, b.N)        //fmt.Println(add)    }}</code></pre><p><strong>å¢åŠ <code>-bench</code>å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ<code>go test -bench=Add</code>å‘½ä»¤æ‰§è¡ŒåŸºå‡†æµ‹è¯•ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹</strong></p><pre><code class="go">$: go test -bench=Addgoos: darwingoarch: amd64pkg: Lets_Go/lets_36_testingBenchmarkAdd-4          1000000000               0.281 ns/opPASSok      Lets_Go/lets_36_testing 0.320s</code></pre><p><strong>å…¶ä¸­BenchmarkAdd-4è¡¨ç¤ºå¯¹Splitå‡½æ•°è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œæ•°å­—4è¡¨ç¤ºGOMAXPROCSçš„å€¼ï¼Œè¿™ä¸ªå¯¹äºå¹¶å‘åŸºå‡†æµ‹è¯•å¾ˆé‡è¦ã€‚10000000å’Œ203ns/opè¡¨ç¤ºæ¯æ¬¡è°ƒç”¨Addå‡½æ•°è€—æ—¶0.281nsï¼Œè¿™ä¸ªç»“æœæ˜¯10000000æ¬¡è°ƒç”¨çš„å¹³å‡å€¼ã€‚</strong></p><p>è¿˜å¯ä»¥æ·»åŠ <code>-benchmem</code>å‚æ•°æ¥æŸ¥çœ‹è¢«æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ:</p><pre><code class="go">$: go test -bench=Add -benchmemgoos: darwingoarch: amd64pkg: Lets_Go/lets_36_testingBenchmarkAdd-4          1000000000               0.292 ns/op           0 B/op          0 allocs/opPASSok      Lets_Go/lets_36_testing 0.335s</code></pre><p><strong><code>0 B/op</code>è¡¨ç¤ºæ¯æ¬¡æ“ä½œå†…å­˜åˆ†é…äº†<code>0</code>å­—èŠ‚ï¼Œ<code>0 allocs/op</code>åˆ™è¡¨ç¤ºæ¯æ¬¡æ“ä½œè¿›è¡Œäº†<code>0</code>æ¬¡å†…å­˜åˆ†é…,å› ä¸ºæˆ‘å†™çš„å°±æ˜¯ä¸€ä¸ªç®€å•åŠ æ³•å‡½æ•°ğŸ˜</strong></p><blockquote><p>Good luckğŸ˜œ~</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>Golang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sync.Mutex&amp;RWMutexç¬”è®°</title>
    <link href="/2020/05/12/sync-Mutex-RWMutex%E7%AC%94%E8%AE%B0/"/>
    <url>/2020/05/12/sync-Mutex-RWMutex%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="Go-ä¸­é”çš„ä½¿ç”¨"><a href="#Go-ä¸­é”çš„ä½¿ç”¨" class="headerlink" title="Go ä¸­é”çš„ä½¿ç”¨"></a>Go ä¸­é”çš„ä½¿ç”¨</h2><ol><li>äº’æ–¥é”</li><li>è¯»å†™é”</li></ol><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gepy9opn7vj30ge0gq3yz.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="äº’æ–¥é”"><a href="#äº’æ–¥é”" class="headerlink" title="äº’æ–¥é”"></a>äº’æ–¥é”</h2><p>å¹¶å‘ç¨‹åºå¯¹å…¬å…±èµ„æºè®¿é—®çš„é™åˆ¶æœ€å¸¸è§çš„å°±æ˜¯ä½¿ç”¨äº’æ–¥é”çš„æ–¹å¼ã€‚åœ¨Goä¸­ï¼Œsync.Mutex æä¾›äº†äº’æ–¥é”çš„å®ç°ã€‚</p><p>ç®€å•ä½¿ç”¨ç¤ºä¾‹ï¼š</p><pre><code class="go">func main() {var mutex sync.Mutexcount := 0for r := 0; r &lt; 50; r++ {   go func() {           mutex.Lock()           count += 1           mutex.Unlock()       }()   }   time.Sleep(time.Second)   fmt.Println(&quot;the count is : &quot;, count)}</code></pre><p>å½“æ‰§è¡Œäº† <code>mutex.Lock()</code> æ“ä½œåï¼Œå¦‚æœæœ‰å¦å¤–ä¸€ä¸ª <code>goroutine</code> åˆæ‰§è¡Œäº†ä¸Šé”æ“ä½œï¼Œé‚£ä¹ˆè¯¥æ“ä½œè¢«è¢«é˜»å¡ï¼Œç›´åˆ°è¯¥äº’æ–¥é”æ¢å¤åˆ°è§£é”çŠ¶æ€ã€‚</p><h2 id="è¯»å†™é”"><a href="#è¯»å†™é”" class="headerlink" title="è¯»å†™é”"></a>è¯»å†™é”</h2><p>é¡¾åæ€ä¹‰ï¼Œè¯»å†™é”æ˜¯å¯¹è¯»å†™æ“ä½œè¿›è¡ŒåŠ é”ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å¤šä¸ªè¯»æ“ä½œä¹‹é—´ä¸å­˜åœ¨äº’æ–¥å…³ç³»ï¼Œè¿™æ ·æé«˜äº†å¯¹å…±äº«èµ„æºçš„è®¿é—®æ•ˆç‡ã€‚</p><p>Goä¸­è¯»å†™é”ç”± <code>sync.RWMutex</code>æä¾›ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><p><code>func (rw *RWMutex) Lock()</code></p></li><li><p><code>func (rw *RWMutex) RLock()</code></p></li><li><p><code>func (rw *RWMutex) RLocker() Locker</code></p></li><li><p><code>func (rw *RWMutex) RUnlock()</code></p></li><li><p><code>func (rw *RWMutex) Unlock()</code></p></li></ul><p>å…¶ä¸­ <code>Lock()</code> å³â€œå†™é”å®šâ€ï¼Œè°ƒç”¨äº†â€œå†™é”å®šâ€åï¼Œä¸èƒ½æœ‰å…¶ä»–<code>goroutine</code>è¿›è¡Œè¯»æˆ–è€…å†™æ“ä½œã€‚ <code>Unlock()</code> å³â€œå†™è§£é”â€ï¼Œè°ƒç”¨äº†â€œå†™è§£é”â€åä¼šå”¤é†’æ‰€æœ‰å› ä¸ºè¦è¿›è¡Œâ€œè¯»é”å®šï¼ˆå³:<code>RLock()</code>ï¼‰â€ è€Œè¢«é˜»å¡çš„ <code>goroutine</code>ã€‚</p><p><code>RLock()</code>ä¸ºâ€œè¯»é”å®šâ€ï¼Œè°ƒç”¨â€œè¯»é”å®šâ€åï¼Œä¸èƒ½æœ‰å…¶ä»–<code>goroutine</code>è¿›è¡Œå†™æ“ä½œï¼Œä½†æ˜¯å¯ä»¥è¿›è¡Œè¯»æ“ä½œã€‚<code>RUnlock()</code> ä¸ºâ€œè¯»è§£é”â€ï¼Œè°ƒç”¨â€œè¯»è§£é”â€åï¼Œä¼šå”¤é†’ä¸€ä¸ªå› ä¸ºè¦è¿›è¡Œâ€œå†™é”å®šâ€è€Œè¢«é˜»å¡çš„<code>goroutine</code>ã€‚</p><p>ç®€å•ä½¿ç”¨ç¤ºä¾‹ï¼š</p><pre><code class="go">package mainimport (&quot;fmt&quot;&quot;sync&quot;&quot;time&quot;)func main() {    var mutex sync.RWMutex    arr := []int{1, 2, 3}    go func() {       fmt.Println(&quot;Try to lock writing operation.&quot;)       mutex.Lock()       fmt.Println(&quot;Writing operation is locked.&quot;)       arr = append(arr, 4)       fmt.Println(&quot;Try to unlock writing operation.&quot;)       mutex.Unlock()       fmt.Println(&quot;Writing operation is unlocked.&quot;)   }()   go func() {       fmt.Println(&quot;Try to lock reading operation.&quot;)       mutex.RLock()       fmt.Println(&quot;The reading operation is locked.&quot;)       fmt.Println(&quot;The len of arr is : &quot;, len(arr))       fmt.Println(&quot;Try to unlock reading operation.&quot;)       mutex.RUnlock()       fmt.Println(&quot;The reading operation is unlocked.&quot;)   }()   time.Sleep(time.Second * 2)   return}</code></pre><p>è¿è¡Œä»¥ä¸Šç¤ºä¾‹ï¼Œè§‚å¯Ÿè¾“å‡ºç»“æœï¼Œä½ å°†èƒ½å¤Ÿæ¯”è¾ƒç›´è§‚çš„æ„Ÿå—åˆ°è¯»å†™é”çš„ä½œç”¨ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>è¯»å†™é”</tag>
      
      <tag>Mutex</tag>
      
      <tag>RWMutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TCPé»åŒ…</title>
    <link href="/2020/05/11/TCP%E9%BB%8F%E5%8C%85/"/>
    <url>/2020/05/11/TCP%E9%BB%8F%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯TCPç²˜åŒ…"><a href="#ä»€ä¹ˆæ˜¯TCPç²˜åŒ…" class="headerlink" title="ä»€ä¹ˆæ˜¯TCPç²˜åŒ…?"></a>ä»€ä¹ˆæ˜¯TCPç²˜åŒ…?</h2><ol><li>é€šå¸¸æˆ‘åœ¨è‡ªå·±å†™ç¨‹åºçš„æ—¶å€™å†™ä¸€ä¸ªåŸºäº<code>tcp</code>åè®®é€šè®¯çš„ç¨‹åºæ—¶å°±ä¼šå‘ç”Ÿè¿™ç§é—®é¢˜ã€‚</li><li>æˆ‘ä»¬åœ¨<code>Client</code>ç«¯å¿«é€Ÿå‘é€æ•°æ®åŒ…å¹¶ä¸”è¿™ä¸ªåŒ…æ•°æ®æ˜¯éšæœº,æ—¶é—´é—´éš”ä¹Ÿå¾ˆçŸ­,ç„¶å<code>tcp</code>çš„<code>Server</code>æ‹¿åˆ°æ•°æ®å°±ä¼šæ˜¯æˆ‘ä»¬ä¹‹å‰<code>Client</code>å‘é€çš„å¤šæ¡æ•°æ®åŒ…åˆåœ¨çš„ä¸€èµ·çš„ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸èƒ½åŒºåˆ†å…·ä½“æ˜¯å“ªä¸ªæ•°æ®åŒ…çš„ã€‚</li><li>ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ç§åŸå› å°±æ˜¯å› ä¸º<code>tcp</code>åœ¨ä¼ è¾“çš„æ˜¯<code>å­—èŠ‚æµåè®®</code>ã€‚<blockquote><p>ä¸Šé¢æ˜¯æˆ‘ä¸ªäººè‡ªå­¦ä¹ è¿‡ç¨‹ä¸­æ€»ç»“çš„å¤§å®¶å¯ä»¥çœ‹çœ‹è¿™ä¸ªé“¾æ¥ä¸Šçš„è§£é‡Š:<br><a href="https://www.liwenzhou.com/posts/Go/15_socket/" target="_blank" rel="noopener">https://www.liwenzhou.com/posts/Go/15_socket/</a></p></blockquote></li></ol><h2 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°ç²˜åŒ…"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°ç²˜åŒ…" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°ç²˜åŒ…"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°ç²˜åŒ…</h2><p>ä¸»è¦åŸå› å°±æ˜¯tcpæ•°æ®ä¼ é€’æ¨¡å¼æ˜¯æµæ¨¡å¼ï¼Œåœ¨ä¿æŒé•¿è¿æ¥çš„æ—¶å€™å¯ä»¥è¿›è¡Œå¤šæ¬¡çš„æ”¶å’Œå‘ã€‚</p><p>â€œç²˜åŒ…â€å¯å‘ç”Ÿåœ¨å‘é€ç«¯ä¹Ÿå¯å‘ç”Ÿåœ¨æ¥æ”¶ç«¯ï¼š</p><ul><li>ç”±Nagleç®—æ³•é€ æˆçš„å‘é€ç«¯çš„ç²˜åŒ…ï¼šNagleç®—æ³•æ˜¯ä¸€ç§æ”¹å–„ç½‘ç»œä¼ è¾“æ•ˆç‡çš„ç®—æ³•ã€‚ç®€å•æ¥è¯´å°±æ˜¯å½“æˆ‘ä»¬æäº¤ä¸€æ®µæ•°æ®ç»™TCPå‘é€æ—¶ï¼ŒTCPå¹¶ä¸ç«‹åˆ»å‘é€æ­¤æ®µæ•°æ®ï¼Œè€Œæ˜¯ç­‰å¾…ä¸€å°æ®µæ—¶é—´çœ‹çœ‹åœ¨ç­‰å¾…æœŸé—´æ˜¯å¦è¿˜æœ‰è¦å‘é€çš„æ•°æ®ï¼Œè‹¥æœ‰åˆ™ä¼šä¸€æ¬¡æŠŠè¿™ä¸¤æ®µæ•°æ®å‘é€å‡ºå»ã€‚</li><li>æ¥æ”¶ç«¯æ¥æ”¶ä¸åŠæ—¶é€ æˆçš„æ¥æ”¶ç«¯ç²˜åŒ…ï¼šTCPä¼šæŠŠæ¥æ”¶åˆ°çš„æ•°æ®å­˜åœ¨è‡ªå·±çš„ç¼“å†²åŒºä¸­ï¼Œç„¶åé€šçŸ¥åº”ç”¨å±‚å–æ•°æ®ã€‚å½“åº”ç”¨å±‚ç”±äºæŸäº›åŸå› ä¸èƒ½åŠæ—¶çš„æŠŠTCPçš„æ•°æ®å–å‡ºæ¥ï¼Œå°±ä¼šé€ æˆTCPç¼“å†²åŒºä¸­å­˜æ”¾äº†å‡ æ®µæ•°æ®ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1geosakdma0j30on0brabp.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="é€šè¿‡Goè¯­è¨€å®ç°"><a href="#é€šè¿‡Goè¯­è¨€å®ç°" class="headerlink" title="é€šè¿‡Goè¯­è¨€å®ç°"></a>é€šè¿‡Goè¯­è¨€å®ç°</h2><blockquote><p>server.go</p></blockquote><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/5/11 - 7:14 ä¸‹åˆpackage mainimport (    &quot;fmt&quot;    &quot;net&quot;)func main() {    listen, err := net.Listen(&quot;tcp&quot;, &quot;localhost:9598&quot;)    if err != nil {        fmt.Println(&quot;create tcp server fail.&quot;,err)        return    }    var msg [1024]byte    for{        accept, err := listen.Accept()        if err != nil {            fmt.Println(&quot;tcp accept fail&quot;,err)            return        }        n , _ := accept.Read(msg[:])        fmt.Println(string(msg[:n]))    }}</code></pre><blockquote><p>client.go</p></blockquote><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/5/11 - 7:58 ä¸‹åˆpackage mainimport (    &quot;fmt&quot;    &quot;net&quot;    &quot;time&quot;)func main() {    dial, err := net.Dial(&quot;tcp&quot;, &quot;localhost:9598&quot;)    if err != nil {        fmt.Println(&quot;connection tcp server fail.&quot;,err)    }    for i:=0;i&lt;10;i++ {        dial.Write([]byte(&quot;Hello&quot; + time.Now().Format(&quot;2006-01-02 15:04:05.0000&quot;)))    }}</code></pre><blockquote><p>OutPut</p></blockquote><pre><code> ~/Documents/GO_CODE_DEV/src/Lets_Go/lets_33_tcp_é»åŒ…  master âœš  â†µ 1 î‚° go run server.goHello2020-05-11 20:16:13.5448Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449Hello2020-05-11 20:16:13.5449</code></pre><p><strong>å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ•°æ®åŒ…éƒ½è¢«é»åœ¨ä¸€èµ·äº†ï¼ï¼ï¼ï¼è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„tcpé»åŒ…ã€‚</strong></p><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><blockquote><p>å‡ºç°é»åŒ…çš„åŸå› æ˜¯å› ä¸ºæœåŠ¡å™¨ç«¯æˆ–è€…æ¶ˆæ¯æ¥å—è€…ä¸çŸ¥é“æˆ‘ä»¬æ¯æ¬¡å‘é€çš„æ•°æ®åŒ…å¤§å°ï¼ï¼æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ•°æ®åŒ…æ ¼å¼æ¥è§£å†³ã€‚å°±åƒæˆ‘ä»¬å‡ºå»çº¦åˆ«äººåƒé¥­ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¿©å…ˆå•†é‡å¥½å»å“ªé‡Œåœ°æ–¹å‡ ç‚¹â€¦..(ä¾‹å­æœ‰ç‚¹æŠ½è±¡ä¸å¥½ç†è§£å•Šå“ˆå“ˆå“ˆ)</p></blockquote><blockquote><p>protocol.go</p></blockquote><pre><code class="go">package mainimport (    &quot;bufio&quot;    &quot;bytes&quot;    &quot;encoding/binary&quot;)// Encode å°†æ¶ˆæ¯ç¼–ç func Encode(message string) ([]byte, error) {    // è¯»å–æ¶ˆæ¯çš„é•¿åº¦ï¼Œè½¬æ¢æˆint32ç±»å‹ï¼ˆå 4ä¸ªå­—èŠ‚ï¼‰    var length = int32(len(message))    // åˆ›å»ºç¼“å†²åŒº    var pkg = new(bytes.Buffer)    // å†™å…¥æ¶ˆæ¯å¤´ â€œå°ç«¯æ–¹å¼å†™å…¥å­˜å‚¨â€è¿™é‡Œæˆ‘ä¹Ÿä¸å¤ªæ¸…æ¥šçœ‹åˆ«äººå†™çš„ä¾‹å­,ç”¨å°±å®Œäº‹äº†    err := binary.Write(pkg, binary.LittleEndian, length)    if err != nil {        return nil, err    }    // åœ¨åŒ…å¤´åé¢ è¿½åŠ  å†™å…¥æ¶ˆæ¯å®ä½“    err = binary.Write(pkg, binary.LittleEndian, []byte(message))    if err != nil {        return nil, err    }    return pkg.Bytes(), nil}// Decode è§£ç æ¶ˆæ¯func Decode(reader *bufio.Reader) (string, error) {    // è¯»å–æ¶ˆæ¯çš„é•¿åº¦    lengthByte, _ := reader.Peek(4) // è¯»å–å‰4ä¸ªå­—èŠ‚çš„æ•°æ®    lengthBuff := bytes.NewBuffer(lengthByte)    var length int32    err := binary.Read(lengthBuff, binary.LittleEndian, &amp;length)    if err != nil {        return &quot;&quot;, err    }    // Bufferedè¿”å›ç¼“å†²ä¸­ç°æœ‰çš„å¯è¯»å–çš„å­—èŠ‚æ•°ã€‚    if int32(reader.Buffered()) &lt; length+4 {        return &quot;&quot;, err    }    // è¯»å–çœŸæ­£çš„æ¶ˆæ¯æ•°æ®    pack := make([]byte, int(4+length))    _, err = reader.Read(pack)    if err != nil {        return &quot;&quot;, err    }    return string(pack[4:]), nil}</code></pre><p><strong>æ¥ä¸‹æ¥åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åˆ†åˆ«ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„Decodeå’ŒEncodeå‡½æ•°å¤„ç†æ•°æ®ã€‚ä¸‹é¢æœ‰æˆ‘çš„æºä»£ç ä»“åº“,Good Luck~ğŸ˜œ</strong><br><strong><a href="https://github.com/higker/Lets_Go/tree/master/lets_33_tcp_%E9%BB%8F%E5%8C%85" target="_blank" rel="noopener">https://github.com/higker/Lets_Go/tree/master/lets_33_tcp_%E9%BB%8F%E5%8C%85</a></strong></p><h2 id="é™„åŠ çŸ¥è¯†ç‚¹"><a href="#é™„åŠ çŸ¥è¯†ç‚¹" class="headerlink" title="é™„åŠ çŸ¥è¯†ç‚¹"></a>é™„åŠ çŸ¥è¯†ç‚¹</h2><blockquote><p>ä¸ºä»€ä¹ˆudpä¸ä¼šç²˜åŒ…?<br><a href="https://zhuanlan.zhihu.com/p/41709589?utm_source=wechat_session" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/41709589?utm_source=wechat_session</a></p></blockquote><p>1.TCPåè®®æ˜¯é¢å‘æµçš„åè®®ï¼ŒUDPæ˜¯é¢å‘æ¶ˆæ¯çš„åè®®</p><p>UDPæ®µéƒ½æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»ä»¥æ¶ˆæ¯ä¸ºå•ä½æå–æ•°æ®ï¼Œä¸èƒ½ä¸€æ¬¡æå–ä»»æ„å­—èŠ‚çš„æ•°æ®</p><p>UDPå…·æœ‰ä¿æŠ¤æ¶ˆæ¯è¾¹ç•Œï¼Œåœ¨æ¯ä¸ªUDPåŒ…ä¸­å°±æœ‰äº†æ¶ˆæ¯å¤´ï¼ˆæ¶ˆæ¯æ¥æºåœ°å€ï¼Œç«¯å£ç­‰ä¿¡æ¯ï¼‰ï¼Œè¿™æ ·å¯¹äºæ¥æ”¶ç«¯æ¥è¯´å°±å®¹æ˜“è¿›è¡ŒåŒºåˆ†å¤„ç†äº†ã€‚ä¼ è¾“åè®®æŠŠæ•°æ®å½“ä½œä¸€æ¡ç‹¬ç«‹çš„æ¶ˆæ¯åœ¨ç½‘ä¸Šä¼ è¾“ï¼Œæ¥æ”¶ç«¯åªèƒ½æ¥æ”¶ç‹¬ç«‹çš„æ¶ˆæ¯ã€‚æ¥æ”¶ç«¯ä¸€æ¬¡åªèƒ½æ¥æ”¶å‘é€ç«¯å‘å‡ºçš„ä¸€ä¸ªæ•°æ®åŒ…,å¦‚æœä¸€æ¬¡æ¥å—æ•°æ®çš„å¤§å°å°äºå‘é€ç«¯ä¸€æ¬¡å‘é€çš„æ•°æ®å¤§å°ï¼Œå°±ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå³ä½¿ä¸¢å¤±ï¼Œæ¥å—ç«¯ä¹Ÿä¸ä¼šåˆ†ä¸¤æ¬¡å»æ¥æ”¶</p>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>tcp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è°ˆè°ˆå¹¶å‘å’Œå¹¶è¡Œ</title>
    <link href="/2020/05/08/%E8%B0%88%E8%B0%88%E5%B9%B6%E5%8F%91%E5%92%8C%E5%B9%B6%E8%A1%8C/"/>
    <url>/2020/05/08/%E8%B0%88%E8%B0%88%E5%B9%B6%E5%8F%91%E5%92%8C%E5%B9%B6%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿ</h2><p> å°±æ˜¯åœ¨ä¸€æ®µæ—¶é—´é‡Œæ¥å›åˆ‡æ¢åšå¤šä¸ªäº‹æƒ…ï¼Œå°±åƒä¸€ä¸ªå¿«é€’å‘˜åœ¨ä¸€åˆ†é’Ÿå†…é€å®Œæˆ‘çš„å¿«é€’åˆç»§ç»­å»é€çš„å¿«é€’ï¼Œå¹²æ´»çš„å°±åªè¦ä¸€ä¸ªå¿«é€’å‘˜(è¿™ä¸ªä¾‹å­æœ‰ç‚¹ä¸å¥½è¿˜æ˜¯çœ‹ä¸‹é¢å›¾ç‰‡å§)ã€‚<code>å¹¶å‘(concurrency)</code>ï¼šæŒ‡åœ¨åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œï¼Œä½†å¤šä¸ªè¿›ç¨‹æŒ‡ä»¤è¢«å¿«é€Ÿçš„è½®æ¢æ‰§è¡Œï¼Œä½¿å¾—åœ¨å®è§‚ä¸Šå…·æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œçš„æ•ˆæœï¼Œä½†åœ¨å¾®è§‚ä¸Šå¹¶ä¸æ˜¯åŒæ—¶æ‰§è¡Œçš„ï¼Œåªæ˜¯æŠŠæ—¶é—´åˆ†æˆè‹¥å¹²æ®µï¼Œä½¿å¤šä¸ªè¿›ç¨‹å¿«é€Ÿäº¤æ›¿çš„æ‰§è¡Œã€‚<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gelclh44mgj308704j74e.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="ä»€ä¹ˆå¹¶è¡Œï¼Ÿ"><a href="#ä»€ä¹ˆå¹¶è¡Œï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå¹¶è¡Œï¼Ÿ"></a>ä»€ä¹ˆå¹¶è¡Œï¼Ÿ</h2><p>åœ¨åŒä¸€æ—¶åˆ»å†…å¤„ç†å¤šä¸ªäº‹æƒ…ï¼Œå°±åƒä¸€ä¸ª2ä¸ªå¿«é€’å‘˜åœ¨åŒæ—¶æ—¶é—´å†…åˆ†åˆ«ç»™ä½ æˆ‘é€å¿«é€’ã€‚(ä»–ä»¬2ä¸ªåœ¨åŒä¸€ä¸ªæ—¶é—´å†…åŒæ—¶å¹²æ´»ï¼Œæ•ˆç‡é«˜)ã€‚<code>å¹¶è¡Œ(parallel)ï¼š</code>æŒ‡åœ¨åŒä¸€æ—¶åˆ»ï¼Œæœ‰å¤šæ¡æŒ‡ä»¤åœ¨å¤šä¸ªå¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œã€‚æ‰€ä»¥æ— è®ºä»å¾®è§‚è¿˜æ˜¯ä»å®è§‚æ¥çœ‹ï¼ŒäºŒè€…éƒ½æ˜¯ä¸€èµ·æ‰§è¡Œçš„ã€‚<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1geldwbtva1j308p04mgln.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p>å¹¶è¡Œåœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­å­˜åœ¨ï¼Œè€Œå¹¶å‘å¯ä»¥åœ¨å•å¤„ç†å™¨å’Œå¤šå¤„ç†å™¨ç³»ç»Ÿä¸­éƒ½å­˜åœ¨ï¼Œå¹¶å‘èƒ½å¤Ÿåœ¨å•å¤„ç†å™¨ç³»ç»Ÿä¸­å­˜åœ¨æ˜¯å› ä¸ºå¹¶å‘æ˜¯å¹¶è¡Œçš„å‡è±¡ï¼Œå¹¶è¡Œè¦æ±‚ç¨‹åºèƒ½å¤ŸåŒæ—¶æ‰§è¡Œå¤šä¸ªæ“ä½œï¼Œè€Œå¹¶å‘åªæ˜¯è¦æ±‚ç¨‹åºå‡è£…åŒæ—¶æ‰§è¡Œå¤šä¸ªæ“ä½œï¼ˆæ¯ä¸ªå°æ—¶é—´ç‰‡æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œå¤šä¸ªæ“ä½œå¿«é€Ÿåˆ‡æ¢æ‰§è¡Œï¼‰ã€‚</p><p>å½“æœ‰å¤šä¸ªçº¿ç¨‹åœ¨æ“ä½œæ—¶ï¼Œå¦‚æœç³»ç»Ÿåªæœ‰ä¸€ä¸ª CPUï¼Œåˆ™å®ƒæ ¹æœ¬ä¸å¯èƒ½çœŸæ­£åŒæ—¶è¿›è¡Œä¸€ä¸ªä»¥ä¸Šçš„çº¿ç¨‹ï¼Œå®ƒåªèƒ½æŠŠ CPU è¿è¡Œæ—¶é—´åˆ’åˆ†æˆè‹¥å¹²ä¸ªæ—¶é—´æ®µï¼Œå†å°†æ—¶é—´æ®µåˆ†é…ç»™å„ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œåœ¨ä¸€ä¸ªæ—¶é—´æ®µçš„çº¿ç¨‹ä»£ç è¿è¡Œæ—¶,å…¶å®ƒçº¿ç¨‹å¤„äºæŒ‚èµ·çŠ¶æ€.è¿™ç§æ–¹å¼æˆ‘ä»¬ç§°ä¹‹ä¸ºå¹¶å‘ï¼ˆConcurrentï¼‰ã€‚</p><p>å½“ç³»ç»Ÿæœ‰ä¸€ä¸ªä»¥ä¸Š CPU æ—¶ï¼Œåˆ™çº¿ç¨‹çš„æ“ä½œæœ‰å¯èƒ½éå¹¶å‘ã€‚å½“ä¸€ä¸ª CPU æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œå¦ä¸€ä¸ª CPU å¯ä»¥æ‰§è¡Œå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸¤ä¸ªçº¿ç¨‹äº’ä¸æŠ¢å  CPU èµ„æºï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œï¼Œè¿™ç§æ–¹å¼æˆ‘ä»¬ç§°ä¹‹ä¸ºå¹¶è¡Œï¼ˆParallelï¼‰ã€‚<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1geld285ybjj30i40ea750.jpg" srcset="/img/loading.gif" alt=""></p><p><strong>çœ‹å›¾éå¸¸å®¹æ˜“ç†è§£ï¼š</strong><br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1geld3btporj30o909faaz.jpg" srcset="/img/loading.gif" alt=""><br>ä¸Šå›¾ä¸­å°†ä¸€ä¸ªä»»åŠ¡ä¸­çš„ä¸‰ä¸ªæ­¥éª¤å–æŸ´ã€è¿æŸ´ã€å¸æŸ´åˆ’åˆ†æˆäº†ç‹¬ç«‹çš„å°ä»»åŠ¡ï¼Œæœ‰å–æŸ´çš„è€é¼ ï¼Œæœ‰è¿æŸ´çš„è€é¼ ï¼Œæœ‰å¸æŸ´çƒ§ç«çš„è€é¼ ã€‚<br>å¦‚æœä¸Šå›¾ä¸­æ‰€æœ‰çš„è€é¼ éƒ½æ˜¯åŒä¸€åªï¼Œé‚£ä¹ˆæ˜¯ä¸²è¡Œå¹¶å‘çš„ï¼Œå¦‚æœæ˜¯ä¸åŒçš„å¤šåªè€é¼ ï¼Œé‚£ä¹ˆæ˜¯å¹¶è¡Œå¹¶å‘çš„ã€‚</p><h4 id="å¹¶è¡Œå’Œä¸²è¡Œï¼š"><a href="#å¹¶è¡Œå’Œä¸²è¡Œï¼š" class="headerlink" title="å¹¶è¡Œå’Œä¸²è¡Œï¼š"></a>å¹¶è¡Œå’Œä¸²è¡Œï¼š</h4><ul><li>ä¸²è¡Œï¼šä¸€æ¬¡åªèƒ½å–å¾—ä¸€ä¸ªä»»åŠ¡å¹¶æ‰§è¡Œè¿™ä¸€ä¸ªä»»åŠ¡</li><li>å¹¶è¡Œï¼šå¯ä»¥åŒæ—¶é€šè¿‡å¤šè¿›ç¨‹/å¤šçº¿ç¨‹çš„æ–¹å¼å–å¾—å¤šä¸ªä»»åŠ¡ï¼Œå¹¶ä»¥å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹çš„æ–¹å¼åŒæ—¶æ‰§è¡Œè¿™äº›ä»»åŠ¡</li><li>æ³¨æ„ç‚¹ï¼š<ul><li>å¦‚æœæ˜¯å•è¿›ç¨‹/å•çº¿ç¨‹çš„å¹¶è¡Œï¼Œé‚£ä¹ˆæ•ˆç‡æ¯”ä¸²è¡Œæ›´å·®</li><li>å¦‚æœåªæœ‰å•æ ¸cpuï¼Œå¤šè¿›ç¨‹å¹¶è¡Œå¹¶æ²¡æœ‰æé«˜æ•ˆç‡</li><li>ä»ä»»åŠ¡é˜Ÿåˆ—ä¸Šçœ‹ï¼Œç”±äºåŒæ—¶ä»é˜Ÿåˆ—ä¸­å–å¾—å¤šä¸ªä»»åŠ¡å¹¶æ‰§è¡Œï¼Œç›¸å½“äºå°†ä¸€ä¸ªé•¿ä»»åŠ¡é˜Ÿåˆ—å˜æˆäº†çŸ­é˜Ÿåˆ—</li></ul></li></ul><h3 id="å¹¶å‘ï¼š"><a href="#å¹¶å‘ï¼š" class="headerlink" title="å¹¶å‘ï¼š"></a>å¹¶å‘ï¼š</h3><ul><li>å¹¶å‘æ˜¯ä¸€ç§ç°è±¡ï¼šåŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºæˆ–å¤šä¸ªä»»åŠ¡éœ€è¦è¢«å¤„ç†çš„ç°è±¡</li><li>è¿™äº›ä»»åŠ¡å¯èƒ½æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œå’ŒCPUæ ¸å¿ƒæ•°æ— å…³ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè¿›ç¨‹è°ƒåº¦å’ŒCPUä¸Šä¸‹æ–‡åˆ‡æ¢è¾¾åˆ°çš„ç»“æœ</li><li>è§£å†³å¤§å¹¶å‘çš„ä¸€ä¸ªæ€è·¯æ˜¯å°†å¤§ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªå°ä»»åŠ¡ï¼š</li><li>å¯èƒ½è¦ä½¿ç”¨ä¸€äº›æ•°æ®ç»“æ„æ¥é¿å…åˆ‡åˆ†æˆå¤šä¸ªå°ä»»åŠ¡å¸¦æ¥çš„é—®é¢˜</li><li>å¯ä»¥å¤šè¿›ç¨‹/å¤šçº¿ç¨‹å¹¶è¡Œçš„æ–¹å¼å»æ‰§è¡Œè¿™äº›å°ä»»åŠ¡è¾¾åˆ°é«˜æ•ˆç‡</li><li>æˆ–è€…ä»¥å•è¿›ç¨‹/å•çº¿ç¨‹é…åˆå¤šè·¯å¤ç”¨æ‰§è¡Œè¿™äº›å°ä»»åŠ¡æ¥è¾¾åˆ°é«˜æ•ˆç‡</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>è®¡ç®—æœºçŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Goä¹‹é«˜é˜¶å‡½æ•°</title>
    <link href="/2020/04/24/Go%E4%B9%8B%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/"/>
    <url>/2020/04/24/Go%E4%B9%8B%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°??ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°??ï¼Ÿ</h1><p>ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ç§å‡½æ•°å°±ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ï¼Œç¼–å†™é«˜é˜¶å‡½æ•°ï¼Œå°±æ˜¯è®©å‡½æ•°çš„å‚ï¼Œèƒ½å¤Ÿæ¥æ”¶åˆ«çš„å‡½æ•°ï¼Œå‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯æŒ‡è¿™ç§é«˜åº¦æŠ½è±¡çš„ç¼–ç¨‹èŒƒå¼ã€‚</p><h1 id="é«˜é˜¶å‡½æ•°çš„ç‰¹ç‚¹"><a href="#é«˜é˜¶å‡½æ•°çš„ç‰¹ç‚¹" class="headerlink" title="é«˜é˜¶å‡½æ•°çš„ç‰¹ç‚¹"></a>é«˜é˜¶å‡½æ•°çš„ç‰¹ç‚¹</h1><ul><li>å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°</li></ul><p><code>å‡½æ•°æœ¬èº«ä¹Ÿå¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼Œå³ï¼šå˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°</code></p><pre><code class="go">package main//goè¯­è¨€å¯¼åŒ…import (    m &quot;Lets_Go/lets_18_package/math&quot; //èµ·åˆ«å  è‡ªå®šä¹‰åŒ…åä¹Ÿå°±æ˜¯ç»™â€œmathâ€œèµ·ä¸ªåˆ«å    &quot;fmt&quot;)func main() {    multip := m.SimpleCompute(&quot;+&quot;)    fmt.Println(multip(2, 8))}</code></pre><ul><li>è¿”å›å€¼ä¹Ÿæ˜¯å‡½æ•°</li></ul><pre><code class="go">/*    é—­åŒ…é«˜é˜¶å‡½æ•°*/func SimpleCompute(Symbol string) func(n, m int) int {    switch Symbol {    case &quot;+&quot;:        return func(n, m int) int {            return n + m        }    case &quot;-&quot;:        return func(n, m int) int {            return n - m        }    case &quot;*&quot;:        return func(n, m int) int {            return n * m        }    case &quot;/&quot;:        return func(n, m int) int {            return n / m        }    default:        panic(&quot;compute symbol invalid.&quot;)    }}</code></pre><ul><li>å‡½æ•°å¯ä½œä¸ºå‚æ•°</li></ul><p><code>æ—¢ç„¶å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°èƒ½æ¥æ”¶å˜é‡ï¼Œé‚£ä¹ˆä¸€ä¸ªå‡½æ•°å°±å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¸€ä¸ªæœ€ç®€å•çš„é«˜é˜¶å‡½æ•°</code></p><pre><code class="go">package mainimport &quot;fmt&quot;//goè¯­è¨€ä¸­çš„é—­åŒ…æ“ä½œfunc main() {    f1(f3(f2, 5, 5))}//1.é™åˆ¶å‡½æ•°ç±»å‹çš„å‡½æ•°func f1(f func()) {    f()}//2.ç°åœ¨çš„éœ€æ±‚å°±è¦æŠŠæˆ‘ä»¬çš„f2å‡½æ•°ä¼ é€’åˆ°f1å‡½æ•°é‡Œé¢è¿›è¡Œè°ƒç”¨func f2(a, b int) int {    fmt.Println(&quot;f2() am f1() exec succeed&quot;)    fmt.Println(&quot;a + b = ? åœ¨f3ä¸­çš„åŒ¿åå‡½æ•°ä¸­è°ƒç”¨:&quot;)    return a + b}//3.é€šè¿‡é—­åŒ…è§£å†³func f3(fn func(int, int) int, a, b int) (Rf func()) { //è¿”å›å€¼åå­—å¿…é¡»æ˜¯â€œRfâ€ ä¸æƒ³ç”¨å°±ä¸éœ€è¦å†™ç›´æ¥å†™è¿”å›å€¼ç±»å‹    //è¿™ä¸ªå°±æ˜¯å–ä¸€ä¸ªä¸­é—´å˜é‡å­˜å‚¨ å¹¶ä¸” åœ¨å‡½æ•°é‡Œé¢å£°æ˜ä¸€ä¸ªåŒ¿åæ— è¿”å›å€¼çš„å‡½æ•°    // := è¿™é‡Œå¦‚æœå‡½æ•°è¿”å›å€¼å·²ç»åœ¨å‡½æ•°åä¸Šå†™ç€äº† å°±ä¸èƒ½ä½¿ç”¨ := å› ä¸ºå·²ç»åœ¨åˆ›å»ºå‡½æ•°æ—¶å·²ç»å£°æ˜äº†    Rf = func() {        sum := fn(a, b) //æ¥å—è¿”å›å€¼ ç„¶åæ‰“å°        fmt.Println(&quot;sum=&quot;, sum)    }    return Rf}</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>golang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Goä¹‹channelæµ…å…¥äº†è§£</title>
    <link href="/2020/04/23/Go%E4%B9%8Bchannel%E6%B5%85%E5%85%A5%E4%BA%86%E8%A7%A3/"/>
    <url>/2020/04/23/Go%E4%B9%8Bchannel%E6%B5%85%E5%85%A5%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Goè¯­è¨€çš„channelï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Goè¯­è¨€çš„channelï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Goè¯­è¨€çš„channelï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Goè¯­è¨€çš„channelï¼Ÿ</h2><blockquote><p>åœ¨Goè¯­è¨€ä¸­,Channelå³æŒ‡é€šé“ç±»å‹ã€‚æœ‰æ—¶ä¹Ÿç”¨å®ƒæ¥ç›´æ¥æŒ‡ä»£å¯ä»¥ä¼ é€’æŸç§ç±»å‹çš„å€¼çš„é€šé“ã€‚</p></blockquote><p>channelæ˜¯Goè¯­è¨€ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒç±»å‹ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆç®¡é“ã€‚å¹¶å‘æ ¸å¿ƒå•å…ƒé€šè¿‡å®ƒå°±å¯ä»¥å‘é€æˆ–è€…æ¥æ”¶æ•°æ®è¿›è¡Œé€šè®¯ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šåˆè¿›ä¸€æ­¥é™ä½äº†ç¼–ç¨‹çš„éš¾åº¦ã€‚<br>channelæ˜¯ä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œä¸»è¦ç”¨æ¥è§£å†³åç¨‹çš„åŒæ­¥é—®é¢˜ä»¥åŠåç¨‹ä¹‹é—´æ•°æ®å…±äº«ï¼ˆæ•°æ®ä¼ é€’ï¼‰çš„é—®é¢˜ã€‚<br>goroutineè¿è¡Œåœ¨ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œå› æ­¤è®¿é—®å…±äº«å†…å­˜å¿…é¡»åšå¥½åŒæ­¥ã€‚goroutine å¥‰è¡Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ï¼Œè€Œä¸æ˜¯å…±äº«å†…å­˜æ¥é€šä¿¡ã€‚<br>å¼•â½¤ç±»å‹ channelå¯ç”¨äºå¤šä¸ª goroutine é€šè®¯ã€‚å…¶å†…éƒ¨å®ç°äº†åŒæ­¥ï¼Œç¡®ä¿å¹¶å‘å®‰å…¨ã€‚</p><p>è™½ç„¶å¯ä»¥ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œä½†æ˜¯å…±äº«å†…å­˜åœ¨ä¸åŒçš„goroutineä¸­å®¹æ˜“å‘ç”Ÿç«æ€é—®é¢˜ã€‚ä¸ºäº†ä¿è¯æ•°æ®äº¤æ¢çš„æ­£ç¡®æ€§ï¼Œå¿…é¡»ä½¿ç”¨äº’æ–¥é‡å¯¹å†…å­˜è¿›è¡ŒåŠ é”ï¼Œè¿™ç§åšæ³•åŠ¿å¿…é€ æˆæ€§èƒ½é—®é¢˜ã€‚</p><p>Goè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯CSPï¼ˆCommunicating Sequential Processesï¼‰ï¼Œæå€¡é€šè¿‡é€šä¿¡å…±äº«å†…å­˜è€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜è€Œå®ç°é€šä¿¡ã€‚</p><p>å¦‚æœè¯´goroutineæ˜¯Goç¨‹åºå¹¶å‘çš„æ‰§è¡Œä½“ï¼Œchannelå°±æ˜¯å®ƒä»¬ä¹‹é—´çš„è¿æ¥ã€‚channelæ˜¯å¯ä»¥è®©ä¸€ä¸ªgoroutineå‘é€ç‰¹å®šå€¼åˆ°å¦ä¸€ä¸ªgoroutineçš„é€šä¿¡æœºåˆ¶ã€‚</p><p>Go è¯­è¨€ä¸­çš„é€šé“ï¼ˆchannelï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ã€‚é€šé“åƒä¸€ä¸ªä¼ é€å¸¦æˆ–è€…é˜Ÿåˆ—ï¼Œæ€»æ˜¯éµå¾ªå…ˆå…¥å…ˆå‡ºï¼ˆFirst In First Outï¼‰çš„è§„åˆ™ï¼Œä¿è¯æ”¶å‘æ•°æ®çš„é¡ºåºã€‚æ¯ä¸€ä¸ªé€šé“éƒ½æ˜¯ä¸€ä¸ªå…·ä½“ç±»å‹çš„å¯¼ç®¡ï¼Œä¹Ÿå°±æ˜¯å£°æ˜channelçš„æ—¶å€™éœ€è¦ä¸ºå…¶æŒ‡å®šå…ƒç´ ç±»å‹ã€‚<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ge3kqrcxboj30dw072mxe.jpg" srcset="/img/loading.gif" alt=""></p><h2 id="å±æ€§å’ŒåŸºæœ¬æ“ä½œ"><a href="#å±æ€§å’ŒåŸºæœ¬æ“ä½œ" class="headerlink" title="å±æ€§å’ŒåŸºæœ¬æ“ä½œ"></a>å±æ€§å’ŒåŸºæœ¬æ“ä½œ</h2><ul><li>åŸºäºé€šé“çš„é€šè®¯æ˜¯åœ¨å¤šä¸ªGoroutineä¹‹é—´è¿›è¡ŒåŒæ­¥çš„é‡è¦æ‰‹æ®µã€‚è€Œé’ˆå¯¹é€šé“çš„æ“ä½œæœ¬èº«ä¹Ÿæ˜¯åŒæ­¥çš„ã€‚</li><li>åœ¨åŒä¸€æ—¶åˆ»ï¼Œä»…æœ‰ä¸€ä¸ªGoroutineèƒ½å‘ä¸€ä¸ªé€šé“å‘é€å…ƒç´ å€¼</li><li>åŒæ—¶ä¹Ÿä»…æœ‰ä¸€ä¸ªGoroutineèƒ½ä»å®ƒé‚£é‡Œæ¥æ”¶å…ƒç´ å€¼ã€‚</li><li>é€šé“ç›¸å½“äºä¸€ä¸ªFIFOå…ˆè¿›å…ˆå‡ºçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li><li>é€šé“ä¸­çš„å…ƒç´ å€¼éƒ½å…·æœ‰åŸå­æ€§ã€‚å®ƒä»¬æ˜¯ä¸å¯è¢«åˆ†å‰²çš„ã€‚é€šé“ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½åªå¯èƒ½è¢«æŸä¸€ä¸ªGoroutineæ¥æ”¶ã€‚å·²è¢«æ¥æ”¶çš„å…ƒç´ å€¼ä¼šç«‹åˆ»è¢«ä»é€šé“ä¸­åˆ é™¤ã€‚</li></ul><h2 id="æœ‰ç¼“å†²çš„channel"><a href="#æœ‰ç¼“å†²çš„channel" class="headerlink" title="æœ‰ç¼“å†²çš„channel"></a>æœ‰ç¼“å†²çš„channel</h2><p>æœ‰ç¼“å†²çš„é€šé“ï¼ˆbuffered channelï¼‰æ˜¯ä¸€ç§åœ¨è¢«æ¥æ”¶å‰èƒ½å­˜å‚¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®å€¼çš„é€šé“ã€‚<br>è¿™ç§ç±»å‹çš„é€šé“å¹¶ä¸å¼ºåˆ¶è¦æ±‚ goroutine ä¹‹é—´å¿…é¡»åŒæ—¶å®Œæˆå‘é€å’Œæ¥æ”¶ã€‚é€šé“ä¼šé˜»å¡å‘é€å’Œæ¥æ”¶åŠ¨ä½œçš„æ¡ä»¶ä¹Ÿä¸åŒã€‚<br>åªæœ‰é€šé“ä¸­æ²¡æœ‰è¦æ¥æ”¶çš„å€¼æ—¶ï¼Œæ¥æ”¶åŠ¨ä½œæ‰ä¼šé˜»å¡ã€‚<br>åªæœ‰é€šé“æ²¡æœ‰å¯ç”¨ç¼“å†²åŒºå®¹çº³è¢«å‘é€çš„å€¼æ—¶ï¼Œå‘é€åŠ¨ä½œæ‰ä¼šé˜»å¡ã€‚<br>è¿™å¯¼è‡´æœ‰ç¼“å†²çš„é€šé“å’Œæ— ç¼“å†²çš„é€šé“ä¹‹é—´çš„ä¸€ä¸ªå¾ˆå¤§çš„ä¸åŒï¼šæ— ç¼“å†²çš„é€šé“ä¿è¯è¿›è¡Œå‘é€å’Œæ¥æ”¶çš„ goroutine ä¼šåœ¨åŒä¸€æ—¶é—´è¿›è¡Œæ•°æ®äº¤æ¢ï¼›æœ‰ç¼“å†²çš„é€šé“æ²¡æœ‰è¿™ç§ä¿è¯ã€‚</p><p>ç¤ºä¾‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ge3kigisnoj30m70ewtaf.jpg" srcset="/img/loading.gif" alt=""></p><p>åœ¨ç¬¬ 1 æ­¥ï¼Œå³ä¾§çš„ goroutine æ­£åœ¨ä»é€šé“æ¥æ”¶ä¸€ä¸ªå€¼ã€‚<br>åœ¨ç¬¬ 2 æ­¥ï¼Œå³ä¾§çš„è¿™ä¸ª goroutineç‹¬ç«‹å®Œæˆäº†æ¥æ”¶å€¼çš„åŠ¨ä½œï¼Œè€Œå·¦ä¾§çš„ goroutine æ­£åœ¨å‘é€ä¸€ä¸ªæ–°å€¼åˆ°é€šé“é‡Œã€‚<br>åœ¨ç¬¬ 3 æ­¥ï¼Œå·¦ä¾§çš„goroutine è¿˜åœ¨å‘é€šé“å‘é€æ–°å€¼ï¼Œè€Œå³ä¾§çš„ goroutine æ­£åœ¨ä»é€šé“æ¥æ”¶å¦å¤–ä¸€ä¸ªå€¼ã€‚è¿™ä¸ªæ­¥éª¤é‡Œçš„ä¸¤ä¸ªæ“ä½œæ—¢ä¸æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸ä¼šäº’ç›¸é˜»å¡ã€‚<br>æœ€åï¼Œåœ¨ç¬¬ 4 æ­¥ï¼Œæ‰€æœ‰çš„å‘é€å’Œæ¥æ”¶éƒ½å®Œæˆï¼Œè€Œé€šé“é‡Œè¿˜æœ‰å‡ ä¸ªå€¼ï¼Œä¹Ÿæœ‰ä¸€äº›ç©ºé—´å¯ä»¥å­˜æ›´å¤šçš„å€¼ã€‚</p><p><em>ä½¿ç”¨ç¤ºä¾‹</em></p><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/4/22 - 3:15 ä¸‹åˆpackage mainimport (    &quot;fmt&quot;    &quot;sync&quot;)var wg sync.WaitGroup//goè¯­è¨€çš„channel é€šé“//goè¯­è¨€ä½¿ç”¨goroutineæ‰§è¡Œå¤šä¸ªtaskä»»åŠ¡//æ“ä½œä¸€ä¸ªmapæˆ–è€…å…¶ä»–å˜é‡æˆ–è€…å†…å­˜æ—¶ä¼šå‘ç”Ÿæ•°æ®ç«äº‰//ä½¿ç”¨goé‡Œé¢ä½¿ç”¨channelæ¥è§£å†³å¹¶å‘å¹¶è¡Œæ¥è§£å†³func main() {    //channelç±»å‹ ç›¸å½“äºä¸€ä¸ªé˜Ÿåˆ— first in -&gt; first out å…ˆè¿›å…ˆå‡ºåŸåˆ™    //å®šä¹‰ä¸€ä¸ªchannelç±»å‹ channelæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ éœ€è¦å¼€è¾Ÿç©ºé—´    var ch chan int    fmt.Println(ch == nil) //true    //åˆå§‹åŒ–ä¸€ä¸ªæ— ç¼“å†²åŒºçš„é€šé“    ch = make(chan int)    wg.Add(1)    go func (){        defer wg.Done()        x := &lt;- ch        fmt.Println(x)    }()    ch &lt;- 2048 //ä¼šå¡æ­»mainçš„ä¸»goroutineä»è€Œä¸èƒ½è®©ç¨‹åºè¿›è¡Œæ‰§è¡Œ    fmt.Println(ch) //æ— ç¼“å†²åŒºçš„channelä¸èƒ½æ”¾å…¥å€¼    fmt.Println(ch == nil) //false    //åˆå§‹åŒ–ä¸€ä¸ªå¸¦ç¼“å†²åŒºçš„é€šé“    bufChan := make(chan int,8)    fmt.Println(cap(bufChan)) //8 CAPå¯ä»¥æ¢å–é€šé“ç¼“å†²åŒºå¤§å°    //å‘é€å€¼ ä½¿ç”¨è¿™ä¸ª&quot;&lt;-ç¬¦å·&quot; è·å–ä¹Ÿä¸€æ ·    bufChan &lt;- 1024    num := &lt;-bufChan    fmt.Println(bufChan)    fmt.Println(num)    wg.Wait()}</code></pre><blockquote><p>ä¸Šé¢éƒ¨åˆ†å†…å®¹è½¬è½½äºé“¾æ¥ï¼š<a href="https://www.jianshu.com/p/e611d30feb9d" target="_blank" rel="noopener">https://www.jianshu.com/p/e611d30feb9d</a></p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Golang</tag>
      
      <tag>goroutine</tag>
      
      <tag>channel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Goä¹‹goroutineæµ…å…¥äº†è§£</title>
    <link href="/2020/04/22/Go%E4%B9%8Bgoroutine%E6%B5%85%E5%85%A5%E4%BA%86%E8%A7%A3/"/>
    <url>/2020/04/22/Go%E4%B9%8Bgoroutine%E6%B5%85%E5%85%A5%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆgoroutine"><a href="#1-ä»€ä¹ˆgoroutine" class="headerlink" title="1.ä»€ä¹ˆgoroutine?"></a>1.ä»€ä¹ˆgoroutine?</h1><p>goroutineæ˜¯Goå¹¶è¡Œè®¾è®¡çš„æ ¸å¿ƒã€‚goroutineè¯´åˆ°åº•å…¶å®å°±æ˜¯åç¨‹ï¼Œå®ƒæ¯”çº¿ç¨‹æ›´å°ï¼Œåå‡ ä¸ªgoroutineå¯èƒ½ä½“ç°åœ¨åº•å±‚å°±æ˜¯äº”å…­ä¸ªçº¿ç¨‹ï¼ŒGoè¯­è¨€å†…éƒ¨å¸®ä½ å®ç°äº†è¿™äº›goroutineä¹‹é—´çš„å†…å­˜å…±äº«ã€‚æ‰§è¡Œgoroutineåªéœ€æå°‘çš„æ ˆå†…å­˜(å¤§æ¦‚æ˜¯4~5KB)ï¼Œå½“ç„¶ä¼šæ ¹æ®ç›¸åº”çš„æ•°æ®ä¼¸ç¼©ã€‚ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå¯åŒæ—¶è¿è¡Œæˆåƒä¸Šä¸‡ä¸ªå¹¶å‘ä»»åŠ¡ã€‚goroutineæ¯”threadæ›´æ˜“ç”¨ã€æ›´é«˜æ•ˆã€æ›´è½»ä¾¿ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ™®é€šè®¡ç®—æœºè·‘å‡ åä¸ªçº¿ç¨‹å°±æœ‰ç‚¹è´Ÿè½½è¿‡å¤§äº†ï¼Œä½†æ˜¯åŒæ ·çš„æœºå™¨å´å¯ä»¥è½»æ¾åœ°è®©æˆç™¾ä¸Šåƒä¸ªgoroutineè¿›è¡Œèµ„æºç«äº‰ã€‚</p><p>Goroutineæ˜¯å»ºç«‹åœ¨çº¿ç¨‹ä¹‹ä¸Šçš„è½»é‡çº§çš„æŠ½è±¡ã€‚å®ƒå…è®¸æˆ‘ä»¬ä»¥éå¸¸ä½çš„ä»£ä»·åœ¨åŒä¸€ä¸ªåœ°å€ç©ºé—´ä¸­å¹¶è¡Œåœ°æ‰§è¡Œå¤šä¸ªå‡½æ•°æˆ–è€…æ–¹æ³•ã€‚ç›¸æ¯”äºçº¿ç¨‹ï¼Œå®ƒçš„åˆ›å»ºå’Œé”€æ¯çš„ä»£ä»·è¦å°å¾ˆå¤šï¼Œå¹¶ä¸”å®ƒçš„è°ƒåº¦æ˜¯ç‹¬ç«‹äºçº¿ç¨‹çš„ã€‚åœ¨golangä¸­åˆ›å»ºä¸€ä¸ªgoroutineéå¸¸ç®€å•ï¼Œä½¿ç”¨â€œgoâ€å…³é”®å­—å³å¯ï¼š</p><pre><code class="go">// Copyright (c) 2020 HigKer// Open Source: MIT License// Author: SDing &lt;deen.job@qq.com&gt;// Date: 2020/4/21 - 6:09 ä¸‹åˆpackage mainimport (    &quot;fmt&quot;    &quot;math/rand&quot;    &quot;sync&quot;    &quot;time&quot;)var (    //è¿™ä¸ªæ˜¯goé‡Œé¢ç”¨æ¥é…ç½®goroutineä½¿ç”¨çš„    //åªèƒ½æ“ä½œæŒ‡é’ˆ å› ä¸ºä»–æ˜¯ä¸€ä¸ªstruct å€¼ç±»å‹ï¼ï¼ï¼    wg sync.WaitGroup    //å­˜æ”¾æˆ‘ä»¬forçš„æ•°å­—æ–¹ä¾¿è§‚å¯Ÿ    sls []int)//goè¯­è¨€ä¸­çš„å¤šä¸ªgoroutine//WaitGroupfunc main() {    fmt.Println(&quot;goroutine begin:&quot;, sls)    for i := 0; i &lt;= 10; i++ {        // fatal error: all goroutines are asleep - deadlock!        //æ³¨æ„è¿™é‡ŒåŠ çš„1ä¸æ˜¯iå¦‚æœæ˜¯içš„è¯æ¯æ¬¡éƒ½æ˜¯åŠ çš„ä¸ä¸€æ ·ç„¶åå‡ºç°ğŸ‘†çš„å¼‚å¸¸ï¼ï¼ï¼        wg.Add(1)        go task(i)    }    fmt.Println(&quot;InService:&quot;, sls)    wg.Wait()    fmt.Println(&quot;End Over:&quot;, sls)}// fatal error: all goroutines are asleep - deadlock!func task(num int) {    defer func() {        wg.Done()    }()    //éšæœºä¼‘çœ å‡ æ¯«ç§’    time.Sleep(duration())    //å°†forå¾ªç¯çš„iå­˜å…¥åˆ°åˆ‡ç‰‡ä¸­æˆ‘ä»¬ç­‰ä¸‹å¥½è§‚å¯Ÿ,    //æ‰“å°æ§åˆ¶å°å¤ªæ…¢äº†å›æ¼æ‰    sls = append(sls, num) //ä¸å®‰å…¨}//ç”Ÿæˆä¸€ä¸ªéšæœºçš„ç­‰å¾…æ—¶é—´ = æ¯«ç§’func duration() time.Duration {    rand.Seed(time.Now().UnixNano())    return time.Millisecond * time.Duration(rand.Intn(3000))}</code></pre><h3 id="output"><a href="#output" class="headerlink" title="output"></a>output</h3><pre><code class="shell">goroutine begin: []InService: []End Over: [4 10 9 8 6 1 0 3 2]</code></pre><blockquote><p>ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜å¤šæ¬¡è¿è¡Œä½ ä¼šå‘ç°æœ‰æ—¶å€™ç»“æœçš„sliceä¼šå°‘ä¸€ä¸ªæ•°,è¿™æ˜¯å› ä¸ºï¼Œå’Œçº¿ç¨‹ä¸€æ ·ï¼Œgolangçš„ä¸»å‡½æ•°ï¼ˆå…¶å®ä¹Ÿè·‘åœ¨ä¸€ä¸ªgoroutineä¸­ï¼‰å¹¶ä¸ä¼šç­‰å¾…å…¶å®ƒgoroutineç»“æŸã€‚å¦‚æœä¸»goroutineç»“æŸäº†ï¼Œæ‰€æœ‰å…¶å®ƒgoroutineéƒ½å°†ç»“æŸ,æ‰€æœ‰åé¢æˆ‘ä»¬å°±ä¼šå°†åˆ°goçš„channelæ¥è§£å†³é—®é¢˜~æ•°æ®ç«äº‰å’Œæ•°æ®å…±äº«,å¤šä¸ªgoroutineä¹‹é—´çš„é€šè®¯é—®é¢˜ã€‚</p></blockquote><h3 id="Goroutineä¸çº¿ç¨‹çš„åŒºåˆ«"><a href="#Goroutineä¸çº¿ç¨‹çš„åŒºåˆ«" class="headerlink" title="Goroutineä¸çº¿ç¨‹çš„åŒºåˆ«"></a>Goroutineä¸çº¿ç¨‹çš„åŒºåˆ«</h3><p>è®¸å¤šäººè®¤ä¸ºgoroutineæ¯”çº¿ç¨‹è¿è¡Œå¾—æ›´å¿«ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯¯è§£ã€‚Goroutineå¹¶ä¸ä¼šæ›´å¿«ï¼Œå®ƒåªæ˜¯å¢åŠ äº†æ›´å¤šçš„å¹¶å‘æ€§ã€‚å½“ä¸€ä¸ªgoroutineè¢«é˜»å¡ï¼ˆæ¯”å¦‚ç­‰å¾…IOï¼‰ï¼Œgolangçš„schedulerä¼šè°ƒåº¦å…¶å®ƒå¯ä»¥æ‰§è¡Œçš„goroutineè¿è¡Œã€‚ä¸çº¿ç¨‹ç›¸æ¯”ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p><h3 id="å†…å­˜æ¶ˆè€—æ›´å°‘ï¼š"><a href="#å†…å­˜æ¶ˆè€—æ›´å°‘ï¼š" class="headerlink" title="å†…å­˜æ¶ˆè€—æ›´å°‘ï¼š"></a>å†…å­˜æ¶ˆè€—æ›´å°‘ï¼š</h3><p>Goroutineæ‰€éœ€è¦çš„å†…å­˜é€šå¸¸åªæœ‰2kbï¼Œè€Œçº¿ç¨‹åˆ™éœ€è¦1Mbï¼ˆ500å€ï¼‰ã€‚<br>å†…å­˜æ¶ˆè€—æ›´å°‘ï¼š</p><h3 id="åˆ›å»ºä¸é”€æ¯çš„å¼€é”€æ›´å°"><a href="#åˆ›å»ºä¸é”€æ¯çš„å¼€é”€æ›´å°" class="headerlink" title="åˆ›å»ºä¸é”€æ¯çš„å¼€é”€æ›´å°"></a>åˆ›å»ºä¸é”€æ¯çš„å¼€é”€æ›´å°</h3><p>ç”±äºçº¿ç¨‹åˆ›å»ºæ—¶éœ€è¦å‘æ“ä½œç³»ç»Ÿç”³è¯·èµ„æºï¼Œå¹¶ä¸”åœ¨é”€æ¯æ—¶å°†èµ„æºå½’è¿˜ï¼Œå› æ­¤å®ƒçš„åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€æ¯”è¾ƒå¤§ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œgoroutineçš„åˆ›å»ºå’Œé”€æ¯æ˜¯ç”±goè¯­è¨€åœ¨è¿è¡Œæ—¶è‡ªå·±ç®¡ç†çš„ï¼Œå› æ­¤å¼€é”€æ›´ä½ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ge2mjdldsfj30hs0a5q3h.jpg" srcset="/img/loading.gif" alt=""></p><h3 id="åˆ‡æ¢å¼€é”€æ›´å°"><a href="#åˆ‡æ¢å¼€é”€æ›´å°" class="headerlink" title="åˆ‡æ¢å¼€é”€æ›´å°"></a>åˆ‡æ¢å¼€é”€æ›´å°</h3><p>è¿™æ˜¯goroutineäºçº¿ç¨‹çš„ä¸»è¦åŒºåˆ«ï¼Œä¹Ÿæ˜¯golangèƒ½å¤Ÿå®ç°é«˜å¹¶å‘çš„ä¸»è¦åŸå› ã€‚çº¿ç¨‹çš„è°ƒåº¦æ–¹å¼æ˜¯æŠ¢å å¼çš„ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†åˆ†é…ç»™å®ƒçš„æ—¶é—´ç‰‡ï¼Œå°±ä¼šè¢«å…¶å®ƒå¯æ‰§è¡Œçš„çº¿ç¨‹æŠ¢å ã€‚åœ¨çº¿ç¨‹åˆ‡æ¢çš„è¿‡ç¨‹ä¸­éœ€è¦ä¿å­˜/æ¢å¤æ‰€æœ‰çš„å¯„å­˜å™¨ä¿¡æ¯ï¼Œæ¯”å¦‚16ä¸ªé€šç”¨å¯„å­˜å™¨ï¼ŒPCï¼ˆProgram Counterï¼‰ï¼ŒSPï¼ˆStack Pointerï¼‰ï¼Œæ®µå¯„å­˜å™¨ç­‰ç­‰ã€‚</p><p>è€Œgoroutineçš„è°ƒåº¦æ˜¯ååŒå¼çš„ï¼Œå®ƒä¸ä¼šç›´æ¥åœ°ä¸æ“ä½œç³»ç»Ÿå†…æ ¸æ‰“äº¤é“ã€‚å½“goroutineè¿›è¡Œåˆ‡æ¢çš„æ—¶å€™ï¼Œä¹‹åå¾ˆå°‘é‡çš„å¯„å­˜å™¨éœ€è¦ä¿å­˜å’Œæ¢å¤ï¼ˆPCå’ŒSPï¼‰ã€‚å› æ­¤gouroutineçš„åˆ‡æ¢æ•ˆç‡æ›´é«˜ã€‚</p><h3 id="Goroutineçš„è°ƒåº¦"><a href="#Goroutineçš„è°ƒåº¦" class="headerlink" title="Goroutineçš„è°ƒåº¦"></a>Goroutineçš„è°ƒåº¦</h3><p>çœŸå¦‚å‰é¢æåˆ°çš„ï¼Œgoroutineçš„è°ƒåº¦æ–¹å¼æ˜¯ååŒå¼çš„ã€‚åœ¨ååŒå¼è°ƒåº¦ä¸­ï¼Œæ²¡æœ‰æ—¶é—´ç‰‡çš„æ¦‚å¿µã€‚ä¸ºäº†å¹¶è¡Œæ‰§è¡Œgoroutineï¼Œè°ƒåº¦å™¨ä¼šåœ¨ä»¥ä¸‹å‡ ä¸ªæ—¶é—´ç‚¹å¯¹å…¶è¿›è¡Œåˆ‡æ¢ï¼š</p><h3 id="Channelæ¥å—æˆ–è€…å‘é€ä¼šé€ æˆé˜»å¡çš„æ¶ˆæ¯"><a href="#Channelæ¥å—æˆ–è€…å‘é€ä¼šé€ æˆé˜»å¡çš„æ¶ˆæ¯" class="headerlink" title="Channelæ¥å—æˆ–è€…å‘é€ä¼šé€ æˆé˜»å¡çš„æ¶ˆæ¯"></a>Channelæ¥å—æˆ–è€…å‘é€ä¼šé€ æˆé˜»å¡çš„æ¶ˆæ¯</h3><p>å½“ä¸€ä¸ªæ–°çš„goroutineè¢«åˆ›å»ºæ—¶<br>å¯ä»¥é€ æˆé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚æ–‡ä»¶å’Œç½‘ç»œæ“ä½œ<br>åƒåœ¾å›æ”¶<br>ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è°ƒåº¦å™¨å…·ä½“æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚Golangè°ƒåº¦å™¨ä¸­æœ‰ä¸‰ä¸ªæ¦‚å¿µ</p><ul><li>Processorï¼ˆPï¼‰</li><li>OSThreadï¼ˆMï¼‰</li><li>Goroutinesï¼ˆGï¼‰</li></ul><p>åœ¨ä¸€ä¸ªGoç¨‹åºä¸­ï¼Œå¯ç”¨çš„çº¿ç¨‹æ•°æ˜¯é€šè¿‡GOMAXPROCSæ¥è®¾ç½®çš„ï¼Œé»˜è®¤å€¼æ˜¯å¯ç”¨çš„CPUæ ¸æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨runtimeåŒ…åŠ¨æ€æ”¹å˜è¿™ä¸ªå€¼ã€‚OSThreadè°ƒåº¦åœ¨processorä¸Šï¼Œgoroutinesè°ƒåº¦åœ¨OSThreadsä¸Š<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ge2ml5ze1wj30hs08at98.jpg" srcset="/img/loading.gif" alt=""><br>Golangçš„è°ƒåº¦å™¨å¯ä»¥åˆ©ç”¨å¤šprocessorèµ„æºï¼Œåœ¨ä»»æ„æ—¶åˆ»ï¼ŒMä¸ªgoroutineéœ€è¦è¢«è°ƒåº¦åˆ°Nä¸ªOS threadsä¸Šï¼ŒåŒæ—¶è¿™äº›threadsè¿è¡Œåœ¨è‡³å¤šGOMAXPROCSä¸ªprocessorä¸Šï¼ˆN &lt;= GOMAXPROCSï¼‰ã€‚Go schedulerå°†å¯è¿è¡Œçš„goroutinesåˆ†é…åˆ°å¤šä¸ªè¿è¡Œåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªprocessorä¸Šçš„OS threadsä¸Šã€‚</p><p>æ¯ä¸ªprocessoræœ‰ä¸€ä¸ªæœ¬åœ°goroutineé˜Ÿåˆ—ã€‚åŒæ—¶æœ‰ä¸€ä¸ªå…¨å±€çš„goroutineé˜Ÿåˆ—ã€‚æ¯ä¸ªOSThreadéƒ½ä¼šè¢«åˆ†é…ç»™ä¸€ä¸ªprocessorã€‚æœ€å¤šåªèƒ½æœ‰GOMAXPROCSä¸ªprocessorï¼Œæ¯ä¸ªprocessoråŒæ—¶åªèƒ½æ‰§è¡Œä¸€ä¸ªOSThreadã€‚Scheculerå¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºOSThreadã€‚<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ge2mlz0si1j30hs08j74l.jpg" srcset="/img/loading.gif" alt=""><br>åœ¨æ¯ä¸€è½®è°ƒåº¦ä¸­ï¼Œscheduleræ‰¾åˆ°ä¸€ä¸ªå¯ä»¥è¿è¡Œçš„goroutineå¹¶æ‰§è¡Œç›´åˆ°å…¶è¢«é˜»å¡,ç”±æ­¤å¯è§ï¼Œæ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªçº¿ç¨‹ä¸‹å¯ä»¥å¹¶å‘æ‰§è¡Œä¸Šåƒä¸ªgoroutineï¼Œæ¯ä¸ªgoroutineæ‰€å ç”¨çš„èµ„æºå’Œåˆ‡æ¢å¼€é”€éƒ½å¾ˆå°ï¼Œå› æ­¤ï¼Œgoroutineæ˜¯golangé€‚åˆé«˜å¹¶å‘åœºæ™¯çš„é‡è¦åŸå› ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>go</tag>
      
      <tag>golang</tag>
      
      <tag>goroutine</tag>
      
      <tag>channel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Macä¸Šé…ç½®Golangå¼€å‘ç¯å¢ƒ</title>
    <link href="/2020/03/13/Mac%E4%B8%8A%E9%85%8D%E7%BD%AEGolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <url>/2020/03/13/Mac%E4%B8%8A%E9%85%8D%E7%BD%AEGolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<p><img src="https://i.loli.net/2020/03/13/JYRMzrxeKlLNp26.jpg" srcset="/img/loading.gif" alt="Golang"></p><blockquote><p><strong>ğŸ“æœ¬ç¯‡æ–‡ç« è®°å½•æˆ‘æœ¬äººåœ¨Macä¸Šé…ç½®Goå¼€å‘ç¯å¢ƒçš„ç¬”è®°ğŸ“’</strong></p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><ul><li><a href="https://github.com/golang/go" target="_blank" rel="noopener">Go Source Code</a></li><li>Goæ˜¯Googleå¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹ã€å¹¶å‘å‹ï¼Œå¹¶å…·æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½çš„ç¼–ç¨‹è¯­è¨€ã€‚ ç½—ä¼¯ç‰¹Â·æ ¼ç‘å²è«ï¼Œç½—å‹ƒÂ·æ´¾å…‹åŠè‚¯Â·æ±¤æ™®é€Šäº2007å¹´9æœˆå¼€å§‹è®¾è®¡Goï¼Œç¨åIan Lance Taylorã€Russ CoxåŠ å…¥é¡¹ç›®ã€‚Goæ˜¯åŸºäºInfernoæ“ä½œç³»ç»Ÿæ‰€å¼€å‘çš„ã€‚</li><li>Goçš„è¯­æ³•æ¥è¿‘Cè¯­è¨€ï¼Œä½†å¯¹äºå˜é‡çš„å£°æ˜æœ‰æ‰€ä¸åŒã€‚Goæ”¯æŒåƒåœ¾å›æ”¶åŠŸèƒ½ã€‚Goçš„å¹¶è¡Œè®¡ç®—æ¨¡å‹æ˜¯ä»¥ä¸œå°¼Â·éœå°”çš„é€šä¿¡é¡ºåºè¿›ç¨‹ï¼ˆCSPï¼‰ä¸ºåŸºç¡€ï¼Œé‡‡å–ç±»ä¼¼æ¨¡å‹çš„å…¶ä»–è¯­è¨€åŒ…æ‹¬Occamå’ŒLimboï¼Œ[2]ï¼Œä½†å®ƒä¹Ÿå…·æœ‰pipelineæ¨¡å‹çš„ç‰¹å¾ï¼Œæ¯”å¦‚é€šé“ä¼ è¾“ã€‚åœ¨1.8ç‰ˆæœ¬ä¸­å¼€æ”¾æ’ä»¶ï¼ˆPluginï¼‰çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€ç°åœ¨èƒ½ä»Goä¸­åŠ¨æ€åŠ è½½éƒ¨åˆ†å‡½æ•°ã€‚ä¸C++ç›¸æ¯”ï¼ŒGoå¹¶ä¸åŒ…æ‹¬å¦‚æšä¸¾ã€å¼‚å¸¸å¤„ç†ã€ç»§æ‰¿ã€æ³›å‹ã€æ–­è¨€ã€è™šå‡½æ•°ç­‰åŠŸèƒ½ï¼Œä½†å¢åŠ äº† åˆ‡ç‰‡(Slice) å‹ã€å¹¶å‘ã€ç®¡é“ã€åƒåœ¾å›æ”¶åŠŸèƒ½ã€æ¥å£ç­‰ç‰¹æ€§çš„è¯­è¨€çº§æ”¯æŒ[2]ã€‚Go 2.0ç‰ˆæœ¬å°†æ”¯æŒæ³›å‹[7]ï¼Œå¯¹äºæ–­è¨€çš„å­˜åœ¨ï¼Œåˆ™æŒè´Ÿé¢æ€åº¦ï¼ŒåŒæ—¶ä¹Ÿä¸ºè‡ªå·±ä¸æä¾›ç±»å‹ç»§æ‰¿æ¥è¾©æŠ¤ã€‚ä¸åŒäºJavaï¼ŒGoåŸç”Ÿæä¾›äº†å…³è”æ•°ç»„ï¼ˆä¹Ÿç§°ä¸ºå“ˆå¸Œè¡¨ï¼ˆHashesï¼‰æˆ–å­—å…¸ï¼ˆDictionariesï¼‰ï¼‰ï¼Œå°±åƒå­—ç¬¦ä¸²ç±»å‹ä¸€æ ·ã€‚</li></ul><h2 id="ä¸‹è½½-amp-å®‰è£…"><a href="#ä¸‹è½½-amp-å®‰è£…" class="headerlink" title="ä¸‹è½½ &amp; å®‰è£…"></a>ä¸‹è½½ &amp; å®‰è£…</h2><ul><li><a href="https://go.dev/" target="_blank" rel="noopener">Go Dev</a></li><li>æµè§ˆå™¨ğŸ”›æ‰“å¼€ä¸Šé¢ğŸ‘†é“¾æ¥ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…<br><img src="https://i.loli.net/2020/03/13/XosNZdnTVtr3auA.jpg" srcset="/img/loading.gif" alt="Xnip2020-03-13_15-54-37.jpg"></li><li>ä¸‹è½½çš„æ—¶å€™æ ¹æ®è‡ªå·±ç³»ç»Ÿç‰ˆæœ¬ä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…</li><li>ä¸‹è½½å®Œæˆä¹‹ååŒå‡»å®‰è£…åŒ…å³å¯å®‰è£…</li></ul><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>æˆ‘æœ¬äººMacæ˜¯ä½¿ç”¨çš„<code>iTerm2 + Oh My Zsh + zsh</code>æ‰€ä»¥æˆ‘åªéœ€è¦ç¼–è¾‘æˆ‘çš„<code>~/.zshrc</code>æ–‡ä»¶ğŸ“ƒå³å¯.</p><ul><li>é€šè¿‡vscodeæ‰“å¼€<pre><code class="bash">code ~/.zshrc</code></pre></li><li>åœ¨æ–‡ä»¶æœ€åæ·»åŠ ä¿®æ”¹é…ç½®<pre><code class="bash">##goè¯­è¨€ç¯å¢ƒé…ç½® ##go è¯­è¨€å®‰è£…ä¸»æ ¹ç›®å½•export GOROOT=/usr/local/go#GOPATHæ˜¯è‡ªå·±çš„goé¡¹ç›®è·¯å¾„ï¼Œè‡ªå®šä¹‰è®¾ç½®export GOPATH=/Users/ding/Documents/GO_CODE_DEV# å¯ç”¨ Go Modules åŠŸèƒ½export GO111MODULE=on# é…ç½® GOPROXY ç¯å¢ƒå˜é‡ &amp; å›½å†…ç½‘ç»œç¯å¢ƒå¤§å®¶éƒ½çŸ¥é“ä¸å¤šè¯´export GOPROXY=https://goproxy.io,directexport PATH=$PATH:$GOBIN:$GOPATH/bin:GO111MODULE:GOPROXY</code></pre></li><li>ç„¶åä½¿ç”¨<code>source ~/.zshrc</code>æ–‡ä»¶</li><li>åœ¨terminalé‡Œé¢è¾“å…¥<code>go env</code>å³å¯æŸ¥çœ‹ç¯å¢ƒ<br><img src="https://i.loli.net/2020/03/13/3hrCzjTS5D4MlKJ.jpg" srcset="/img/loading.gif" alt="Xnip2020-03-13_16-07-43.jpg"></li></ul><h2 id="VSCodeé…ç½®"><a href="#VSCodeé…ç½®" class="headerlink" title="VSCodeé…ç½®"></a>VSCodeé…ç½®</h2><p>æˆ‘ä¸ªäººä½¿ç”¨vscodeæ¯”è¾ƒå¤šä¸€ç‚¹,Golandåœ¨å¼€å‘å¤§å‹é¡¹ç›®æ‰ä½¿ç”¨<br><strong>VS Codeå®˜æ–¹ä¸‹è½½åœ°å€ï¼š<a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener">https://code.visualstudio.com/Download</a></strong><br>ä¸‰å¤§ä¸»æµå¹³å°éƒ½æ”¯æŒï¼Œè¯·æ ¹æ®è‡ªå·±çš„ç”µè„‘å¹³å°é€‰æ‹©å¯¹åº”çš„å®‰è£…åŒ…ã€‚åŒå‡»ä¸‹è½½å¥½çš„å®‰è£…æ–‡ä»¶ï¼ŒåŒå‡»å®‰è£…å³å¯ã€‚</p><ul><li><h4 id="å®‰è£…Goè¯­è¨€å¼€å‘å·¥å…·åŒ…"><a href="#å®‰è£…Goè¯­è¨€å¼€å‘å·¥å…·åŒ…" class="headerlink" title="å®‰è£…Goè¯­è¨€å¼€å‘å·¥å…·åŒ…"></a>å®‰è£…Goè¯­è¨€å¼€å‘å·¥å…·åŒ…</h4><p>åœ¨åº§Goè¯­è¨€å¼€å‘çš„æ—¶å€™ä¸ºæˆ‘ä»¬æä¾›è¯¸å¦‚ä»£ç æç¤ºã€ä»£ç è‡ªåŠ¨è¡¥å…¨ç­‰åŠŸèƒ½ã€‚<br>Windowså¹³å°æŒ‰ä¸‹Ctrl+Shift+Pï¼ŒMacå¹³å°æŒ‰Command+Shift+Pï¼Œè¿™ä¸ªæ—¶å€™VS Codeç•Œé¢ä¼šå¼¹å‡ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/15535662106193.jpg" srcset="/img/loading.gif" alt="GO"><br>æˆ‘ä»¬åœ¨è¿™ä¸ªè¾“å…¥æ¡†ä¸­è¾“å…¥<code>&gt;go:install</code>ï¼Œä¸‹é¢ä¼šè‡ªåŠ¨æœç´¢ç›¸å…³å‘½ä»¤ï¼Œæˆ‘ä»¬é€‰æ‹©<code>Go:Install/Update Tools</code>è¿™ä¸ªå‘½ä»¤<br><img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/15535659707162.jpg" srcset="/img/loading.gif" alt="GOINSTALL"><br>é€‰ä¸­å¹¶ä¼šå›è½¦æ‰§è¡Œè¯¥å‘½ä»¤ï¼ˆæˆ–è€…ä½¿ç”¨é¼ æ ‡ç‚¹å‡»è¯¥å‘½ä»¤ï¼‰<br><img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/15535665573387.jpg" srcset="/img/loading.gif" alt="golang"></p></li><li><h4 id="é…ç½®ä»£ç ç‰‡æ®µå¿«æ·é”®"><a href="#é…ç½®ä»£ç ç‰‡æ®µå¿«æ·é”®" class="headerlink" title="é…ç½®ä»£ç ç‰‡æ®µå¿«æ·é”®"></a>é…ç½®ä»£ç ç‰‡æ®µå¿«æ·é”®</h4><p>è¿˜æ˜¯æŒ‰Ctrl/Command+Shift+P,æŒ‰ä¸‹å›¾è¾“å…¥<code>&gt;snippets</code>ï¼Œé€‰æ‹©å‘½ä»¤å¹¶æ‰§è¡Œ<br><img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/15535687503862.jpg" srcset="/img/loading.gif" alt="GO"><br>é…ç½®<code>snippets</code>ä»£ç ç‰‡æ®µæ¨¡æœ¬<br><img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/15535688890224.jpg" srcset="/img/loading.gif" alt="GO SNIPPETS"><br>å¤§å®¶å¯ä»¥ç®€å•çœ‹ä¸‹ä¸Šé¢çš„æ³¨é‡Šï¼Œä»‹ç»äº†ä¸»è¦ç”¨æ³•ï¼š</p><pre><code class="json">    â€œè¿™é‡Œæ”¾ä¸ªåå­—â€:{      &quot;prefix&quot;: &quot;è¿™ä¸ªæ˜¯å¿«æ·é”®&quot;,      &quot;body&quot;: &quot;è¿™é‡Œæ˜¯æŒ‰å¿«æ·é”®æ’å…¥çš„ä»£ç ç‰‡æ®µ&quot;,      &quot;description&quot;: &quot;è¿™é‡Œæ”¾æç¤ºä¿¡æ¯çš„æè¿°&quot;    }</code></pre><p> å…¶ä¸­<code>$0</code>è¡¨ç¤ºæœ€ç»ˆå…‰æ ‡æç•™çš„ä½ç½®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘è¿™é‡Œåˆ›å»ºäº†ä¸¤ä¸ªå¿«æ·æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯è¾“å…¥<code>pln</code>å°±ä¼šåœ¨ç¼–è¾‘å™¨ä¸­æ’å…¥<code>fmt.Println()</code>ä»£ç ï¼›è¾“å…¥<code>plf</code>ï¼Œå°±ä¼šæ’å…¥<code>fmt.Printf(&quot;&quot;)</code>ä»£ç ã€‚</p><pre><code class="json">  {    &quot;println&quot;:{      &quot;prefix&quot;: &quot;pln&quot;,      &quot;body&quot;:&quot;fmt.Println($0)&quot;,      &quot;description&quot;: &quot;println&quot;    },    &quot;printf&quot;:{      &quot;prefix&quot;: &quot;plf&quot;,      &quot;body&quot;: &quot;fmt.Printf(\&quot;$0\&quot;)&quot;,      &quot;description&quot;: &quot;printf&quot;    }  }</code></pre><p>æ·»åŠ å¦‚ä¸Šé…ç½®åï¼Œä¿å­˜ã€‚ æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªgoæ–‡ä»¶ï¼Œæµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼š<br> <img src="https://www.liwenzhou.com/images/Go/00_config_VSCode/demo1.gif" srcset="/img/loading.gif" alt="fmt.println"></p></li></ul><p><strong>å¥½äº†é…ç½®å®Œæˆ,å¼€å§‹æ„‰å¿«çš„codingå§ğŸ‘¨â€ğŸ’»â€Good luck~ğŸ˜œ</strong>   </p>]]></content>
    
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>Golang</tag>
      
      <tag>Mac</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexoé›†æˆgitalkè¯„è®ºç»„ä»¶</title>
    <link href="/2020/03/08/Hexo%E9%9B%86%E6%88%90gitalk%E8%AF%84%E8%AE%BA%E7%BB%84%E4%BB%B6/"/>
    <url>/2020/03/08/Hexo%E9%9B%86%E6%88%90gitalk%E8%AF%84%E8%AE%BA%E7%BB%84%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/BayMRX/Blog_source@master/img/hexo.jpg" srcset="/img/loading.gif" alt="hexo"></p><blockquote><p><strong>ä¸€ä¸ªåŸºäº Github Issue å’Œ Preact å¼€å‘çš„è¯„è®ºæ’ä»¶,ä¸‹é¢æˆ‘ä»¬å°±æ¥ä½¿ç”¨gitalkæ¥å®ç°hexoçš„è¯„è®ºåŠŸèƒ½ã€‚</strong></p></blockquote><h4 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h4><ul><li><a href="https://gitalk.github.io/" target="_blank" rel="noopener">Gitalkå¼€æºåœ°å€</a></li></ul><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>ä½¿ç”¨ GitHub ç™»å½•</li><li>æ”¯æŒå¤šè¯­è¨€ [en, zh-CN, zh-TW, es-ES, fr, ru]</li><li>æ”¯æŒä¸ªäººæˆ–ç»„ç»‡</li><li>æ— å¹²æ‰°æ¨¡å¼ï¼ˆè®¾ç½® distractionFreeMode ä¸º true å¼€å¯ï¼‰</li><li>å¿«æ·é”®æäº¤è¯„è®º ï¼ˆcmd|ctrl + enterï¼‰</li></ul><p><a href="https://github.com/gitalk/gitalk/blob/master/readme.md" target="_blank" rel="noopener">Readme</a><br><a href="https://gitalk.github.io" target="_blank" rel="noopener">åœ¨çº¿ç¤ºä¾‹</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ä¸¤ç§æ–¹å¼</p><ul><li>ç›´æ¥å¼•å…¥</li></ul><pre><code class="html">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css&quot;&gt;  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js&quot;&gt;&lt;/script&gt;  &lt;!-- or --&gt;  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/gitalk/dist/gitalk.css&quot;&gt;  &lt;script src=&quot;https://unpkg.com/gitalk/dist/gitalk.min.js&quot;&gt;&lt;/script&gt;</code></pre><ul><li>npm å®‰è£…</li></ul><pre><code class="sh">npm i --save gitalk</code></pre><pre><code class="js">import &#39;gitalk/dist/gitalk.css&#39;import Gitalk from &#39;gitalk&#39;</code></pre><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>æ·»åŠ ä¸€ä¸ªå®¹å™¨ï¼š</p><pre><code class="html">&lt;div id=&quot;gitalk-container&quot;&gt;&lt;/div&gt;</code></pre><p>ç”¨ä¸‹é¢çš„ Javascript ä»£ç æ¥ç”Ÿæˆ gitalk æ’ä»¶ï¼š</p><pre><code class="js">var gitalk = new Gitalk({  clientID: &#39;GitHub Application Client ID&#39;,  clientSecret: &#39;GitHub Application Client Secret&#39;,  repo: &#39;GitHub repo&#39;,  owner: &#39;GitHub repo owner&#39;,  admin: [&#39;GitHub repo owner and collaborators, only these guys can initialize github issues&#39;],  id: location.pathname,      // Ensure uniqueness and length less than 50  distractionFreeMode: false  // Facebook-like distraction free mode})gitalk.render(&#39;gitalk-container&#39;)</code></pre><p>éœ€è¦ <strong>GitHub Application</strong>ï¼Œå¦‚æœæ²¡æœ‰ <a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œç”³è¯·</a>ï¼Œ<code>Authorization callback URL</code> å¡«å†™å½“å‰ä½¿ç”¨æ’ä»¶é¡µé¢çš„åŸŸåã€‚</p><p><strong>âš ï¸æ›´å¤šå¸®åŠ©åœ¨å®˜æ–¹æ–‡æ¡£,å¯ä»¥åœ¨å®˜æ–¹é“¾æ¥é‡ŒæŸ¥è¯¢ã€‚</strong></p><h2 id="è®¾ç½®GitHub"><a href="#è®¾ç½®GitHub" class="headerlink" title="è®¾ç½®GitHub"></a>è®¾ç½®GitHub</h2><ul><li>åœ¨ä¸ªäººè®¾ç½®é‡Œé¢åˆ›å»ºä¸€ä¸ªApplication<br><img src="https://i.loli.net/2020/03/08/fKqE9JHALBXMnN7.jpg" srcset="/img/loading.gif" alt="Xnip2020-03-07_12-46-47.jpg"></li><li>ç„¶åæˆ‘ä»¬éœ€è¦çš„ClientIDå’ŒToken<br><img src="https://i.loli.net/2020/03/08/vAx7wkRFhsNyqtX.jpg" srcset="/img/loading.gif" alt="clientId"></li><li>åˆ›å»ºä¸€ä¸ªå­˜æ”¾lssueä»“åº“<br><img src="https://i.loli.net/2020/03/08/jeBmlY2RD6Fi35E.jpg" srcset="/img/loading.gif" alt="Xnip2020-03-07_13-00-14.jpg"><h2 id="åœ¨Hexoé‡Œä½¿ç”¨"><a href="#åœ¨Hexoé‡Œä½¿ç”¨" class="headerlink" title="åœ¨Hexoé‡Œä½¿ç”¨"></a>åœ¨Hexoé‡Œä½¿ç”¨</h2><blockquote><p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„ä¸»é¢˜é‡Œé¢å·²ç»é›†æˆäº†gitalk,æ‰€æœ‰æˆ‘ä»¬ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ã€‚æ ¹æ®ä¸ªäººé…ç½®æ–¹æ³•ä¸åŒæŸ¥è¯¢å„ç§æ–‡æ¡£ï¼ï¼ï¼</p></blockquote></li></ul><p>ä¸‹é¢æ˜¯æˆ‘çš„é…ç½®æ–‡ä»¶ğŸ“ƒ</p><pre><code class="yaml"># Gitalk# You can get yout ClientID and ClientSecret from https://github.com/settings/applications/new# More info available at https://github.com/gitalk/gitalk#optionsgitalk:  clientID: è¿™é‡Œå¡«å†™ä½ ä¹‹å‰applicationçš„clientID # GitHub Application Client ID  clientSecret: ä¹‹å‰ç”³è¯·çš„ # GitHub Application Client Secret  repo: ibyte.me # The repo to store comments  owner: deencode # GitHub repository owner. Can be personal user or organization.  admin: deencode # GitHub repo owner and collaborators, only these guys can initialize github issues, should be like &quot;[&#39;admin&#39;]&quot; or &quot;[&#39;admin1&#39;,&#39;admin2&#39;]&quot;  id: location.pathname # The unique id of the page. Length must less than 50.  language: zh-CN # Localization language key, en, zh-CN and zh-TW are currently available.  labels: &quot;[&#39;Gitalk&#39;]&quot; # GitHub issue labels.  perPage: 15 # Pagination size, with maximum 100.  pagerDirection: last # Comment sorting direction, available values are last and first.  distractionFreeMode: false # Facebook-like distraction free mode.  createIssueManually: true # By default, Gitalk will create a corresponding github issue for your every single page automatically when the logined user is belong to the admin users. You can create it manually by setting this option to true.</code></pre><p><strong>é…ç½®æ–¹æ³•ä¸åŒæœ‰æ‰€å·®å¼‚!!æ ¹æ®è‡ªå·±ä½¿ç”¨çš„æ’ä»¶æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£è¿›è¡Œçš„é…ç½®ï¼ï¼ï¼Good LuckğŸ˜œ</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>gitalk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨Hexoæ­å»ºBlog</title>
    <link href="/2020/03/06/%E4%BD%BF%E7%94%A8Hexo%E6%90%AD%E5%BB%BABlog/"/>
    <url>/2020/03/06/%E4%BD%BF%E7%94%A8Hexo%E6%90%AD%E5%BB%BABlog/</url>
    
    <content type="html"><![CDATA[<p><img src="https://i.loli.net/2020/03/06/cOUwFstAaTeyGQk.jpg" srcset="/img/loading.gif" alt="Hexo&amp;GithubPage.jpg"></p><h3 id="1-ç›¸å…³ç½‘ç«™"><a href="#1-ç›¸å…³ç½‘ç«™" class="headerlink" title="1. ç›¸å…³ç½‘ç«™"></a>1. ç›¸å…³ç½‘ç«™</h3><ul><li>[Github]: <a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a></li><li>[Hexo]: <a href="https://hexo.io/" target="_blank" rel="noopener">https://hexo.io/</a></li><li>[Hexo Theme]: <a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a></li><li>[Hexo Docs]: <a href="https://hexo.io/docs/" target="_blank" rel="noopener">https://hexo.io/docs/</a></li></ul><h3 id="2-åˆ›å»ºGithub-Key"><a href="#2-åˆ›å»ºGithub-Key" class="headerlink" title="2. åˆ›å»ºGithub Key"></a>2. åˆ›å»ºGithub Key</h3><p>è®¾ç½®ä½ çš„ç”¨æˆ·åç§°ä¸é‚®ä»¶åœ°å€ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨gitçš„è¯</p><pre><code class="bash">$ git config --global user.name &quot;John Doe&quot;$ git config --global user.email johndoe@example.com</code></pre><p>ä½¿ç”¨ssh-keygenç”Ÿæˆç§é’¥å’Œå…¬é’¥<br>å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code class="bash">$ ssh-keygen -t rsa</code></pre><p>ç„¶ååˆ°ä½ GitHub è®¾ç½®é‡Œé¢æ·»åŠ ä½ åˆšæ‰ç”Ÿæˆçš„xx.pubçš„å†…å®¹åˆ°Keyé‡Œé¢.</p><pre><code class="bash">$ ssh -T git@github.com</code></pre><p>ç™»å½•Githubï¼Œç‚¹å‡»å¤´åƒä¸‹çš„settingsï¼Œæ·»åŠ ssh,æ–°å»ºä¸€ä¸ªnew ssh keyï¼Œå°†id_rsa.pubæ–‡ä»¶é‡Œçš„å†…å®¹å¤åˆ¶ä¸Šå»ã€‚</p><p>è¾“å…¥ssh -T <a href="mailto:git@github.com">git@github.com</a>ï¼Œæµ‹è¯•æ·»åŠ sshæ˜¯å¦æˆåŠŸã€‚å¦‚æœçœ‹åˆ°Hiåé¢æ˜¯ä½ çš„ç”¨æˆ·åï¼Œå°±è¯´æ˜æˆåŠŸäº†ã€‚</p><p>è¿™é‡Œä½ å¯ä»¥å»åˆ›å»ºä¸€ä¸ªpublicçš„ä»“åº“æ¥å­˜å‚¨ç­‰ä¸‹Hexoç›¸å…³çš„æ–‡ä»¶.</p><h3 id="3-å®‰è£…NPMå’ŒHexo"><a href="#3-å®‰è£…NPMå’ŒHexo" class="headerlink" title="3. å®‰è£…NPMå’ŒHexo"></a>3. å®‰è£…NPMå’ŒHexo</h3><ul><li>[NodeJSç½‘ç«™]: <a href="http://nodejs.cn/" target="_blank" rel="noopener">http://nodejs.cn/</a></li></ul><p>é€šè¿‡ä¸Šé¢çš„ç½‘ç«™ä¸‹è½½å¯¹åº”çš„ç³»ç»Ÿç‰ˆæœ¬çš„NodeJSå®‰è£…åŒ….</p><ol><li><strong>è®¾ç½®NPMæºåˆ°æ·˜å®æº</strong></li></ol><pre><code class="bash">   npm config set registry https://registry.npmjs.org/</code></pre><ol start="2"><li><p><strong>NPMå®‰è£…HexoCli</strong></p><p>è¾“å…¥npm install hexo -gï¼Œå¼€å§‹å®‰è£…Hexo</p></li></ol><pre><code class="bash">   npm install hexo -g</code></pre><ol start="3"><li><p><strong>åˆå§‹åŒ–Hexo</strong></p><p>è¾“å…¥hexo -vï¼Œæ£€æŸ¥hexoæ˜¯å¦å®‰è£…æˆåŠŸ</p><p>è¾“å…¥hexo initï¼Œåˆå§‹åŒ–è¯¥æ–‡ä»¶å¤¹ï¼ˆæœ‰ç‚¹æ¼«é•¿çš„ç­‰å¾…â€¦ï¼‰çœ‹åˆ°åé¢çš„â€œStart blogging with Hexoï¼â€å°±è¯´æ˜åˆå§‹åŒ–å¥½äº†</p><p>è¾“å…¥npm installï¼Œå®‰è£…æ‰€éœ€è¦çš„ç»„ä»¶</p></li></ol><pre><code class="bash">$ hexo -v$ hexo init$ hexo install        </code></pre><h3 id="4-é…ç½®config-ymlæ–‡ä»¶"><a href="#4-é…ç½®config-ymlæ–‡ä»¶" class="headerlink" title="4.é…ç½®config.ymlæ–‡ä»¶"></a>4.é…ç½®config.ymlæ–‡ä»¶</h3><p><strong>PS:è¿™é‡Œæ ¹æ®è‡ªå·±éœ€è¦è‡ªå·±é…ç½®ï¼Œä½ å¯ä»¥å»æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ï¼ï¼</strong></p><pre><code class="bash">deploy:  type: git  repo: git@github.com:Deencode/ibyte.me.git  branch: master</code></pre><h3 id="5-ç”Ÿæˆé™æ€æ–‡ä»¶-amp-ä¸Šä¼ åˆ°GitHubä»“åº“"><a href="#5-ç”Ÿæˆé™æ€æ–‡ä»¶-amp-ä¸Šä¼ åˆ°GitHubä»“åº“" class="headerlink" title="5.ç”Ÿæˆé™æ€æ–‡ä»¶&amp;ä¸Šä¼ åˆ°GitHubä»“åº“"></a>5.ç”Ÿæˆé™æ€æ–‡ä»¶&amp;ä¸Šä¼ åˆ°GitHubä»“åº“</h3><p><strong>ğŸ‰: åˆ°äº†è¿™ä¸€æ­¥å°±å·®ä¸å¤šäº†ï¼Œè¿è¡Œä¸‹é¢å‘½ä»¤å°±å¯ä»¥ç”Ÿæˆæ–‡ä»¶äº†.</strong></p><pre><code class="bash">#ç”Ÿæˆæ–‡ä»¶$ hexo generate#ç›‘è§†æ–‡ä»¶å˜åŠ¨Hexo èƒ½å¤Ÿç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶ç«‹å³é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶#åœ¨ç”Ÿæˆæ—¶ä¼šæ¯”å¯¹æ–‡ä»¶çš„ SHA1 checksumï¼Œåªæœ‰å˜åŠ¨çš„æ–‡ä»¶æ‰ä¼šå†™å…¥ã€‚$ hexo generate --watch# æœ¬åœ°è¿è¡Œ$ hexo server#æ‚¨å¯æ‰§è¡Œä¸‹åˆ—çš„å…¶ä¸­ä¸€ä¸ªå‘½ä»¤ï¼Œè®© Hexo åœ¨ç”Ÿæˆå®Œæ¯•åè‡ªåŠ¨éƒ¨ç½²ç½‘ç«™ï¼Œä¸¤ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚$ hexo deploy</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>github</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
